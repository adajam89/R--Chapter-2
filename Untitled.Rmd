---
title: "R Notebook"
output: html_notebook
---

```{r echo=FALSE, results = FALSE, message=FALSE, warning=FALSE, cache=TRUE, fig.show='hide'}
##################################################################################################################
##  EXPERIMENT 6 DATA PROCESSING:                                                                               ##
##################################################################################################################
##  Import demographics, RFG justifications, and RFBG justifications:
    exp6__p_info_files <- c(
        "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_questionnaire-z6yh.csv", # Demog (v6)
        #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_questionnaire-z6yh.csv", # Demog (v7)
        "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_questionnaire-h32i.csv")  # RFG just (v6)
        #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_questionnaire-h32i.csv")  # RFG just (v7)

##  Create raw df from the above files, but only get the following columns:
    exp6__participant_info <- map_dfr(exp6__p_info_files,~read_csv(.x, col_types = cols_only(
        "Participant Private ID"='c', "Participant Public ID"='c', "UTC Date"='c', "Participant OS"='c',
        "Participant Browser"='c', "Participant Monitor Size"='c', "branch-ebg9"='c', "randomiser-6j1g"='c', 
        "randomiser-rj7w"='c', "randomiser-enay"='c', "randomiser-gw7n"='c', "randomiser-uc11"='c', 
        "randomiser-hpp5"='c', "randomiser-qhxy"='c', "randomiser-vvav"='c', "Question Key"='c', 
        "Response"='c'))) %>%
    ##  Merge columns that contain the same type of data, but were originally split into different columns:
        unite(study_list, "randomiser-6j1g", "randomiser-rj7w", "randomiser-enay", "randomiser-gw7n",
              "randomiser-uc11", "randomiser-hpp5", "randomiser-qhxy", "randomiser-vvav", remove = TRUE, 
              na.rm = TRUE) %>%
    ##  Rename some columns:    
        rename(id = "Participant Private ID", prolific_id = "Participant Public ID", date = "UTC Date",
               system = "Participant OS", browser = "Participant Browser", monitor = "Participant Monitor Size",
               test_list = "branch-ebg9", question = "Question Key", response = "Response") %>%
    ##  Reorder columns:    
        select(id, prolific_id, date, system, browser, monitor, study_list, test_list, question, response) %>%
    ##  Set participant ID as the grouping variable, and arrange data by participant ID:
        group_by(id) %>%
        arrange(id) %>%
    ##  Remove empty / unimportant rows:
        drop_na(id) %>%
        filter(question != "BEGIN QUESTIONNAIRE") %>%    
        filter(question != "END QUESTIONNAIRE") %>%
    ##  Reformat from long to wide:
        spread(key = question, value = response) %>%
    ##  Remove unimportant columns:    
        select(-"age-quantised", -"attention_check-quantised", -"EngFirstLang-quantised", -"ethnicity-quantised", 
               -"ethnicity2-quantised", -"ethnicity3-quantised", -"mem_skills_1-quantised", 
               -"mem_skills_2-quantised", -"response-6-quantised", -"response-9-quantised") %>%
    ##  Merge multiple rows into one (per participant):
        summarise_all(coalesce_by_column) %>%
    ##  Rename more columns:
        rename(white = "ethnicity", mixed = "ethnicity2", asian = "ethnicity3", eng_first_lang = "EngFirstLang",
               mixed_other = "response-4", asian_other = "response-15", black = "response-6", 
               black_other = "response-7", other_ethnic = "response-9", other_ethnic_specified = "response-4") %>%
    ##  Reorder columns again:   
        select(id, prolific_id, date, system, browser, monitor, study_list, test_list, age, gender, 
                 eng_first_lang, white, white_other, mixed, mixed_other, asian, asian_other, black, 
                 black_other, other_ethnic, other_ethnic_specified, rec_justification, fam_justification,
                 guess_justification, mem_skills_1, mem_skills_2, attention_check) %>%
    ##  Recode attention check to show pass or fail:
        mutate(attention_check = str_replace(attention_check, "a lot better", "pass")) %>%
        mutate(attention_check = str_replace_all(attention_check, c("a lot worse" = "fail",
                                                                    "a little worse" = "fail", "the same" = "fail",
                                                                    "a little better" = "fail"))) %>%
    ##  Tidy up responses for clarity:
        mutate_all(., tolower) %>%
        mutate(system = str_remove_all(system, "\\ .+")) %>%
        mutate(browser = str_remove_all(browser, "\\ .+")) %>%
        mutate(mixed = str_remove_all(mixed, "\\ .+")) %>%
        mutate(asian = str_remove_all(asian, "\\ .+")) %>%
        mutate(black = str_remove_all(black, "\\ .+")) %>%
        mutate(gender = str_replace(gender, "^m$", "male")) %>%
        mutate(gender = replace_na(gender, "unspecified")) %>%
        arrange(study_list, test_list)
    
##    Calculate how many items P got correct during study:
##    Import study data:
      exp6__study_files <- c(
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-l7li.csv", # Study Red1 (pics=only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-qi5x.csv", # Study Red1 (pics-only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-pifd.csv", # Study Red2 (pics+word)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-uf3l.csv", # Study Red2 (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-l7li.csv", # Study Red1 (pics=only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-qi5x.csv", # Study Red1 (pics-only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-pifd.csv", # Study Red2 (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-uf3l.csv", # Study Red2 (pics+word)          
          
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-a3o7.csv", # Study Orange1 (pics-only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-1u76.csv", # Study Orange2 (pics-only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-3n1f.csv", # Study Orange1 (pics+word)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-5ium.csv", # Study Orange2 (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-a3o7.csv", # Study Orange1 (pics-only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-1u76.csv", # Study Orange2 (pics-only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-3n1f.csv", # Study Orange1 (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-5ium.csv", # Study Orange2 (pics+word)
                              
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-a9z8.csv",  # Study Yellow (pics only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-bqu6.csv",  # Study Yellow (pics only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-1v1k.csv",  # Study Yellow (pics+word)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-ggr4.csv",  # Study Yellow (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-a9z8.csv",  # Study Yellow (pics only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-bqu6.csv",  # Study Yellow (pics only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-1v1k.csv",  # Study Yellow (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-ggr4.csv",  # Study Yellow (pics+word)          
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-okc7.csv",  # Study Green (pics only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-wmoz.csv",  # Study Green (pics only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-jlur.csv",  # Study Green (pics+word)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-vbdo.csv",  # Study Green (pics+word)   
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-okc7.csv",  # Study Green (pics only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-wmoz.csv",  # Study Green (pics only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-jlur.csv",  # Study Green (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-vbdo.csv",  # Study Green (pics+word)           
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-pygj.csv",  # Study Teal (pics only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-qza1.csv",  # Study Teal (pics only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-eia6.csv",  # Study Teal (pics+word)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-7wwc.csv",  # Study Teal (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-pygj.csv",  # Study Teal (pics only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-qza1.csv",  # Study Teal (pics only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-eia6.csv",  # Study Teal (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-7wwc.csv",  # Study Teal (pics+word)          
          
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-j5hw.csv",  # Study Blue (pics only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-g65w.csv",  # Study Blue (pics only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-jayr.csv",  # Study Blue (pics+word)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-l2v4.csv",  # Study Blue (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-j5hw.csv",  # Study Blue (pics only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-g65w.csv",  # Study Blue (pics only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-jayr.csv",  # Study Blue (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-l2v4.csv",  # Study Blue (pics+word)          
          
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-s7up.csv",  # Study Purple (pics only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-qvph.csv",  # Study Purple (pics only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-9x5b.csv",  # Study Purple (pics+word)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-1nqy.csv",  # Study Purple (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-s7up.csv",  # Study Purple (pics only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-qvph.csv",  # Study Purple (pics only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-9x5b.csv",  # Study Purple (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-1nqy.csv",  # Study Purple (pics+word)          
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-jsz4.csv",  # Study Pink (pics only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-2j1b.csv",  # Study Pink (pics only)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-od4o.csv",  # Study Pink (pics+word)
          "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-qacf.csv")  # Study Pink (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-jsz4.csv",  # Study Pink (pics only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-2j1b.csv",  # Study Pink (pics only)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-od4o.csv",  # Study Pink (pics+word)
          #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-qacf.csv")  # Study Pink (pics+word)          
            
##  Create raw df from the above files, but only get the following columns:
    exp6__study_data <- map_dfr(exp6__study_files,~read_csv(.x, col_types = cols_only(
        "Participant Private ID" = 'c', "Participant Public ID"='c', "Screen Name" = 'c', "stim" = 'c',
        "correct_answer" = 'c', "Response" = 'c',"Reaction Time" = col_double()))) %>%
    ##  Rename some columns:
        rename(id = "Participant Private ID", prolific_id = "Participant Public ID", screen = "Screen Name",
               rt = "Reaction Time", response = "Response") %>%
    ##  Reorder columns:    
        select(id, prolific_id, screen, stim, correct_answer, response, rt) %>%
    ##  Set participant ID as the grouping variable, and arrange data by participant ID:
        group_by(id) %>%
        arrange(id) %>%         
    ##  Remove empty / unimportant rows:
        drop_na(screen) %>%
        filter(screen != "check") %>%
        filter(screen != "fixation") %>%
        filter(screen != "filler_start_fixation") %>%
        filter(screen != "filler_start_stim") %>%
        filter(screen != "filler_end_fixation") %>%
        filter(screen != "filler_end_stim") %>%
        add_count(screen, name = "total_resp")
##  Pics only (16 drawings + 16 photos = 32) + Pics/labels (16 drawings + 16 photos = 32) = 64 total stim at study.
##  Calculate how many responses were correct for each stimuli format, then join these together:
    exp6__drawing.only <- exp6__study_data %>%
        filter(str_detect(stim, "drawing.png") & correct_answer == "drawing.png") %>%
        add_count(screen, name = "study__drawing.only__resps") %>%
        filter(response == "drawing.png") %>%
        add_count(screen, name = "study__drawing.only__correct") %>%
        distinct(id, .keep_all = TRUE) %>%
        select(id, study__drawing.only__resps, study__drawing.only__correct)
    exp6__photo.only <- exp6__study_data %>%
        filter(str_detect(stim, "photo.png") & correct_answer == "photo.png") %>%
        add_count(screen, name = "study__photo.only__resps") %>%
        filter(response == "photo.png") %>%
        add_count(screen, name = "study__photo.only__correct") %>%
        distinct(id, .keep_all = TRUE) %>%
        select(id, study__photo.only__resps, study__photo.only__correct)
    exp6__drawing.plus.word <- exp6__study_data %>%
        filter(str_detect(stim, "drawing-word.png") & correct_answer == "drawingplusword.png") %>%
        add_count(screen, name = "study__drawing.plus.word__resps") %>%
        filter(response == "drawingplusword.png") %>%
        add_count(screen, name = "study__drawing.plus.word__correct") %>%
        distinct(id, .keep_all = TRUE) %>%
        select(id, study__drawing.plus.word__resps, study__drawing.plus.word__correct)
    exp6__photo.plus.word <- exp6__study_data %>%
        filter(str_detect(stim, "photo-word.png") & correct_answer == "photoplusword.png") %>%
        add_count(screen, name = "study__photo.plus.word__resps") %>%
        filter(response == "photoplusword.png") %>%
        add_count(screen, name = "study__photo.plus.word__correct") %>%
        distinct(id, .keep_all = TRUE) %>%
        select(id, study__photo.plus.word__resps, study__photo.plus.word__correct) 
    exp6__study_totals <- right_join(exp6__drawing.only, exp6__photo.only, by = "id") %>%
        right_join(exp6__drawing.plus.word, by = "id") %>%
        right_join(exp6__photo.plus.word, by = "id")

##  Add 'exp6__study_totals' to 'exp6__participant_info' df:
    exp6__participant_info <- exp6__participant_info %>%
        right_join(exp6__study_totals, by = "id") %>%
        mutate(study_responses_total = study__drawing.only__resps + study__photo.only__resps +
                  study__drawing.plus.word__resps + study__photo.plus.word__resps) %>%
        mutate(study_correct = study__drawing.only__correct + study__photo.only__correct +
                  study__drawing.plus.word__correct + study__photo.plus.word__correct) %>%
        mutate(study_correct_percent = study_correct*(100/study_responses_total)) %>%
        mutate(study_error = study_responses_total - study_correct) %>%
        mutate(study_error_percent = study_error*(100/study_responses_total)) %>%
        arrange(study_list, test_list) %>%
        select(id, prolific_id, everything())

##################################################################################################################
##  Define study lists:                                                                                         ##
##################################################################################################################
    exp6__red.study.list <- c("anchor--photo-word","balloon--drawing-word","basket--photo-word",
        "boot--photo-word","bottle--drawing","bowl--photo-word","broom--drawing",
        "button--photo-word","cake--drawing","camel--drawing-word","candle--photo",
        "celery--photo","clock--photo","cloud--photo-word","comb--photo-word","corn--photo",
        "doll--photo-word","donkey--photo-word","door--photo","drum--drawing-word",
        "eagle--photo","fish--drawing","flute--photo","goat--drawing-word","grapes--photo-word",
        "guitar--drawing","hammer--photo-word","horse--drawing-word","house--photo",
        "iron--drawing-word","kite--drawing","knife--drawing","ladder--drawing-word",
        "lamp--photo-word","lobster--drawing-word","nail--photo-word","needle--drawing-word",
        "onion--photo","peach--photo","peacock--photo-word","peanut--drawing",
        "pear--drawing-word","piano--drawing-word","pliers--photo","potato--drawing-word",
        "rabbit--photo-word","ring--drawing","screw--drawing","sheep--drawing-word",
        "shirt--drawing-word","skunk--photo","snail--drawing","socks--drawing-word",
        "spider--drawing","spoon--photo","table--photo","thimble--drawing","thumb--drawing",
        "toaster--photo","tree--drawing","trumpet--drawing","violin--photo-word","watch--photo",
        "zebra--drawing-word")    
    exp6__orange.study.list <- c("anchor--photo","balloon--drawing","basket--photo","boot--photo",
        "bottle--drawing-word","bowl--photo","broom--drawing-word","button--photo",
        "cake--drawing-word","camel--drawing","candle--photo-word","celery--photo-word",
        "clock--photo-word","cloud--photo","comb--photo","corn--photo-word","doll--photo",
        "donkey--photo","door--photo-word","drum--drawing","eagle--photo-word",
        "fish--drawing-word","flute--photo-word","goat--drawing","grapes--photo",
        "guitar--drawing-word","hammer--photo","horse--drawing","house--photo-word",
        "iron--drawing","kite--drawing-word","knife--drawing-word","ladder--drawing",
        "lamp--photo","lobster--drawing","nail--photo","needle--drawing","onion--photo-word",
        "peach--photo-word","peacock--photo","peanut--drawing-word","pear--drawing",
        "piano--drawing","pliers--photo-word","potato--drawing","rabbit--photo",
        "ring--drawing-word","screw--drawing-word","sheep--drawing","shirt--drawing",
        "skunk--photo-word","snail--drawing-word","socks--drawing","spider--drawing-word",
        "spoon--photo-word","table--photo-word","thimble--drawing-word","thumb--drawing-word",
        "toaster--photo-word","tree--drawing-word","trumpet--drawing-word","violin--photo",
        "watch--photo-word","zebra--drawing")
    exp6__yellow.study.list <- c("anchor--drawing-word","balloon--photo-word","basket--drawing-word",
        "boot--drawing-word","bottle--photo","bowl--drawing-word","broom--photo",
        "button--drawing-word","cake--photo","camel--photo-word","candle--drawing",
        "celery--drawing","clock--drawing","cloud--drawing-word","comb--drawing-word",
        "corn--drawing","doll--drawing-word","donkey--drawing-word","door--drawing",
        "drum--photo-word","eagle--drawing","fish--photo","flute--drawing","goat--photo-word",
        "grapes--drawing-word","guitar--photo","hammer--drawing-word","horse--photo-word",
        "house--drawing","iron--photo-word","kite--photo","knife--photo","ladder--photo-word",
        "lamp--drawing-word","lobster--photo-word","nail--drawing-word","needle--photo-word",
        "onion--drawing","peach--drawing","peacock--drawing-word","peanut--photo",
        "pear--photo-word","piano--photo-word","pliers--drawing","potato--photo-word",
        "rabbit--drawing-word","ring--photo","screw--photo","sheep--photo-word",
        "shirt--photo-word","skunk--drawing","snail--photo","socks--photo-word",
        "spider--photo","spoon--drawing","table--drawing","thimble--photo","thumb--photo",
        "toaster--drawing","tree--photo","trumpet--photo","violin--drawing-word",
        "watch--drawing","zebra--photo-word")
    exp6__green.study.list <- c("anchor--drawing","balloon--photo","basket--drawing",
        "boot--drawing","bottle--photo-word","bowl--drawing","broom--photo-word",
        "button--drawing","cake--photo-word","camel--photo","candle--drawing-word",
        "celery--drawing-word","clock--drawing-word","cloud--drawing","comb--drawing",
        "corn--drawing-word","doll--drawing","donkey--drawing","door--drawing-word",
        "drum--photo","eagle--drawing-word","fish--photo-word","flute--drawing-word",
        "goat--photo","grapes--drawing","guitar--photo-word","hammer--drawing","horse--photo",
        "house--drawing-word","iron--photo","kite--photo-word","knife--photo-word",
        "ladder--photo","lamp--drawing","lobster--photo","nail--drawing","needle--photo",
        "onion--drawing-word","peach--drawing-word","peacock--drawing","peanut--photo-word",
        "pear--photo","piano--photo","pliers--drawing-word","potato--photo","rabbit--drawing",
        "ring--photo-word","screw--photo-word","sheep--photo","shirt--photo",
        "skunk--drawing-word","snail--photo-word","socks--photo","spider--photo-word",
        "spoon--drawing-word","table--drawing-word","thimble--photo-word","thumb--photo-word",
        "toaster--drawing-word","tree--photo-word","trumpet--photo-word","violin--drawing",
        "watch--drawing-word","zebra--photo")
    exp6__teal.study.list <- c("apple--photo-word","ashtray--photo","banana--drawing-word",
        "barrel--photo-word","bear--drawing-word","bell--drawing","belt--drawing","book--photo",
        "bread--photo","brush--photo-word","cannon--drawing","carrot--photo",
        "chain--drawing-word","chair--photo-word","cherry--drawing-word","chicken--photo",
        "crown--photo-word","deer--drawing","dress--drawing","duck--drawing-word",
        "fence--drawing","flag--photo-word","flower--photo","foot--drawing-word","frog--photo",
        "giraffe--drawing","glasses--drawing-word","harp--photo-word","jacket--drawing-word",
        "kettle--drawing","leaf--photo","lemon--drawing","lion--drawing-word","lips--drawing",
        "lock--photo","mitten--photo-word","monkey--drawing","moon--drawing","mouse--drawing",
        "nose--photo","orange--photo-word","ostrich--drawing","pencil--photo-word",
        "penguin--drawing","pepper--photo","pipe--photo","plug--photo","pumpkin--photo-word",
        "raccoon--photo","ruler--drawing-word","seal--photo-word","shoe--drawing-word",
        "skirt--drawing-word","snake--drawing-word","snowman--drawing-word","stool--drawing",
        "swan--photo-word","swing--photo-word","tiger--photo-word","tomato--photo-word",
        "train--drawing-word","well--photo","whistle--photo","window--drawing-word")
    exp6__blue.study.list <- c("apple--photo","ashtray--photo-word","banana--drawing",
        "barrel--photo","bear--drawing","bell--drawing-word","belt--drawing-word",
        "book--photo-word","bread--photo-word","brush--photo","cannon--drawing-word",
        "carrot--photo-word","chain--drawing","chair--photo","cherry--drawing",
        "chicken--photo-word","crown--photo","deer--drawing-word","dress--drawing-word",
        "duck--drawing","fence--drawing-word","flag--photo","flower--photo-word",
        "foot--drawing","frog--photo-word","giraffe--drawing-word","glasses--drawing",
        "harp--photo","jacket--drawing","kettle--drawing-word","leaf--photo-word",
        "lemon--drawing-word","lion--drawing","lips--drawing-word","lock--photo-word",
        "mitten--photo","monkey--drawing-word","moon--drawing-word","mouse--drawing-word",
        "nose--photo-word","orange--photo","ostrich--drawing-word","pencil--photo",
        "penguin--drawing-word","pepper--photo-word","pipe--photo-word","plug--photo-word",
        "pumpkin--photo","raccoon--photo-word","ruler--drawing","seal--photo","shoe--drawing",
        "skirt--drawing","snake--drawing","snowman--drawing","stool--drawing-word",
        "swan--photo","swing--photo","tiger--photo","tomato--photo","train--drawing",
        "well--photo-word","whistle--photo-word","window--drawing")
    exp6__purple.study.list <- c("apple--drawing-word","ashtray--drawing","banana--photo-word",
        "barrel--drawing-word","bear--photo-word","bell--photo","belt--photo","book--drawing",
        "bread--drawing","brush--drawing-word","cannon--photo","carrot--drawing",
        "chain--photo-word","chair--drawing-word","cherry--photo-word","chicken--drawing",
        "crown--drawing-word","deer--photo","dress--photo","duck--photo-word","fence--photo",
        "flag--drawing-word","flower--drawing","foot--photo-word","frog--drawing",
        "giraffe--photo","glasses--photo-word","harp--drawing-word","jacket--photo-word",
        "kettle--photo","leaf--drawing","lemon--photo","lion--photo-word","lips--photo",
        "lock--drawing","mitten--drawing-word","monkey--photo","moon--photo","mouse--photo",
        "nose--drawing","orange--drawing-word","ostrich--photo","pencil--drawing-word",
        "penguin--photo","pepper--drawing","pipe--drawing","plug--drawing",
        "pumpkin--drawing-word","raccoon--drawing","ruler--photo-word","seal--drawing-word",
        "shoe--photo-word","skirt--photo-word","snake--photo-word","snowman--photo-word",
        "stool--photo","swan--drawing-word","swing--drawing-word","tiger--drawing-word",
        "tomato--drawing-word","train--photo-word","well--drawing","whistle--drawing",
        "window--photo-word")
    exp6__pink.study.list <- c("apple--drawing","ashtray--drawing-word","banana--photo",
        "barrel--drawing","bear--photo","bell--photo-word","belt--photo-word",
        "book--drawing-word","bread--drawing-word","brush--drawing","cannon--photo-word",
        "carrot--drawing-word","chain--photo","chair--drawing","cherry--photo",
        "chicken--drawing-word","crown--drawing","deer--photo-word","dress--photo-word",
        "duck--photo","fence--photo-word","flag--drawing","flower--drawing-word","foot--photo",
        "frog--drawing-word","giraffe--photo-word","glasses--photo","harp--drawing",
        "jacket--photo","kettle--photo-word","leaf--drawing-word","lemon--photo-word",
        "lion--photo","lips--photo-word","lock--drawing-word","mitten--drawing",
        "monkey--photo-word","moon--photo-word","mouse--photo-word","nose--drawing-word",
        "orange--drawing","ostrich--photo-word","pencil--drawing","penguin--photo-word",
        "pepper--drawing-word","pipe--drawing-word","plug--drawing-word","pumpkin--drawing",
        "raccoon--drawing-word","ruler--photo","seal--drawing","shoe--photo","skirt--photo",
        "snake--photo","snowman--photo","stool--photo-word","swan--drawing","swing--drawing",
        "tiger--drawing","tomato--drawing","train--photo","well--drawing-word",
        "whistle--drawing-word","window--photo")
##################################################################################################################
##  Test data:                                                                                                  ##
##################################################################################################################
##  Import test data:
    exp6__test_files <- c(
        "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-eo3t.csv", # Red + Teal
        #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-eo3t.csv", # Red + Teal
        "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-hnun.csv", # Orange + Blue
        #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-hnun.csv", # Orange + Blue
        "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-tmr7.csv", # Yellow + Purple
        #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-tmr7.csv", # Yellow + Purple
        "./resources/experiment_6/experiment_6_data/data_exp_47727-v6_task-cdc5.csv") # Green + Pink
        #"./resources/experiment_6/experiment_6_data/data_exp_47727-v7_task-cdc5.csv") # Green + Pink
    
##  Create raw df from the above files, but only get the following columns:
    exp6__test_data <- map_dfr(exp6__test_files,~read_csv(.x, col_types = cols_only(
        "Participant Private ID" = 'c', "Participant Public ID"='c', "Task Name" = 'c', "Screen Name" = 'c',
        "randomiser-6j1g"='c', "randomiser-rj7w"='c', "randomiser-enay"='c', "randomiser-gw7n"='c',
        "randomiser-uc11"='c', "randomiser-hpp5"='c', "randomiser-qhxy" = 'c', "randomiser-vvav" = 'c', 
        "stim" = 'c', "Response" = 'c', "Reaction Time" = col_double()))) %>%
    ##  Merge columns that contain the same type of data, but were originally split into different columns:
        unite(study_list,  "randomiser-6j1g", "randomiser-rj7w", "randomiser-enay","randomiser-gw7n",
              "randomiser-uc11", "randomiser-hpp5", "randomiser-qhxy", "randomiser-vvav", remove = TRUE, 
              na.rm = TRUE) %>% 
    ##  Rename some columns:    
        rename(id = "Participant Private ID", prolific_id = "Participant Public ID", test_list = "Task Name",
               screen = "Screen Name", response = "Response", rt = "Reaction Time") %>%
    ##  Reorder columns:    
        select(id, prolific_id, study_list, test_list, screen, stim, response, rt) %>%
    ##  Set participant ID as the grouping variable, and arrange data by participant ID:
        group_by(id) %>%
        arrange(id) %>%
    ##  Remove empty / unimportant rows:
        drop_na(screen) %>%
        filter(screen != "check") %>% 
        filter(screen != "Screen 1") %>% 
        filter(screen != "Fixation") %>% 
        filter(response != "old.png") %>%
    ##  Tidy up responses for clarity:
        mutate_all(., tolower) %>%
        mutate(stim = str_remove_all(stim, ".png")) %>%
        mutate(response = str_remove_all(response, ".png")) %>%
        arrange(id, response, stim) %>%
        mutate(test_list = str_remove_all(test_list, " test")) %>%
        mutate(study_list = str_remove_all(study_list, "\\.(.*)"))
      
##  Remove filler responses:
    exp6__filler_stim <- c("alligator--drawing","beetle--photo","bicycle--photo","butterfly--drawing",
        "chisel--photo","desk--drawing","dresser--photo-word","glass--drawing-word","hand--photo",
        "helicopter--drawing-word","lightbulb--drawing-word","pitcher--photo-word","strawberry--drawing",
        "toothbrush--drawing-word","turtle--photo-word","vest--photo-word")
    exp6__test_data <- exp6__test_data %>%
        filter(!stim %in% exp6__filler_stim)

##################################################################################################################
##    Hit and miss calculations:                                                                                ##
##################################################################################################################
##  Define our own function that calculates hit and miss totals. 
      exp6__hit_and_miss_calc_function <- function(x){
    ##  Count general totals:
          x <- x %>%
              add_tally(response != "new", sort = FALSE, name = "hit__total") %>%
              add_tally(response == "new", sort = FALSE, name = "miss__total") %>%
              add_tally(response == "recollection", sort = FALSE, name = "hit.R__total") %>%
              add_tally(response == "familiarity", sort = FALSE, name = "hit.F__total") %>%
              add_tally(response == "guessing", sort = FALSE, name = "hit.G__total") %>%
    ##  Count stim-format totals:
        ##  Drawings only:
              add_tally(str_detect(stim, "drawing") & !str_detect(stim, "word") & response != "new",
                  sort = FALSE, name = "hit__drawing.only") %>%
              add_tally((str_detect(stim, "drawing") & !str_detect(stim, "word")) & response == "new",
                  sort = FALSE, name = "miss__drawing.only") %>%
        ##  Photos only:
              add_tally(str_detect(stim, "photo") & !str_detect(stim, "word") & response != "new",
                  sort = FALSE, name = "hit__photo.only") %>%
              add_tally(str_detect(stim, "photo") & !str_detect(stim, "word") & response == "new",
                  sort = FALSE, name = "miss__photo.only") %>%
        ##  Drawings + words:
              add_tally(str_detect(stim, "drawing-word") & response != "new",
                  sort = FALSE, name = "hit__drawing.plus.word") %>%
              add_tally(str_detect(stim, "drawing-word") & response == "new",
                  sort = FALSE, name = "miss__drawing.plus.word") %>%
        ##  Drawings + words:
              add_tally(str_detect(stim, "photo-word") & response != "new",
                  sort = FALSE, name = "hit__photo.plus.word") %>%
              add_tally(str_detect(stim, "photo-word") & response == "new",
                  sort = FALSE, name = "miss__photo.plus.word") %>%
    ##  Count stim-format totals by response option:
        ##  Drawings only:
              add_tally(str_detect(stim, "drawing") & !str_detect(stim, "word") & response == "recollection",
                            sort = FALSE, name = "hit.R__drawing.only") %>%
              add_tally(str_detect(stim, "drawing") & !str_detect(stim, "word") & response == "familiarity",
                            sort = FALSE, name = "hit.F__drawing.only") %>%        
              add_tally(str_detect(stim, "drawing") & !str_detect(stim, "word") & response == "guessing",
                            sort = FALSE, name = "hit.G__drawing.only") %>%           
        ##  Photos only:
              add_tally(str_detect(stim, "photo") & !str_detect(stim, "word") & response == "recollection",
                            sort = FALSE, name = "hit.R__photo.only") %>%
              add_tally(str_detect(stim, "photo") & !str_detect(stim, "word") & response == "familiarity",
                            sort = FALSE, name = "hit.F__photo.only") %>%        
              add_tally(str_detect(stim, "photo") & !str_detect(stim, "word") & response == "guessing",
                            sort = FALSE, name = "hit.G__photo.only") %>%   
        ##  Drawings plus words:
              add_tally(str_detect(stim, "drawing-word") & response == "recollection",
                            sort = FALSE, name = "hit.R__drawing.plus.word") %>%
              add_tally(str_detect(stim, "drawing-word") & response == "familiarity",
                            sort = FALSE, name = "hit.F__drawing.plus.word") %>%        
              add_tally(str_detect(stim, "drawing-word") & response == "guessing",
                            sort = FALSE, name = "hit.G__drawing.plus.word") %>%           
        ##  Photos plus words:
              add_tally(str_detect(stim, "photo-word") & response == "recollection",
                            sort = FALSE, name = "hit.R__photo.plus.word") %>%
              add_tally(str_detect(stim, "photo-word") & response == "familiarity",
                            sort = FALSE, name = "hit.F__photo.plus.word") %>%        
              add_tally(str_detect(stim, "photo-word") & response == "guessing",
                            sort = FALSE, name = "hit.G__photo.plus.word")}    
    
##################################################################################################################
##  Filter 'exp6__test_data' by each study list, one-at-a-time, resulting in x8 df (red, orange, yellow, green, ##
##  teal, blue, purple, pink). For each, run our function that calculates the hit and miss totals, then rejoin  ##
##  into one df:                                                                                                ##
##################################################################################################################
##  Study Red:
    exp6__hit.miss__study.red <- exp6__test_data %>%    ##  Get all test data (targets + lures). 
        filter(study_list == "red") %>%                 ##  Filter by P who studied this list.
        filter(stim %in% exp6__red.study.list) %>%      ##  Filter by items in this study list (only get targets).
        exp6__hit_and_miss_calc_function                ##  Run custom function to calculate hits and misses. 
##  Study Orange:
    exp6__hit.miss__study.orange <- exp6__test_data %>%
        filter(study_list == "orange") %>%
        filter(stim %in% exp6__orange.study.list) %>%
        exp6__hit_and_miss_calc_function
##  Study Yellow:
    exp6__hit.miss__study.yellow <- exp6__test_data %>%
        filter(study_list == "yellow") %>%
        filter(stim %in% exp6__yellow.study.list) %>%
        exp6__hit_and_miss_calc_function
##  Study Green:
    exp6__hit.miss__study.green <- exp6__test_data %>%
        filter(study_list == "green") %>%
        filter(stim %in% exp6__green.study.list) %>%
        exp6__hit_and_miss_calc_function
##  Study Teal:
    exp6__hit.miss__study.teal <- exp6__test_data %>%
        filter(study_list == "teal") %>%
        filter(stim %in% exp6__teal.study.list) %>%
        exp6__hit_and_miss_calc_function
##  Study Blue:
    exp6__hit.miss__study.blue <- exp6__test_data %>%
        filter(study_list == "blue") %>%
        filter(stim %in% exp6__blue.study.list) %>%
        exp6__hit_and_miss_calc_function
##  Study Purple:
    exp6__hit.miss__study.purple <- exp6__test_data %>%
        filter(study_list == "purple") %>%
        filter(stim %in% exp6__purple.study.list) %>%
        exp6__hit_and_miss_calc_function
##  Study Pink:
    exp6__hit.miss__study.pink <- exp6__test_data %>%
        filter(study_list == "pink") %>%
        filter(stim %in% exp6__pink.study.list) %>%
        exp6__hit_and_miss_calc_function    
##################################################################################################################
##  Combine into one df:                                                                                        ##
##################################################################################################################
    exp6__hit_and_miss <- bind_rows(exp6__hit.miss__study.red, exp6__hit.miss__study.orange,
                                    exp6__hit.miss__study.yellow, exp6__hit.miss__study.green,
                                    exp6__hit.miss__study.teal, exp6__hit.miss__study.blue,
                                    exp6__hit.miss__study.purple, exp6__hit.miss__study.pink) %>%
    ##  Merge multiple rows into one (per participant):
        summarise_all(coalesce_by_column) %>%
    ##  Remove redundant rows: 
        select(-screen, -stim, -response, -rt)
##################################################################################################################
##    FA and CR calculations:                                                                                   ##
##################################################################################################################
##  Define our own function that calculates FA and CR totals. 
      exp6__FA_and_CR_calc_function <- function(x){
    ##  Count general totals:
          x <- x %>%
              add_tally(response != "new", sort = FALSE, name = "FA__total") %>%
              add_tally(response == "new", sort = FALSE, name = "CR__total") %>%
              add_tally(response == "recollection", sort = FALSE, name = "FA.R__total") %>%
              add_tally(response == "familiarity", sort = FALSE, name = "FA.F__total") %>%
              add_tally(response == "guessing", sort = FALSE, name = "FA.G__total") %>%   
    ##  Count stim-format totals:
        ##  Drawings only:
              add_tally(str_detect(stim, "drawing") & !str_detect(stim, "word") & response != "new",
                  sort = FALSE, name = "FA__drawing.only") %>%
              add_tally(str_detect(stim, "drawing") & !str_detect(stim, "word") & response == "new",
                  sort = FALSE, name = "CR__drawing.only") %>%
        ##  Photos only:
              add_tally(str_detect(stim, "photo") & !str_detect(stim, "word") & response != "new",
                  sort = FALSE, name = "FA__photo.only") %>%
              add_tally(str_detect(stim, "photo") & !str_detect(stim, "word") & response == "new",
                  sort = FALSE, name = "CR__photo.only") %>%
        ##  Drawings + words:
              add_tally(str_detect(stim, "drawing-word") & response != "new",
                  sort = FALSE, name = "FA__drawing.plus.word") %>%
              add_tally(str_detect(stim, "drawing-word") & response == "new",
                  sort = FALSE, name = "CR__drawing.plus.word") %>%
        ##  Drawings + words:
              add_tally(str_detect(stim, "photo-word") & response != "new",
                  sort = FALSE, name = "FA__photo.plus.word") %>%
              add_tally(str_detect(stim, "photo-word") & response == "new",
                  sort = FALSE, name = "CR__photo.plus.word") %>%
    ##  Count stim-format totals by response option:
        ##  Drawings only:
              add_tally(str_detect(stim, "drawing") & !str_detect(stim, "word") & response == "recollection",
                            sort = FALSE, name = "FA.R__drawing.only") %>%
              add_tally(str_detect(stim, "drawing") & !str_detect(stim, "word") & response == "familiarity",
                            sort = FALSE, name = "FA.F__drawing.only") %>%        
              add_tally(str_detect(stim, "drawing") & !str_detect(stim, "word") & response == "guessing",
                            sort = FALSE, name = "FA.G__drawing.only") %>%           
        ##  Photos only:
              add_tally(str_detect(stim, "photo") & !str_detect(stim, "word") & response == "recollection",
                            sort = FALSE, name = "FA.R__photo.only") %>%
              add_tally(str_detect(stim, "photo") & !str_detect(stim, "word") & response == "familiarity",
                            sort = FALSE, name = "FA.F__photo.only") %>%        
              add_tally(str_detect(stim, "photo") & !str_detect(stim, "word") & response == "guessing",
                            sort = FALSE, name = "FA.G__photo.only") %>%   
        ##  Drawings plus words:
              add_tally(str_detect(stim, "drawing-word") & response == "recollection",
                            sort = FALSE, name = "FA.R__drawing.plus.word") %>%
              add_tally(str_detect(stim, "drawing-word") & response == "familiarity",
                            sort = FALSE, name = "FA.F__drawing.plus.word") %>%        
              add_tally(str_detect(stim, "drawing-word") & response == "guessing",
                            sort = FALSE, name = "FA.G__drawing.plus.word") %>%           
        ##  Photos plus words:
              add_tally(str_detect(stim, "photo-word") & response == "recollection",
                            sort = FALSE, name = "FA.R__photo.plus.word") %>%
              add_tally(str_detect(stim, "photo-word") & response == "familiarity",
                            sort = FALSE, name = "FA.F__photo.plus.word") %>%        
              add_tally(str_detect(stim, "photo-word") & response == "guessing",
                            sort = FALSE, name = "FA.G__photo.plus.word")}
##################################################################################################################
##  Filter 'exp6__test_data' by each study list, one-at-a-time, resulting in x8 df (red, orange, yellow, green, ##
##  teal, blue, purple, pink). For each, run our function that calculates the FA and CR totals, then rejoin     ##
##  into one df:                                                                                                ##
##################################################################################################################
##  Study Red:
    exp6__FA.CR__study.red <- exp6__test_data %>%       ##  Get all test data (targets + lures). 
        filter(study_list == "red") %>%                 ##  Filter by P who studied this list.
        filter(stim %in% exp6__teal.study.list) %>%     ##  Filter by items in the unstudied list (only lures).
        exp6__FA_and_CR_calc_function                   ##  Run custom function to calculate FAs and CRs. 
##  Study Orange:
    exp6__FA.CR__study.orange <- exp6__test_data %>%
        filter(study_list == "orange") %>%
        filter(stim %in% exp6__blue.study.list) %>%
        exp6__FA_and_CR_calc_function
##  Study Yellow:
    exp6__FA.CR__study.yellow <- exp6__test_data %>%
        filter(study_list == "yellow") %>%
        filter(stim %in% exp6__purple.study.list) %>%
        exp6__FA_and_CR_calc_function
##  Study Green:
    exp6__FA.CR__study.green <- exp6__test_data %>%
        filter(study_list == "green") %>%
        filter(stim %in% exp6__pink.study.list) %>%
        exp6__FA_and_CR_calc_function
##  Study Teal:
    exp6__FA.CR__study.teal <- exp6__test_data %>%
        filter(study_list == "teal") %>%
        filter(stim %in% exp6__red.study.list) %>%
        exp6__FA_and_CR_calc_function
##  Study Blue:
    exp6__FA.CR__study.blue <- exp6__test_data %>%
        filter(study_list == "blue") %>%
        filter(stim %in% exp6__orange.study.list) %>%
        exp6__FA_and_CR_calc_function
##  Study Purple:
    exp6__FA.CR__study.purple <- exp6__test_data %>%
        filter(study_list == "purple") %>%
        filter(stim %in% exp6__yellow.study.list) %>%
        exp6__FA_and_CR_calc_function
##  Study Pink:
    exp6__FA.CR__study.pink <- exp6__test_data %>%
        filter(study_list == "pink") %>%
        filter(stim %in% exp6__green.study.list) %>%
        exp6__FA_and_CR_calc_function
##################################################################################################################
##  Combine into one df:                                                                                        ##
##################################################################################################################
    exp6__FA_and_CR <- bind_rows(exp6__FA.CR__study.red, exp6__FA.CR__study.orange,
                                    exp6__FA.CR__study.yellow, exp6__FA.CR__study.green,
                                    exp6__FA.CR__study.teal, exp6__FA.CR__study.blue,
                                    exp6__FA.CR__study.purple, exp6__FA.CR__study.pink) %>%
    ##  Merge multiple rows into one (per participant):
        summarise_all(coalesce_by_column) %>%
    ##  Remove redundant rows: 
        select(-screen, -stim, -response, -rt)
##################################################################################################################
##  Proportions, z-scores, d', c:                                                                               ##
##################################################################################################################
##  Join 'exp6__hit_and_miss' and 'exp6__FA_and_CR' dfs:
    exp6__test.stats <- exp6__hit_and_miss %>%
        right_join(exp6__FA_and_CR) %>%
##################################################################################################################
##  Calculate hit proportions:                                                                                  ##
##################################################################################################################
    ##  Drawings only:
        mutate(prop.hit__drawing.only = hit__drawing.only / (hit__drawing.only + miss__drawing.only)) %>%
            mutate(prop.hit__drawing.only = replace_na(prop.hit__drawing.only, 0)) %>%
        mutate(prop.miss__drawing.only = miss__drawing.only / (hit__drawing.only + miss__drawing.only)) %>%
            mutate(prop.miss__drawing.only = replace_na(prop.miss__drawing.only, 0)) %>%
        mutate(prop.hit.R__drawing.only = hit.R__drawing.only / hit__drawing.only) %>% 
            mutate(prop.hit.R__drawing.only = replace_na(prop.hit.R__drawing.only, 0)) %>%
        mutate(prop.hit.F__drawing.only = hit.F__drawing.only / hit__drawing.only) %>% 
            mutate(prop.hit.F__drawing.only = replace_na(prop.hit.F__drawing.only, 0)) %>%
        mutate(prop.hit.G__drawing.only = hit.G__drawing.only / hit__drawing.only) %>% 
            mutate(prop.hit.G__drawing.only = replace_na(prop.hit.G__drawing.only, 0)) %>%
    ##  Photos only:
        mutate(prop.hit__photo.only = hit__photo.only / (hit__photo.only + miss__photo.only)) %>%
            mutate(prop.hit__photo.only = replace_na(prop.hit__photo.only, 0)) %>%
        mutate(prop.miss__photo.only = miss__photo.only / (hit__photo.only + miss__photo.only)) %>%
            mutate(prop.miss__photo.only = replace_na(prop.miss__photo.only, 0)) %>%
        mutate(prop.hit.R__photo.only = hit.R__photo.only / hit__photo.only) %>% 
            mutate(prop.hit.R__photo.only = replace_na(prop.hit.R__photo.only, 0)) %>%
        mutate(prop.hit.F__photo.only = hit.F__photo.only / hit__photo.only) %>% 
            mutate(prop.hit.F__photo.only = replace_na(prop.hit.F__photo.only, 0)) %>%
        mutate(prop.hit.G__photo.only = hit.G__photo.only / hit__photo.only) %>% 
            mutate(prop.hit.G__photo.only = replace_na(prop.hit.G__photo.only, 0)) %>%     
    ##  Drawings plus words:
        mutate(prop.hit__drawing.plus.word = hit__drawing.plus.word / 
              (hit__drawing.plus.word + miss__drawing.plus.word)) %>%
            mutate(prop.hit__drawing.plus.word = replace_na(prop.hit__drawing.plus.word, 0)) %>%
        mutate(prop.miss__drawing.plus.word = miss__drawing.plus.word / 
              (hit__drawing.plus.word + miss__drawing.plus.word)) %>%
            mutate(prop.miss__drawing.plus.word = replace_na(prop.miss__drawing.plus.word, 0)) %>%
        mutate(prop.hit.R__drawing.plus.word = hit.R__drawing.plus.word / hit__drawing.plus.word) %>% 
            mutate(prop.hit.R__drawing.plus.word = replace_na(prop.hit.R__drawing.plus.word, 0)) %>%
        mutate(prop.hit.F__drawing.plus.word = hit.F__drawing.plus.word / hit__drawing.plus.word) %>% 
            mutate(prop.hit.F__drawing.plus.word = replace_na(prop.hit.F__drawing.plus.word, 0)) %>%
        mutate(prop.hit.G__drawing.plus.word = hit.G__drawing.plus.word / hit__drawing.plus.word) %>% 
            mutate(prop.hit.G__drawing.plus.word = replace_na(prop.hit.G__drawing.plus.word, 0)) %>%
    ##  Photos plus words:
        mutate(prop.hit__photo.plus.word = hit__photo.plus.word / 
              (hit__photo.plus.word + miss__photo.plus.word)) %>%
            mutate(prop.hit__photo.plus.word = replace_na(prop.hit__photo.plus.word, 0)) %>%
        mutate(prop.miss__photo.plus.word = miss__photo.plus.word / 
              (hit__photo.plus.word + miss__photo.plus.word)) %>%
            mutate(prop.miss__photo.plus.word = replace_na(prop.miss__photo.plus.word, 0)) %>%
        mutate(prop.hit.R__photo.plus.word = hit.R__photo.plus.word / hit__photo.plus.word) %>% 
            mutate(prop.hit.R__photo.plus.word = replace_na(prop.hit.R__photo.plus.word, 0)) %>%
        mutate(prop.hit.F__photo.plus.word = hit.F__photo.plus.word / hit__photo.plus.word) %>% 
            mutate(prop.hit.F__photo.plus.word = replace_na(prop.hit.F__photo.plus.word, 0)) %>%
        mutate(prop.hit.G__photo.plus.word = hit.G__photo.plus.word / hit__photo.plus.word) %>% 
            mutate(prop.hit.G__photo.plus.word = replace_na(prop.hit.G__photo.plus.word, 0)) %>%
## Programming error (these P didn't see non-word items, so we remove them):    
          filter(prolific_id != 14637 & prolific_id != 14020) 
    
  
    
write.csv(exp6__test.stats,'~/Desktop/exp6__test.stats.csv', row.names = FALSE)
```      