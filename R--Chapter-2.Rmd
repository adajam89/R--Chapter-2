---
output: 
  pdf_document:
    toc: yes
    toc_depth: 4
    number_sections: no
    fig_caption: yes
    latex_engine: xelatex
mainfont: Helvetica
font-family: Helvetica Neue
fontsize: 11pt
geometry: left=35mm, right=20mm, top=30mm, bottom=30mm
bibliography: resources/refs.bib
csl: resources/apa.csl
header-includes:
- \usepackage{fancyhdr}                           # Latex package for formatting PDFs.
- \pagestyle{fancy}                               # Set page style.
- \renewcommand{\headrulewidth}{1.5pt}            # Thickness of header line.
- \setlength{\headheight}{13.59999pt}             # Ensures consistent space between header line and text.
- \renewcommand{\href}[2]{#2\footnote{\url{#1}}}  # Show URLs in footnote.
#- \usepackage{setspace}\doublespacing            # Double spacing.
#- \usepackage{booktabs}                          # Used for presenting tables.
#- \fancyhead[L]{\textsl{CHAPTER 2}}              # Chapter number (top left header).
#- \fancyhead[R]{\textsl{\rightmark}}             # Section number (top right header).
- \usepackage{pdflscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}
#- \usepackage{graphicx}
#- \graphicspath{ {./resources/images/} }
#- \usepackage{float}
---

```{r load-packages, include=FALSE, cache=FALSE}
rm(list=ls())  
# List required packages:
    required_packages <- c("tidyverse", "dplyr", "captioner", "tinytex", "kableExtra", "formattable", 
                           "readr", "irr", "psycho", "afex", "emmeans")
    packages_to_install <- required_packages[!(required_packages %in% installed.packages()[,"Package"])]
    if(length(packages_to_install)) install.packages(packages_to_install)
    invisible(suppressPackageStartupMessages(lapply(required_packages, library, character.only = TRUE)))
# Define own function:
    coalesce_by_column <- function(df) {return(dplyr::coalesce(!!! as.list(df)))}
# Captioner:
    figure_numbering <- captioner()
    table_numbering <- captioner(prefix = "Table")
```

\newpage
# Experiment 2
## Development of a new set of standardised photographic stimuli

The Picture Superiority Effect (PSE) is highly robust and replicable. In recognition memory paradigms, the PSE has been shown to manifest as both increased recollection [] and familiarity [@rajaram1993; @rajaram1996; @dewhurst1994; @wagner1997; @yonelinas2002]. Studies utilising event-related potentials (ERPs) have also demonstrated how pictures enhance parietally-based ERP components (linked to recollection processes) compared to words [@ally2007; @curran2011]. The effect is also present in children, adolescents and healthy older adults [@whitehouse2006; need ref for healthy OAs], though perhaps more striking is the fact that patients with Alzheimer’s disease or those presenting early isolated memory impairments, known as amnestic mild cognitive impairment (aMCI), also show memorial benefits toward pictures [@ally2012]. This is supported by ERP studies demonstrating comparable enhancements to recollection-based ERP components between healthy older and aMCI groups when pictures, rather than words, are utilised [@ally2009]. There is debate within the literature attempting to characterise the nature of memory deficits in aMCI, whereby despite general agreement that recollection processes are impaired in such individuals, findings show great inconsistency with regard to familiarity [@algarabel2012; @belleville2011; @pitarque2016; @wolk2013; @wolk2011]. The PSE may have been largely overlooked as an area for further research in an effort to help settle this debate, despite recent reviews highlighting methodological differences across studies as the potential source of inconsistent findings [@koen2014; @migo2012; @schoemaker2014]. The level at which stimuli distinctiveness impacts successful recognition is currently unclear, and there is little consistency across studies with regard to what is considered a 'picture'.

Many experiments utilise illustrations for their picture stimuli [@vandermeulen2012; @westerberg2013; @wolk2011], with a standardised set of items published by @snodgrass1980 among the most-used illustrated picture stimuli within the domain of memory research [@weldon1987; @weldon1989; @wagner1997; @mcbride2002; @martins2006; @whitehouse2006; @hockley2008; @schmitter-edgecombe2009; @vandermeulen2012; @deason2015; @wammes2016; @bermudez-margaretto2018; @meade2019]. The set consists of 260 line drawings of common, everyday objects (in black ink), along with their written word counterpart (e.g. "shoe"). Items were selected on the basis of exemplifying a number of semantic categories, including animals, furniture, fruit, etc., and a range of normative data was collected for each item; indices of naming agreement, mental imagery agreement, visual complexity, and familiarity were all recorded for each drawing. The normative data for the @snodgrass1980 items has been continually revisited, with a number of studies gathering culturally-appropriate norms (e.g. in Spanish [@sanfeliu1996], Chinese [@yoon2004], and Russian [@tsaparina2011], and additional testing of the relationship between reaction time and naming agreement [@szekely2003]. There are multiple theories of object recognition; the recognition-by-components theory proposed by @biederman1987 identifies shape as the most crucial factor for successful recognition, in which case, the object outlines found in the set by @snodgrass1980 should be more than sufficient for experimental cognitive research. Other theories, however, posit that surface details such as colour and texture are just as crucial in forming object representations [@tanaka2001; @tarr1998]. The wide-ranging applicability of the @snodgrass1980 items throughout a number of cognitive disciplines has led to a more recent revision of the items by @rossion2004. This revision consists of the exact same objects, digitally re-drawn to include surface textures and shading. 

Another notable addition to the items by @rossion2004 is the availability of both greyscale and colour versions 

of each item - as opposed to the greyscale-only items found in the @snodgrass1980 set. 


(see `r figure_numbering("stim-examples--caption", display = "cite")` for example items contained in the @snodgrass1980 and @rossion2004 stimuli sets). The @rossion2004 revision now appears to be favoured over the original @snodgrass1980 set among many cognitive researchers [@stenberg2006; @wolk2008; @rollins2018, @ensor2019], almost certainly attributable to the increased detail and ability to choose whether colour is a necessary condition.

Despite their widespread use, line drawings have been criticised for their relative simplicity and lack of realism (@viggiano2004), with many researchers favouring the use of photographs as experimental stimuli [@embree2012; @pitarque2016; @troyer2012; @troyer2016; @wang2013a]. Photographs of faces are especially useful in research examining emotion and face recognition [@bowen2019; @cui2016; @herzmann2018; @barba1997], though a number of common-object photograph sets have also emerged as ecological alternatives to line-drawn items [@viggiano2004; @moreno-martinez2012; @adlington2009]. 

While the published sets of photographs are undoubtedly useful in a range of cognitive domains, they do not allow us to specifically examine stimuli format as a factor on its own, as the concepts depicted are unique to the set they derive from. In order to make such comparisons, and ensure any differences in performance (e.g. recognition memory ability) are indeed attributable to stimuli format, the objects depicted must be consistent across stimuli formats. The current study presents a new set of photographic stimuli that extend the set of words and drawings provided by @rossion2004, wherein each of the concepts depicted has been carefully matched across formats. These new stimuli will be utilised throughout a number of planned recognition experiments that aim to systematically compare measures of recognition against different ‘levels’ of stimuli. The curation of a new set of photographs - carefully matched to other formats - allows investigation into whether picture superiority magnitudes are mediated by the format pictures are presented in. The inconsistent use of different formats across studies has previously made it difficult to reconcile effects obtained in response to drawings with those obtained in response to photographs - an inherent problem when concepts are not matched across format. Normative data for the new set of photographs is also presented, allowing others who also wish to use our photograph stimuli to filter items by measures of naming agreement, mental imagery agreement, familiarity, visual complexity, and colour diagnosticity. 

```{r experiment-2-main, include=FALSE, warning = FALSE, message=FALSE, cache=TRUE}
####################################################################################################################
##                                                                                                                ##
##    EXPERIMENT 2:                                                                                               ##
##                                                                                                                ##
####################################################################################################################
##  List data files:
raw_data_files <- list.files(path = "./resources/raw_data/experiment_2/")
##  Create 'do not import' list: 
do_not_import <-   # Experimenter test files: 
  c("PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-08-31_17h24.58.448.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 05_2019-08-31_13h50.57.226.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 05_2019-08-31_09h35.46.685.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 04_2019-08-30_20h05.24.009.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 04_2019-08-30_17h30.37.570.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 04_2019-08-30_13h36.33.493.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 03_2019-08-29_14h09.45.628.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 03_2019-08-29_07h36.38.588.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 03_2019-08-28_20h37.19.421.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 03_2019-08-28_18h14.42.370.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 02_2019-08-28_14h09.34.697.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 02_2019-08-28_10h10.14.072.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 02_2019-08-27_15h57.08.388.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 01_2019-08-27_10h48.32.252.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 01_2019-08-26_12h12.26.753.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 05_2019-08-30_21h07.28.268.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 02_2019-08-28_08h22.14.369.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 02_2019-08-28_09h57.14.448.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_16h13.04.980.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 02_2019-11-22_09h27.37.994.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_16h09.53.591.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_16h03.22.229.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_15h43.07.191.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_15h40.03.881.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_15h35.42.080.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_14h57.35.053.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_14h53.19.091.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_14h48.27.823.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_14h33.54.515.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_14h03.09.719.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_13h22.22.702.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_12h52.34.761.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_12h47.34.512.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_12h43.06.244.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_12h40.35.211.csv",
    #   Empty / incomplete data (not even a single block fully completed):
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-10-01_09h15.14.507.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 05_2019-08-31_11h18.21.623.csv",   
    #   Experimental error. Three participants fully completed the study, but the image stim they were
    #   responding to was not recorded:
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-25_17h56.51.111.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-26_13h36.14.194.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-09-27_02h30.16.689.csv",
    #   Remove subsequent datasets of participants who took part more than once: 
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-08-31_22h19.30.823.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-08-31_20h34.25.233.csv",  
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-08-31_13h14.17.240.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-08-31_20h34.56.054.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-08-31_20h34.37.530.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-08-31_16h52.46.376.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 06_2019-08-31_20h34.56.887.csv",
    "PARTICIPANT_Subjective Judgments for Photographic Stimuli --- 05_2019-08-31_14h23.39.423.csv")
##  Remove 'do not import' items from the to-be-imported "csv_file_list".
raw_data_files <- raw_data_files[!(raw_data_files %in% do_not_import)] %>%       
  str_replace("PARTICIPANT", "./resources/raw_data/experiment_2/PARTICIPANT")    # Add folder location to start of each file name.

##  Create raw df from the above files, but only get the following columns:
raw_data <- map_dfr(raw_data_files,~read_csv(.x, col_types = cols_only("date"='c',"expName"='c',"Prolific_ID"='c',
                                                                       "Age"='c',"Gender"='c',"EnglishFirstLang"='c',
                                                                       "Ethnicity"='c',"EthnicityOther"='c',
                                                                       "UsingMac"='c',"RetinaScreen"='c',
                                                                       "DidYouHearBeep"='c',"Debrief_Comments"='c',
                                                                       "B1__DoYouUnderstand"='c',
                                                                       "B2__DoYouUnderstand"='c',
                                                                       "B3__DoYouUnderstand"='c',"Order"='c',
                                                                       "images1"='c',"images2"='c',"images3"='c',
                                                                       "images4"='c',"images5"='c',"images6"='c',
                                                                       "Naming_Response"='c',"Naming_RT"='c',
                                                                       "Familiarity"='c',"FamResp__Mouse.time"='c',
                                                                       "VisualComplexity"='c',"VisCom__Mouse.time"='c',
                                                                       "ColourDiagnosticity"='c',
                                                                       "ColDia__Mouse.time"='c',
                                                                       "MentalImageryAgreement"='c',
                                                                       "MenIma__Mouse.time"='c'))) %>%
  ##  Merge columns that contain the same type of data, but were originally split into different columns:
  unite(stim,  "images1", "images2", "images3", "images4", "images5", "images6",
        remove = TRUE, na.rm = TRUE) %>%
  ##  Change all column names to lower:
  rename_with(., tolower) %>%
  ##  Change all data to lower:
  mutate_all(tolower) %>%
  ##  Rename some columns:    
  rename(id = "prolific_id", exp_ver = "expname", fam_rt = "famresp__mouse.time", viscom_rt = "viscom__mouse.time",
         coldia_rt = "coldia__mouse.time", menima_rt = "menima__mouse.time") %>%
  ##  Reorder columns:    
  select(id, date, exp_ver, usingmac,	retinascreen, age, gender, englishfirstlang, ethnicity, 
         ethnicityother, didyouhearbeep, debrief_comments, b1__doyouunderstand, b2__doyouunderstand,
         b3__doyouunderstand, order, stim, naming_response, familiarity, visualcomplexity, 
         colourdiagnosticity, mentalimageryagreement, naming_rt, fam_rt, viscom_rt, coldia_rt) %>%
  ##  Set participant ID as the grouping variable, and arrange data by participant ID:
  group_by(id) %>%
  arrange(id) %>%
  ##  Tidy up responses for clarity:
  mutate(id = str_remove_all(id, "<br /><br /><span style=\"font-size:16px;\">")) %>%
  mutate(id = str_remove_all(id, "<br><br><span style=\"font-size:16px;\">")) %>%
  mutate(id = str_remove_all(id, "<(.*)")) %>%
  mutate(exp_ver = str_remove_all(exp_ver, "subjective judgments for photographic stimuli --- 0")) %>%
  mutate(usingmac = str_remove_all(usingmac, " (.*)")) %>%
  mutate(retinascreen = str_remove_all(retinascreen, " (.*)")) %>%
  mutate(retinascreen = str_replace(retinascreen, "not", "not_sure"))%>%
  mutate(ethnicity = str_remove_all(ethnicity, "<span style=\"font-size:16px;\"><strong>")) %>%
  mutate(ethnicity = str_remove_all(ethnicity, "<(.*)")) %>%
  mutate(ethnicityother = str_remove_all(ethnicityother, "<span style=\"font-size:16px;\"><strong>")) %>%
  mutate(ethnicityother = str_remove_all(ethnicityother, "<(.*)")) %>%
  mutate(stim = str_remove_all(stim, "images/stimuli/photos/")) %>%
  mutate(stim = str_remove_all(stim, ".png")) %>%
  mutate(gender = str_replace(gender, "^m$", "male")) %>%
  mutate(gender = str_replace(gender, "^cis male$", "male")) %>%
  mutate(gender = str_replace(gender, "^f$", "female")) %>%
  mutate(gender = str_replace(gender, "^femal$", "female")) %>%
  mutate(gender = str_replace(gender, "^nonbinary$", "non-binary")) %>%
  # Age info was duplicated in the Gender field by software if P did not respond: 
  mutate(gender = str_replace(gender, "^21$", "unspecified")) %>%
  mutate(gender = str_replace(gender, "^28$", "unspecified")) %>%
  mutate(gender = str_replace(gender, "^28$", "unspecified")) %>%
  mutate(gender = str_replace(gender, "^29$", "unspecified")) %>%
  mutate(gender = str_replace(gender, "^31$", "unspecified")) %>%
  mutate(gender = str_replace(gender, "^38$", "unspecified")) %>%
  # Some P were not automatically assigned an id. Populate with date instead (stays the same for all rows of a participant,
  # but is also precise enough to still be unique between participants):
  mutate(id = str_replace(id, "\\{\\{%prolific_pid%\\}\\}", date)) %>%
  # Two items had a number at the end of their name in some conditions, remove this: 
  mutate(stim = str_replace(stim, "skunk3-photo-grey1.png", "skunk3-photo-grey.png")) %>%
  mutate(stim = str_replace(stim, "skunk3-photo-colour1.png", "skunk3-photo-colour")) %>%
  # Add missing 'Order' info (an error in the experiment meant the 'Order' column was not created for the first 20 
  # participants (all of whom did 'A'): 
  mutate(order = ifelse(id == "5cd3a546fe890a00014dedd1" | id == "5ba2de5c962418000113e3c8" |
                          id == "5d5ef53ea55e6a0016d2cae4" | id == "5d2945a4bc573b00185c8eed" |
                          id == "56e6a66af6ed900006a5867c" | id == "5d39c8b48087000019f3e573" |
                          id == "5bddd72b18f1b9000174109e" | id == "5aca4e27a3ba7a0001b4d415" |
                          id == "5d3302e067a8ff0015dbff86" | id == "56ce42d9465e580006846f57" |
                          id == "5bd2ddf325b7190001553305" | id == "5c81872942ff490016c7dc3f" |
                          id == "5b9f7e3d00815d00010323f6" | id == "595e7974af78da0001a21c3a" |
                          id == "5c90bb590d21a20017ec455d" | id == "593533d4ed2e9a0001d37c0b" |
                          id == "5cd9dd09c8e37500018ab627" | id == "59d11f1519d3170001b1d679" |
                          id == "59d65ad8e2762800015eb51b" | id == "5c03b6681a20110001e996a5", 
                        "A", order)) %>%
  ##    Ps with messed up ColDia responses (remove these Ps entirely for now): 
  #filter(id != "56a3211edbe850000bfcedc6") %>%
  #filter(id != "55b567fbfdf99b4a11df33b9") %>%
  #filter(id != "59b59d59f69f340001867454") %>%
  #filter(id != "59e46feb16ecc200016fef61") %>%
  #filter(id != "5bebd4111296920001d55c5a") %>%
  #filter(id != "5c6205a724b1fc00019db2de") %>%
  #filter(id != "5d0651c57c37bf001a987dc2") %>%
  #filter(id != "5d29c671bc573b00165c9014") %>%      
  #filter(id != "5d51c0efbbb1aa00170db6c8") %>%
  #filter(id != "5d542c3a5af5900019bc80c4") %>%
##  Remove empty / unimportant rows:
mutate(stim = na_if(stim, "")) %>%
  drop_na(stim) %>%
  distinct(stim, .keep_all = TRUE) %>%
  arrange(id, stim) %>%
  ##  Add response counts (so we can exclude people that didn't finish a section):
  mutate(naming_count = sum(!is.na(naming_response))) %>%
  mutate(familiarity_count = sum(!is.na(familiarity))) %>%
  mutate(viscom_count = sum(!is.na(visualcomplexity))) %>%
  mutate(coldia_count = sum(!is.na(colourdiagnosticity))) %>%
  mutate(menima_count = sum(!is.na(mentalimageryagreement)))

####################################################################################################################
##    Participant summary:                                                                                        ##
####################################################################################################################  
exp_2_participants <- raw_data %>%
  select(id, age, gender, englishfirstlang, ethnicity, ethnicityother) %>%
  summarise_all(coalesce_by_column)
```

\newpage
## Method
```{r exp2--age-gender--tablecaption, echo=FALSE, results = FALSE}
    table_numbering(name = "exp2--age-gender--tablecaption", 
                     caption = "Gender and age (*SD*) of the current sample.")
```
### Participants
A total of `r nrow(exp_2_participants)` subjects completed the online experiment (see `r table_numbering("exp2--age-gender--tablecaption", display = "cite")` for a breakdown of the gender and age of the sample). This sample size provided 20 data points for each of the five response types, while also ensuring the experiment did not last too long for participants (approx 25-mins). Subjects were recruited from both voluntary participation websites such as \href{https://www.prolific.co/}{Prolific Academic} (where they received payment at the rate of £5/hr), and via the in-school \href{https://keelepsychology.sona-systems.com/}{research participation system} (where they received course participation credits).

```{r exp2-age-gend-table-data, include=FALSE, cache=TRUE}
exp2_age_gender <- exp_2_participants %>%
  select(age, gender) %>%
  mutate(age = as.double(age))

exp2_age_gender_table <- tribble(
  ~"Gender", ~N, ~Age, ~"",
  "Female",
  exp2_age_gender %>% filter(gender == "female") %>% nrow(),
  exp2_age_gender %>% filter(gender == "female") %>% summarise(mean(age)) %>% pull() %>% round (2),
  str_c("(",exp2_age_gender %>% filter(gender == "female") %>% summarise(sd(age)) %>% pull()
        %>% round (2) %>% as.character(), ")"),
  "Male",
  exp2_age_gender %>% filter(gender == "male") %>% nrow(),
  exp2_age_gender %>% filter(gender == "male") %>% summarise(mean(age)) %>% pull() %>% round (2),
  str_c("(",exp2_age_gender %>% filter(gender == "male") %>% summarise(sd(age)) %>% pull()
        %>% round (2) %>% as.character(), ")"),
  "Non-binary",
  exp2_age_gender %>% filter(gender == "non-binary") %>% nrow(),
  exp2_age_gender %>% filter(gender == "non-binary") %>% summarise(mean(age)) %>% pull(),
  "(-)",
  "Unspecified",
  exp2_age_gender %>% filter(gender == "unspecified") %>% nrow(),
  exp2_age_gender %>% filter(gender == "unspecified") %>% summarise(mean(age)) %>% pull(),
  str_c("(",exp2_age_gender %>% filter(gender == "unspecified") %>% summarise(sd(age)) %>% pull()
        %>% round (2) %>% as.character(), ")"),
  "Total",
  exp2_age_gender %>% nrow(),
  exp2_age_gender %>% summarise(mean(age)) %>% pull() %>% round (2),
  str_c("(",exp2_age_gender %>% summarise(sd(age)) %>% pull() %>% round (2) %>% as.character(),")"))

exp2_n_eng_lang <- nrow(exp_2_participants %>% filter(englishfirstlang == "yes"))
exp2_n_eng_lang <- round((exp2_n_eng_lang / nrow(exp_2_participants)) * 100, 2)
```

`r table_numbering("exp2--age-gender--tablecaption")`
```{r exp2-age-gend-table, echo=FALSE, cache=TRUE}
exp2_age_gender_table %>%
  kable("latex", booktabs = T) %>%
  kable_styling(latex_options = "hold_position") %>%
  column_spec(2, italic = TRUE) %>%
  column_spec(4, italic = TRUE) %>%
  row_spec(5, bold = TRUE)
```

To meet our YA requirements, all participants were required to be aged between 18-59 years (actual obtained range: `r min(exp_2_participants$age, na.rm = TRUE)`-`r max(exp_2_participants$age, na.rm = TRUE)` years). As our experiment involved typing the English labels for a range of image stimuli, subjects were also asked whether English was their first language; all but one participant indicated that English was indeed their first language (`r exp2_n_eng_lang`%). 

### Materials
A pool of 136 line drawings [@rossion2004] - depicting common, everyday objects - were brought forward from the previous experiment. These items (along with their written-word labels) would form two of the unique stimuli formats that would be used in future recognition experiments (words and drawings). In this study, the drawings from @rossion2004 were simply used as a reference in the photograph matching process. Corresponding photographs were obtained online with the aim of depicting the everyday objects in a similar manner to the drawings. The inherent subjectivity involved in this process may have led to images that were not a reliable ‘match’ to the concepts they were selected to depict (for example, the photograph chosen to depict the concept “bottle” may inadvertently provoke the majority of participants to give the label "wine", thus indicating that this particular photograph fails to accurately depict the intended concept). To address this issue, and ensure all photographs more objectively depict the same concepts as the line drawings, three different photograph variations were found for each everyday object, with the aim of taking the best ‘match’ forward. An emphasis was placed on variety across these variations, with the aim of obtaining at least one photograph that very closely resembled the line-drawn depiction, and another offering a more modern depiction. Some items were substituted due to unique restrictions that meant they could not easily be translated into photographic format (for example, the shapes "arrow" and "star" can not be represented similarly as photographs). Photo stimuli were obtained by searching open-source, copyright-free image websites (e.g. \href{https://unsplash.com/}{Unsplash}; \href{https://www.pexels.com/}{Pexels}) for photographs that depicted the same everyday objects as the line drawings (see Appendix B for the full list of image references). 

```{r exp2--stim-examples--caption, echo=FALSE, results = FALSE}
    figure_numbering(name = "exp2--stim-examples--caption",
                     caption = "Example pictures from @snodgrass1980, @rossion2004, and photographs from the current study selected to match.")
```
&nbsp;
&nbsp;
```{r echo=FALSE, out.width = '100%', cache=TRUE}
    knitr::include_graphics("./resources/images/stim-examples.png")
```
&nbsp;
&nbsp;
`r figure_numbering("exp2--stim-examples--caption")`
&nbsp;
&nbsp;

The matching process produced a total of 408 unique photographs. All were imported into Adobe Photoshop (20.0.04 Release), where the background was removed to isolate the object of interest from other potentially distracting visual details. This was completed manually using the magnetic lasso and polygonal lasso tools (edges were either feathered by 1px or left un-feathered). The orientation of isolated objects was adjusted to ensure they matched as closely as possible with their line-drawn counterpart (e.g. all photograph variations of the item 'boot' were adjusted so the toe was facing left and the heel facing right, as in the line drawing); this was often achieved by flipping or mirroring the object to 'correct' the direction.

```{r define-photo-manipulation-caption, echo=FALSE, results = FALSE}
    figure_numbering(name = "photo-manipulation-examples",
                     caption = "Examples of background and text removal in photograph items.")
```

Despite isolating objects from their background, a small number of photographs still contained irrelevant and potentially distracting details. For example, in one photograph variation of the item 'piano', there was a sign on the object that may have impacted how the item was named or rated. Such details were removed as best as possible using the clone stamp and content-aware fill tools. Any obvious text (e.g. brand names) and numbers were also removed from photographs using the same method (see `r figure_numbering("photo-manipulation-examples", display = "cite")`). The primary aim of the current study was to obtain photographs that could be clearly distinguished as a unique stimuli format among words and line drawings; it is conceivable that combining these formats (i.e. inadvertently including photographs that also contain written words) might affect recognition performance in ways that are not directly comparable to items defined only by a single category. Any text in our photographs was therefore removed, apart from a couple of exceptions whereby such details happened to be integral to the depiction of the object (e.g. the numbers found on a ruler or clock).

All photographs were exported from Photoshop in “.png” format in both their original colour and in greyscale (by setting saturation levels to 0). Final edits were completed in Adobe Lightroom (Classic, 8.2 Release): exposure (brightness) adjustments were made on images that appeared too light or too dark; highlights were decreased if some areas were too bright compared to the rest of the photograph; shadows were raised if some areas were too dark compared to the rest of the photograph; noise reduction was applied to some items after isolating the subject had inadvertently made unwanted noise/grain more visible. The changes made to each image were systematically applied to both the colour and greyscale versions (e.g. if one variation of "shoe" had an exposure increase of .010 for the colour version, the greyscale version also received an exposure increase of .010). Some colour-specific adjustments were made to the colour photographs only, however; common photo artefacts such as chromatic aberration (purple fringing) were corrected, along with white balance normalisation. Finally, all photographs were placed on a 600x600 pixel white background, and made to fill this frame as much as possible (i.e. some items were restrained by height, whilst others were restrained by width).

&nbsp;
&nbsp;
```{r photo-manipulation-examples-image, echo=FALSE, out.width = '100%', cache=TRUE}
    knitr::include_graphics("./resources/images/photo-manipulation-examples.png")
#\begin{figure}[H]
#\centering
#\includegraphics[width=\textwidth]{photo-manipulation-exmaples}
#\caption{`r figure_numbering("photo-manipulation-examples")`}\label{photo-manipulation-exmaples}
#\end{figure}
```
&nbsp;
&nbsp;
`r figure_numbering("photo-manipulation-examples")`
&nbsp;
&nbsp;

### Design
This was a descriptive study; a mix of qualitative and quantitative data were gathered in the absence of hypothesis testing. Across three blocks, all participants provided five types of response toward photograph stimuli: i) Naming; ii) Familiarity; iii) Visual Complexity, iv) Colour Diagnosticity; and v) Mental Imagery Agreement. Excluding the Naming task (consisting of a typed single-word answer), all responses were provided on a 5-point ordinal scale. Within participants, the maximum number of response type provided for any one item was two; Naming and Familiarity responses were paired in one block, Visual Complexity and Colour Diagnosticity responses were paired in another, and Mental Imagery Agreement responses were always presented in a separate block. The order of these three blocks was counterbalanced across participants. Toward each individual photograph, participants made only one or two types of response before moving on to the next item, and the same items were not repeated to participants. For each photograph, the five types of required data were obtained by counterbalancing between participants (e.g. for the first variation of the "cat" photograph, the Naming and Familiarity data was obtained from one participant, the Visual Complexity and Colour Diagnosticity data was obtained from another, and the Mental Imagery Agreement data was obtained from another). 

### Procedure
Data collection was conducted via two online platforms; i) \href{https://www.qualtrics.com/uk/}{Qualtrics} - a survey platform that allowed for straightforward collection of consent, demographics, and computer compatibility data, and ii) \href{https://pavlovia.org/}{Pavlovia} - an open-source experiment hosting platform for studies programmed in Javascript [@peirce2019].

In the Naming and Familiarity block, participants were first asked "What is the name of the item depicted?". Subjects were instructed to name each photograph as briefly and unambiguously as possible, with one name only, and respond by typing their answer into the response box. If they did not know the name of an item, or had a tip-of-the-tongue experience, participants were instructed to type "no" for their answer (the term "don't know" was avoided so as not to encourage subjects to deviate from single-word responses, as instructed).Following the naming judgement, with the same photograph still present on-screen, participants were next asked "How familiar is the item depicted?". Subjects were instructed to judge each photo according to how usual or unusual the item was in their realm of experience; specifically, familiarity was defined as "the degree to which you come in contact with, or think about, the concept", and encouraged participants to rate the concept itself rather than the particular way it was currently shown. Participants selected one value from the 5-point scale, ranging from very unfamiliar (1) to very familiar (5), and were encouraged to use the full range of the scale throughout the set of photographs. 

In the Visual Complexity and Colour Diagnosticity block, participants were first instructed to respond to the question "How visually complex is this picture?" using a 5-point scale that ranged from "very simple" (1) to "very complex" (5). Complexity was defined to subjects as "the amount of detail in the picture"; in contrast to the familiarity ratings, participants were encouraged here to rate the complexity of the picture itself, rather than the real-life item. If the photograph shown was greyscale, subjects would simply move on to the next item. If the item shown was in colour, however, participants were also required to make a colour diagnosticity judgement. This concept was defined as "how typical / normal the colour of the item is", instructing subjects to rate on a 5-point scale ranging from "Not at all diagnostic (i.e. this item could be in any other colour equally well)" (1) to "Highly diagnostic (i.e. this item appears only in this colour in real life). Participants were instructed to utilise the full range of options on the scale when making visual complexity and colour diagnosticity judgements. After making these ratings, a fixation cross was presented during a 1s interstimulus interval. 
 
Due to the slight change in procedure and increased task complexity, Mental Imagery Agreement ratings were always acquired in an individual block (i.e. not alongside any other response types). First, participants were presented with a written label for 3s (e.g. "cat") and told to focus their attention on the word. Once the written word disappeared, a beep tone was played alongside the instruction "close your eyes and imagine this item" (subjects were encouraged to close their eyes and begin imagining the item as soon as they heard the tone, but the written instruction were included as a further prompt). After 3s a second beep tone sounded to alert subjects to open their eyes, where they were presented with a photograph of the item they had been instructed to imagine. On a 5-point scale, participants were asked to "rate the agreement between your mental image and the picture", from "low agreement" (1) to "high agreement" (5). The degree of agreement was defined as "how similar your mental image of the item is to the picture shown". A fixation cross was displayed for 1s before the next word item was shown.

All responses were self-paced; the timing was only controlled during the study/imagine section of the Mental Imagery Agreement block.

```{r define-men-ima-procedure-caption, echo=FALSE, results = FALSE}
    figure_numbering(name = "men_ima_procedure",
                     caption = "Data collection procedure for Mental Imagery Agreement responses.")
```

&nbsp;
&nbsp;
```{r men-ima-procedure-image, echo=FALSE, out.width = '100%', cache=TRUE}
    knitr::include_graphics("./resources/images/procedure.png")
```
&nbsp;
&nbsp;
`r figure_numbering("men_ima_procedure")`
&nbsp;
&nbsp;

### Data processing
The naming responses for each photograph item were manually assessed for spelling and typing errors. Automatic spell checking software was avoided in an effort to avoid inadvertently introducing unique names that were not actually given by participants. The vast majority of errors were unambiguous and easy to correct (e.g. "anker" = "anchor", "peguin" = "penguin", "ssnowman" = "snowman"), or consisted of transforming plural words to singular (or vice versa, depending on the form of the intended label - e.g. "sock" to "socks"). Some responses were a little more ambiguous, and necessitated comparison to the photographs they were in response to for additional clarity (e.g. a photograph depicting a plug that would fit into North American electrical sockets was labelled as "usplug" - given the nature of our UK-based sample, it's likely the subject was responding: "U.S. (i.e. United States) plug". 

There were instances where subjects provided a sensible and correctly spelled English word, but that were clearly typos when examined against the photograph they were in response to (e.g. "dock" for a photograph depicting a duck, "frock" for a frog, and "beer" for a "bear", etc). The most ambiguous spelling error to correct was "bittle", which was provided by more than one participant and to more than one item; separate inspections of the photographs participants were responding to made this easy to correct though, with one participant clearly meaning to respond "bottle", whilst the other meant to respond "beetle". Though participants were instructed to only give a single label for each item, some multiple word responses were found (without spaces) during the spell checking process. On such occasions, a judgement was made regarding whether multiple words were retained, or whether the response could be shortened into a single word. A general rule was applied whereby if the other words provided additional information, they were retained (e.g."maledear" - presumably "male deer" - was kept as a two-word answer). Multiple word responses were generally shortened into a single word when the intended label for the item was clearly present, and no information was lost in the process (e.g. "haircomb" was shortened to the intended answer "comb"). It is noted that there was some inherent subjectivity in this process, though as such items were not common among straightforward responses, their overall effects are estimated to be negligible.

Finally, there were some responses that were changed to "no" as they were clearly intended to signify that the responder did not know the name of the item shown; the experiment instructed participants to type "no" in these instances, though the labels "none" and "idk" (common abbreviation for "I don't know) were provided instead. There was also a single response that was manually changed to "no", as the provided label was a single letter and thus entirely unclear what the intended answer should be (see Appendix A for full list of manipulations to naming responses). This process yielded data that could be used to determine which photograph variation best matched the intended concepts (e.g. 100% of participants labelled the object “bottle”, indicating a perfect match), and which did not (e.g. only 50% of participants labelled the item “bottle”, whilst the other 50% gave the label “wine”, indicating a poor match). Photographs showing poor agreement across participant-generated labels, or those where the majority of labels differed from the intended concept, could be replaced with the variation demonstrating the most accurate depiction. 

A number of variables were calculated prior to analysis. The output variables for the naming responses included the most frequent name, percentage agreement (proportion of subjects reporting this most frequent name), and the statistic *H*. Like percentage agreement, the *H* statistic (ref) also reflects the naming agreement between participants, however, it also takes into account the number of unique names provided for any given item. A *H* value of 0 indicates perfect naming agreement (all subjects responded alike), whilst a *H* value of 1 shows that two unique names were given, but with identical proportions (i.e. 10 subjects responded with Name A, and 10 subjects responded with Name B). As the *H* value increases, 

Mean ratings were calculated for familiarity, visual complexity, colour diagnosticity, and mental imagery agreement. 


### Naming
```{r naming-data, include=FALSE, cache=TRUE}
####################################################################################################################
##                                                                                                                ##
##    NAMING:                                                                                                     ##
##                                                                                                                ##
####################################################################################################################
    naming <- raw_data %>%
        filter(naming_count == 44 | naming_count == 48) %>%
        ungroup() %>%
        select(stim, naming_response) %>%
        drop_na(naming_response) %>%
        group_by(stim) %>%                      
        arrange (stim, naming_response) %>%
        mutate(correct_name = str_remove_all(stim, "[1-3](.*)")) %>%
# Spelling corrections:   
        mutate(naming_response = str_replace(naming_response, "^idk$", "no")) %>%          # Change "idk" to "no".
        mutate(naming_response = str_replace(naming_response, "^none$", "no")) %>%         # Change "none" to "no".
        mutate(naming_response = str_replace(naming_response, "^a$", "no")) %>%            # Incorrect spelling / typo.
        mutate(naming_response = str_replace(naming_response, "^anker$", "anchor")) %>%         
        mutate(naming_response = str_replace(naming_response, "^ancher$", "anchor")) %>%
        mutate(naming_response = str_replace(naming_response, "^anchore$", "anchor")) %>%
        mutate(naming_response = str_replace(naming_response, "^ancor$", "anchor")) %>%
        mutate(naming_response = str_replace(naming_response, "^ashtry$", "ashtray")) %>%
        mutate(naming_response = str_replace(naming_response, "^;ashtray$", "ashtray")) %>%
        mutate(naming_response = str_replace(naming_response, "^aparagus$", "asparagus")) %>%
        mutate(naming_response = str_replace(naming_response, "^ballon$", "balloon")) %>%
        mutate(naming_response = str_replace(naming_response, "^baloon$", "balloon")) %>%
        mutate(naming_response = str_replace(naming_response, "^ballone$", "balloon")) %>%
        mutate(naming_response = str_replace(naming_response, "^ballun$", "balloon")) %>%
        mutate(naming_response = str_replace(naming_response, "^balloone$", "balloon")) %>%
        mutate(naming_response = str_replace(naming_response, "^bannan$", "banana")) %>%
        mutate(naming_response = str_replace(naming_response, "^bamnna$", "banana")) %>%
        mutate(naming_response = str_replace(naming_response, "^bananna$", "banana")) %>%
        mutate(naming_response = str_replace(naming_response, "^bannana$", "banana")) %>%
        mutate(naming_response = str_replace(naming_response, "^bananaa$", "banana")) %>%
        mutate(naming_response = str_replace(naming_response, "^barrell$", "barrel")) %>%
        mutate(naming_response = str_replace(naming_response, "^barrle$", "barrel")) %>%
        mutate(naming_response = str_replace(naming_response, "^barel$", "barrel")) %>%
        mutate(naming_response = str_replace(naming_response, "^barrow$", "barrel")) %>%
        mutate(naming_response = str_replace(naming_response, "^busket$", "basket")) %>%
        mutate(naming_response = str_replace(naming_response, "^bellpepp34$", "bellpepper")) %>%
        mutate(naming_response = str_replace(naming_response, "^beatle$", "beetle")) %>%
        mutate(naming_response = str_replace(naming_response, "^bettle$", "beetle")) %>%
        mutate(naming_response = str_replace(naming_response, "^blueberrys$", "blueberries")) %>%
        mutate(naming_response = str_replace(naming_response, "^bycycle$", "bicycle")) %>%
        mutate(naming_response = str_replace(naming_response, "^bicucle$", "bicycle")) %>%
        mutate(naming_response = str_replace(naming_response, "^bicyle$", "bicycle")) %>%
        mutate(naming_response = str_replace(naming_response, "^bootle$", "bottle")) %>%
        mutate(naming_response = str_replace(naming_response, "^bolw$", "bowl")) %>%
        mutate(naming_response = str_replace(naming_response, "^broon$", "broom")) %>%
        mutate(naming_response = str_replace(naming_response, "^broon$", "broom")) %>%
        mutate(naming_response = str_replace(naming_response, "^brum$", "broom")) %>%
        mutate(naming_response = str_replace(naming_response, "^camal$", "camel")) %>%
        mutate(naming_response = str_replace(naming_response, "^canddle$", "candle")) %>%
        mutate(naming_response = str_replace(naming_response, "^canle$", "candle")) %>%
        mutate(naming_response = str_replace(naming_response, "^canon$", "cannon")) %>%
        mutate(naming_response = str_replace(naming_response, "^carrott$", "carrot")) %>%
        mutate(naming_response = str_replace(naming_response, "^carott$", "carrot")) %>%
        mutate(naming_response = str_replace(naming_response, "^cerlery$", "celery")) %>%
        mutate(naming_response = str_replace(naming_response, "^celary$", "celery")) %>%
        mutate(naming_response = str_replace(naming_response, "^cellary$", "celery")) %>%
        mutate(naming_response = str_replace(naming_response, "^celeary$", "celery")) %>%
        mutate(naming_response = str_replace(naming_response, "^chain2$", "chain")) %>%
        mutate(naming_response = str_replace(naming_response, "^cockrel$", "cockerel")) %>%
        mutate(naming_response = str_replace(naming_response, "^cockaroach$", "cockroach")) %>%
        mutate(naming_response = str_replace(naming_response, "^cochroach$", "cockroach")) %>%
        mutate(naming_response = str_replace(naming_response, "^chissel$", "chisel")) %>%
        mutate(naming_response = str_replace(naming_response, "^chizel$", "chisel")) %>%
        mutate(naming_response = str_replace(naming_response, "^chestofdraws$", "chestofdrawers")) %>%
        mutate(naming_response = str_replace(naming_response, "^chestofdrawerserss$", "chestofdrawers")) %>%
        mutate(naming_response = str_replace(naming_response, "^chisle$", "chisel")) %>%
        mutate(naming_response = str_replace(naming_response, "^claranet$", "clarinet")) %>%
        mutate(naming_response = str_replace(naming_response, "^combe$", "comb")) %>%
        mutate(naming_response = str_replace(naming_response, "^dear$", "deer")) %>%
        mutate(naming_response = str_replace(naming_response, "^deere$", "deer")) %>%
        mutate(naming_response = str_replace(naming_response, "^draws$", "drawers")) %>%
        mutate(naming_response = str_replace(naming_response, "^doormouse$", "dormouse")) %>%
        mutate(naming_response = str_replace(naming_response, "^eagal$", "eagle")) %>%
        mutate(naming_response = str_replace(naming_response, "^eeagle$", "eagle")) %>%
        mutate(naming_response = str_replace(naming_response, "^eclipses$", "eclipse")) %>%
        mutate(naming_response = str_replace(naming_response, "^eclipes$", "eclipse")) %>%
        mutate(naming_response = str_replace(naming_response, "^eclipsse$", "eclipse")) %>%
        mutate(naming_response = str_replace(naming_response, "^falg$", "flag")) %>%
        mutate(naming_response = str_replace(naming_response, "^footstall$", "footstool")) %>%
        mutate(naming_response = str_replace(naming_response, "^fott$", "foot")) %>%
        mutate(naming_response = str_replace(naming_response, "^frog/$", "frog")) %>%
        mutate(naming_response = str_replace(naming_response, "^girafffe$", "giraffe")) %>%
        mutate(naming_response = str_replace(naming_response, "^giraffee$", "giraffe")) %>%
        mutate(naming_response = str_replace(naming_response, "^girrafe$", "giraffe")) %>%
        mutate(naming_response = str_replace(naming_response, "^girafe$", "giraffe")) %>%
        mutate(naming_response = str_replace(naming_response, "^giraff$", "giraffe")) %>%
        mutate(naming_response = str_replace(naming_response, "^giaffee$", "giraffe")) %>%
        mutate(naming_response = str_replace(naming_response, "^girraffe$", "giraffe")) %>%
        mutate(naming_response = str_replace(naming_response, "^giaraffe$", "giraffe")) %>%
        mutate(naming_response = str_replace(naming_response, "^glases$", "glasses")) %>%
        mutate(naming_response = str_replace(naming_response, "^gutair$", "guitar")) %>%
        mutate(naming_response = str_replace(naming_response, "^gitaur$", "guitar")) %>%
        mutate(naming_response = str_replace(naming_response, "^gitter$", "guitar")) %>%
        mutate(naming_response = str_replace(naming_response, "^hemmar$", "hammer")) %>%
        mutate(naming_response = str_replace(naming_response, "^hand5$", "hand")) %>%
        mutate(naming_response = str_replace(naming_response, "^hamp$", "harp")) %>%
        mutate(naming_response = str_replace(naming_response, "^kacket$", "jacket")) %>%
        mutate(naming_response = str_replace(naming_response, "^kangroo$", "kangaroo")) %>%
        mutate(naming_response = str_replace(naming_response, "^lader$", "ladder")) %>%
        mutate(naming_response = str_replace(naming_response, "^latter$", "ladder")) %>%
        mutate(naming_response = str_replace(naming_response, "^leafe$", "leaf")) %>%
        mutate(naming_response = str_replace(naming_response, "^lettace$", "lettuce")) %>%
        mutate(naming_response = str_replace(naming_response, "^leamon$", "lemon")) %>%
        mutate(naming_response = str_replace(naming_response, "^leema$", "lemur")) %>%
        mutate(naming_response = str_replace(naming_response, "^olobster$", "lobster")) %>%
        mutate(naming_response = str_replace(naming_response, "^maledear$", "maledeer")) %>%
        mutate(naming_response = str_replace(naming_response, "^mortle$", "mortar")) %>%        
        mutate(naming_response = str_replace(naming_response, "^monkeybut$", "monkeynut")) %>%  
        mutate(naming_response = str_replace(naming_response, "^mousse$", "moose")) %>%
        mutate(naming_response = str_replace(naming_response, "^neddle$", "needle")) %>%
        mutate(naming_response = str_replace(naming_response, "^nectarinee$", "nectarine")) %>%
        mutate(naming_response = str_replace(naming_response, "^ostrage$", "ostrich")) %>%
        mutate(naming_response = str_replace(naming_response, "^osterich$", "ostrich")) %>%
        mutate(naming_response = str_replace(naming_response, "^ostrige$", "ostrich")) %>%
        mutate(naming_response = str_replace(naming_response, "^ostrisge$", "ostrich")) %>%
        mutate(naming_response = str_replace(naming_response, "^ostritch$", "ostrich")) %>%
        mutate(naming_response = str_replace(naming_response, "^ostridge$", "ostrich")) %>%
        mutate(naming_response = str_replace(naming_response, "^apricorte$", "apricot")) %>%
        mutate(naming_response = str_replace(naming_response, "^nectarin$", "nectarine")) %>%
        mutate(naming_response = str_replace(naming_response, "^nectrine$", "nectarine")) %>%
        mutate(naming_response = str_replace(naming_response, "^pecock$", "peacock")) %>%
        mutate(naming_response = str_replace(naming_response, "^peacck$", "peacock")) %>%
        mutate(naming_response = str_replace(naming_response, "^pair$", "pear")) %>%
        mutate(naming_response = str_replace(naming_response, "^oencil$", "pencil")) %>%
        mutate(naming_response = str_replace(naming_response, "^pengiuin$", "penguin")) %>%
        mutate(naming_response = str_replace(naming_response, "^pengiun$", "penguin")) %>%
        mutate(naming_response = str_replace(naming_response, "^penguine$", "penguin")) %>%
        mutate(naming_response = str_replace(naming_response, "^penquin$", "penguin")) %>%
        mutate(naming_response = str_replace(naming_response, "^peguin$", "penguin")) %>%
        mutate(naming_response = str_replace(naming_response, "^peper$", "pepper")) %>%
        mutate(naming_response = str_replace(naming_response, "^pestleandmorter$", "pestleandmortar")) %>%
        mutate(naming_response = str_replace(naming_response, "^tabaccopipe$", "tobaccopipe")) %>%
        mutate(naming_response = str_replace(naming_response, "^piccalo$", "piccolo")) %>%
        mutate(naming_response = str_replace(naming_response, "^pliars$", "pliers")) %>%
        mutate(naming_response = str_replace(naming_response, "^plier$", "pliers")) %>%
        mutate(naming_response = str_replace(naming_response, "^plyers$", "pliers")) %>%
        mutate(naming_response = str_replace(naming_response, "^pilers$", "pliers")) %>%
        mutate(naming_response = str_replace(naming_response, "^pliyers$", "pliers")) %>%
        mutate(naming_response = str_replace(naming_response, "^vicescripts$", "vicegrips")) %>%
        mutate(naming_response = str_replace(naming_response, "^usplug$", "plug")) %>%  # U.S. (i.e. United States) plug? 
        mutate(naming_response = str_replace(naming_response, "^potatoe$", "potato")) %>%
        mutate(naming_response = str_replace(naming_response, "^pottato$", "potato")) %>%
        mutate(naming_response = str_replace(naming_response, "^pumkin$", "pumpkin")) %>%
        mutate(naming_response = str_replace(naming_response, "^pumpkim$", "pumpkin")) %>%
        mutate(naming_response = str_replace(naming_response, "^punpkin$", "pumpkin")) %>%
        mutate(naming_response = str_replace(naming_response, "^rabit$", "rabbit")) %>%
        mutate(naming_response = str_replace(naming_response, "^racoon$", "raccoon")) %>%
        mutate(naming_response = str_replace(naming_response, "^mercat$", "meerkat")) %>%
        mutate(naming_response = str_replace(naming_response, "^meercat$", "meerkat")) %>%
        mutate(naming_response = str_replace(naming_response, "^acoop$", "scoop")) %>%
        mutate(naming_response = str_replace(naming_response, "^eele$", "seal")) %>%
        mutate(naming_response = str_replace(naming_response, "^seel$", "seal")) %>%
        mutate(naming_response = str_replace(naming_response, "^snakw$", "snake")) %>%
        mutate(naming_response = str_replace(naming_response, "^ssnowman$", "snowman")) %>%
        mutate(naming_response = str_replace(naming_response, "^showel$", "shovel")) %>%
        mutate(naming_response = str_replace(naming_response, "^soak$", "socks")) %>%
        mutate(naming_response = str_replace(naming_response, "^spon$", "spoon")) %>%
        mutate(naming_response = str_replace(naming_response, "^steplader$", "stepladder")) %>%
        mutate(naming_response = str_replace(naming_response, "^sterss$", "step")) %>%
        mutate(naming_response = str_replace(naming_response, "^sweetcirn$", "sweetcorn")) %>%
        mutate(naming_response = str_replace(naming_response, "^rubarb$", "rhubarb")) %>%
        mutate(naming_response = str_replace(naming_response, "^thinbell$", "thimble")) %>%
        mutate(naming_response = str_replace(naming_response, "^thmble$", "thimble")) %>%
        mutate(naming_response = str_replace(naming_response, "^timble$", "thimble")) %>%
        mutate(naming_response = str_replace(naming_response, "^timbil$", "thimble")) %>%
        mutate(naming_response = str_replace(naming_response, "^thunb$", "thumb")) %>%
        mutate(naming_response = str_replace(naming_response, "^toitouse$", "tortoise")) %>%
        mutate(naming_response = str_replace(naming_response, "^tomatoe$", "tomato")) %>%
        mutate(naming_response = str_replace(naming_response, "^tomoato$", "tomato")) %>%
        mutate(naming_response = str_replace(naming_response, "^tortiste$", "tortoise")) %>%
        mutate(naming_response = str_replace(naming_response, "^tortise$", "tortoise")) %>%
        mutate(naming_response = str_replace(naming_response, "^tortus$", "tortoise")) %>%
        mutate(naming_response = str_replace(naming_response, "^volion$", "violin")) %>%
        mutate(naming_response = str_replace(naming_response, "^vioin$", "violin")) %>%
        mutate(naming_response = str_replace(naming_response, "^violen$", "violin")) %>%
        mutate(naming_response = str_replace(naming_response, "^valture$", "vulture")) %>%
        mutate(naming_response = str_replace(naming_response, "^waistcoast$", "waistcoat")) %>%
        mutate(naming_response = str_replace(naming_response, "^wastecoat$", "waistcoat")) %>%
        mutate(naming_response = str_replace(naming_response, "^wale$", "well")) %>%
        mutate(naming_response = str_replace(naming_response, "^whistel$", "whistle")) %>%
        mutate(naming_response = str_replace(naming_response, "^whsitle$", "whistle")) %>%
        mutate(naming_response = str_replace(naming_response, "^whisell$", "whistle")) %>%
        mutate(naming_response = str_replace(naming_response, "^whitle$", "whistle")) %>%
        mutate(naming_response = str_replace(naming_response, "^windown$", "window")) %>%
        mutate(naming_response = str_replace(naming_response, "^peneut$", "peanut")) %>%
# Sensible word responses, but based on the picture P were responding to, were probably typos: 
        mutate(naming_response = str_replace(naming_response, "^beer$", "bear")) %>%
        # Item "swan". Probably meant "duck":
        mutate(naming_response = str_replace(naming_response, "^dock$", "duck")) %>%      
        mutate(naming_response = str_replace(naming_response,  "^frock$", "frog")) %>%
        mutate(naming_response = str_replace(naming_response,  "^glass$", "glasses")) %>%
        mutate(naming_response = str_replace(naming_response,  "^glassesbottle$", "bottle")) %>%
        mutate(naming_response = str_replace(naming_response,  "^hose$", "house")) %>%
        mutate(naming_response = str_replace(naming_response,  "^noise$", "nose")) %>%
        mutate(naming_response = str_replace(naming_response,  "^paper$", "pepper")) %>%
        mutate(naming_response = str_replace(naming_response,  "^harper$", "hamper")) %>%
        # Item "raccoon". Probably meant "muskrat":
        mutate(naming_response = str_replace(naming_response,  "^muscat$", "muskrat")) %>%
        # Spelling mistake 'bittle' appeared for both beetle and bottle. Before correcting the spelling,
        # we must check which item P was responding to:
        mutate(naming_response = ifelse(naming_response == "bittle" & correct_name == "bottle", "bottle",
                                        ifelse(naming_response == "bittle" & correct_name == "beetle", "beetle",
                                               naming_response))) %>%   
# Plural to singular: 
        mutate(naming_response = str_replace(naming_response,  "^carrots$", "carrot")) %>%   
        mutate(naming_response = str_replace(naming_response,  "^clouds$", "cloud")) %>%
        mutate(naming_response = str_replace(naming_response,  "^draw$", "drawers")) %>%
        mutate(naming_response = str_replace(naming_response,  "^drawer$", "drawers")) %>%
        mutate(naming_response = str_replace(naming_response,  "^drums$", "drum")) %>%
        mutate(naming_response = str_replace(naming_response,  "^feet$", "foot")) %>%
        mutate(naming_response = str_replace(naming_response,  "^geese$", "goose")) %>%
        mutate(naming_response = str_replace(naming_response,  "^gloves$", "glove")) %>%
        mutate(naming_response = str_replace(naming_response,  "^grape$", "grapes")) %>%
        mutate(naming_response = str_replace(naming_response,  "^ladders$", "ladder")) %>%
        mutate(naming_response = str_replace(naming_response,  "^lip$", "lips")) %>%
        mutate(naming_response = str_replace(naming_response,  "^mice$", "mouse")) %>%
        mutate(naming_response = str_replace(naming_response,  "^mittens$", "mitten")) %>%
        mutate(naming_response = str_replace(naming_response,  "^onions$", "onion")) %>%
        mutate(naming_response = str_replace(naming_response,  "^onions$", "onion")) %>%
        mutate(naming_response = str_replace(naming_response,  "^peanuts$", "peanut")) %>%
        mutate(naming_response = str_replace(naming_response,  "^pears$", "pear")) %>%
        mutate(naming_response = str_replace(naming_response,  "^peppers$", "pepper")) %>%
        mutate(naming_response = str_replace(naming_response,  "^pumpkins$", "pumpkin")) %>%
        mutate(naming_response = str_replace(naming_response,  "^shoes$", "shoe")) %>%
        mutate(naming_response = str_replace(naming_response,  "^sock$", "socks")) %>%
        mutate(naming_response = str_replace(naming_response,  "^steps$", "step")) %>% #change 
        mutate(naming_response = str_replace(naming_response,  "^babydoll$", "doll")) %>%
        mutate(naming_response = str_replace(naming_response,  "^broomstick$", "broom")) %>%
        mutate(naming_response = str_replace(naming_response,  "^cock$", "cockerel")) %>%
        mutate(naming_response = str_replace(naming_response,  "^cycle$", "bicycle")) %>%
        mutate(naming_response = str_replace(naming_response,  "^dolly$", "doll")) %>%
        mutate(naming_response = str_replace(naming_response,  "^eyeglass$", "eyeglasses")) %>%
        mutate(naming_response = str_replace(naming_response,  "^fencing$", "fence")) %>%
        mutate(naming_response = str_replace(naming_response,  "^haircomb$", "comb")) %>%
        mutate(naming_response = str_replace(naming_response,  "^longdress$", "dress")) %>%
        mutate(naming_response = str_replace(naming_response,  "^mit$", "mitten")) %>%
        mutate(naming_response = str_replace(naming_response,  "^plugin$", "plug")) %>%
        mutate(naming_response = str_replace(naming_response,  "^rule$", "ruler")) %>%
        mutate(naming_response = str_replace(naming_response,  "^specs$", "spectacles")) %>%
        mutate(naming_response = str_replace(naming_response,  "^teakettle$", "kettle")) %>%
####################################################################################################################
##    Naming totals:                                                                                              ##
####################################################################################################################
        add_count(stim, name = "total_responses") %>%
        add_count(naming_response, name = "resp_count") %>%
        mutate(prop_resp = (resp_count / total_responses)) %>%
        mutate(no_count = sum(naming_response == "no")) %>%    
        mutate(prop_no = (no_count / total_responses)) %>%
        mutate(correct_count = sum(naming_response == correct_name)) %>%
        mutate(prop_correct = (correct_count / total_responses)) %>%
        mutate(incorrect_count = sum(naming_response != correct_name)) %>%
        mutate(prop_incorrect = (incorrect_count / total_responses)) %>%
        select(-total_responses) %>%
        distinct(naming_response, .keep_all = TRUE)
####################################################################################################################
##    Item exclusion:                                                                                             ##
####################################################################################################################    
##  Exclusion criteria 1: items with a “don’t know” score over 20%:
    exclusion_1 <- naming %>% 
        filter(prop_no >= 0.2) %>%    
        distinct(stim, .keep_all = TRUE)
##  Exclusion criteria 2: items incorrectly named by the majority of subjects (prop_correct equals .50 or lower).
    exclusion_2 <- naming %>%
        filter(prop_correct <= 0.5) %>%
        distinct(stim, .keep_all = TRUE)
##  Exclusion criteria 3: items where only 20% (or fewer) subjects named the object similarly (poor naming agreement). 
    exclusion_3 <- naming %>%                                              
        filter(prop_resp == max(prop_resp)) %>%     # Get the highest agreed upon name for each object.
        filter(prop_resp <= 0.2)                    # Filter to see if any items received lower than 20% agreement.
##  Combine all to-be-excluded items into a single df:
    all_exclusion <- bind_rows(exclusion_1, exclusion_2, exclusion_3) %>%
        arrange(stim)                                                                 
##  Simplified list of to-be-excluded item names (colour/greyscale taken out):       
    items_to_exclude <- c(all_exclusion$stim) %>%
    # It's not really important whether the grey or colour version of an item did not meet the inclusion criteria.
    # Regardless of which is flagged, we remove both the grey and colour (we need to have both versions going forward).
        str_remove_all("[-](.*)") %>%
        unique()
## Drop these items from naming data:
    naming <- naming %>%
        mutate(temp_stim = str_remove_all(stim, "[-](.*)")) %>%
        filter(!temp_stim %in% items_to_exclude) %>%
        select(-temp_stim)
    
####################################################################################################################
##    Identify items with least difference between colour and grey:                                               ##
####################################################################################################################    
    grey <- naming %>%
        select(stim, prop_correct) %>%
        filter(str_detect(stim, "grey$")) %>%
        distinct(stim, .keep_all = TRUE) %>%
        rename(grey_correct = prop_correct) %>%
        mutate(stim = str_remove_all(stim, "[-](.*)"))
    col <- naming %>%
        select(stim, prop_correct) %>%
        filter(str_detect(stim, "colour$")) %>%
        distinct(stim, .keep_all = TRUE) %>%
        rename(col_correct = prop_correct) %>%
        mutate(stim = str_remove_all(stim, "[-](.*)"))
    col_and_grey <- right_join(grey, col, by = 'stim') %>%
        mutate(difference = abs(col_correct - grey_correct))
##  For each of the object names, give us the version with the least 
##  'difference' (of % correct) between colour and greyscale.
    # List all object names to loop through:
    item_names <- col_and_grey %>%
        select(stim) %>%
        mutate(stim = str_remove_all(stim, "[0-3]")) %>%
        distinct(stim) %>%
        pull()
    
    selected_stimuli <- tibble()                # Create empty df to store results of for loop. 
 
    # Define function that selects the appropriate row(s), depending on whether items share the same difference value.
    my_function <- function(i){
      # If top row of "tally_difference_values" == 1, that's the lowest difference, so only keep only that row.
      if (i[1,5] == 1) {  
          i %>% .[1,] }
      # If top row of "tally_difference_values" == 2, then the lowest difference is shared by two rows, so keep both.
      else if (i[1,5] == 2) {
          i %>% .[1:2,] }
      # If top row of "tally_difference_values" == 3, then the lowest difference is shared by all 3 rows, so keep all.
      else if (i[1,5] == 3) {
       i %>% .[1:3,] }
      }
      
    for (i in item_names) {                                               # For each item (i) in item_names;
        i <- col_and_grey %>%                                             # i equals the data from col_and_grey;
            filter(str_detect(stim, i)) %>%                               # filter by each item separately;
            group_by(difference) %>%                                      # group by 'difference' col;
            add_count(difference, name = "tally_difference_values") %>%   # add column counting unique difference values;
            arrange(difference) %>%                                       # sort difference values (ascending);
            my_function()
        selected_stimuli <- bind_rows(selected_stimuli, i) }        # Add row to selected_stimuli df before looping.
    selected_stimuli <- selected_stimuli %>%
        distinct(stim, .keep_all = TRUE) %>%
        arrange(stim)

####################################################################################################################
##    Inter-rater selections:                                                                                     ##
#################################################################################################################### 
##  For objects where >1 variation remains (no difference between col/greyscale variations), we must manually select 
##  the variation we think is the best to be taken forward to the final stim set. 
    inter_rater <- selected_stimuli %>%
        select(stim, tally_difference_values) %>%
        filter(tally_difference_values >1)
##  The "inter_rater" df was exported here so each rater could give their independent rankings for each object.
##  Import rating data: 
    rater_1 <- read_csv("./resources/rater_1.csv", col_types = list(col_character(), col_double())) %>%
        rename(rater_1 = rating)
    rater_2 <- read_csv("./resources/rater_2.csv", col_types = list(col_character(), col_double())) %>%
        rename(rater_2 = rating)
    agreements <- merge(rater_1, rater_2) %>%
        group_by(stim) %>%
        filter(rater_1 == 1 & rater_2 == 1) %>%
        mutate(stim_raw = str_remove(stim, "[1-3]"))
##  For all the items where there was disagreement, we need to just select one of the options at random:
        agree_items <- agreements %>%
        pull(stim_raw)
    disagreements <- merge(rater_1, rater_2) %>%
        rename(disagreed = "stim") %>%
        mutate(stim_raw = str_remove(disagreed, "[1-3]")) %>%
        filter(!stim_raw %in% agree_items) %>%
        filter(rater_1 != rater_2) %>%
        group_by(stim_raw)
##  The following code as used to randomise (but running this again would give different results!):
        #randomised_disagree_items <- sample_n(disagreements, 1) %>%
            #ungroup() %>%
            #select(disagreed) %>%
            #rename(stim = "disagreed")
        #write.csv(randomised_disagree_items,'~/Desktop/randomised_disagree_items.csv', row.names = FALSE)
##  Since we wrote our original randomised selection to .csv, we import that to get the same results.
    randomised_disagree_items <- read_csv("./resources/randomised_disagree_items.csv", 
                                          col_types = list(col_character()))
    inter_rater_items <- agreements %>%
        select(stim) %>%
        bind_rows(randomised_disagree_items) %>%
        arrange(stim) 

##  We want to add these items back into the "selected_stimuli" df, so we have a complete list of final stim.
##  First we remove all variations of these items from "selected_stimuli", before adding "inter_rater_items" back in.
    inter_rater_items_raw <- inter_rater_items %>%
        pull(stim) %>%
        str_remove("[1-3]")
    final_stim_list <- selected_stimuli %>%
        select(stim) %>%
        mutate(stim_raw = str_remove(stim, "[1-3]")) %>%
        filter(!stim_raw %in% inter_rater_items_raw) %>%
        select(-stim_raw) %>%
        bind_rows(inter_rater_items) %>%
        arrange(stim)

####################################################################################################################
##   Additional stats:                                                                                            ##
####################################################################################################################    
####################################################################################################################
##   H stat (naming agreement):                                                                                   ##
#################################################################################################################### 
    h_stat_all_items <- naming %>%
        select(stim, naming_response, prop_resp, prop_correct) %>% 
        filter(!naming_response == "no") %>%              # "Don't know" responses cannot be included in H calculations.
        rename(pi = "prop_resp") %>%                      # pi = proportion of subjects producing the i-th name.
        mutate(one_divided_by_pi = 1 / pi) %>%                 
        mutate(log_two = log2(one_divided_by_pi)) %>%     # Log of base 2 of 1 / prop.
        mutate(multiplied = pi*log_two) %>%               # pi multiplied by 'log of base 2' of 1 / prop.
        mutate(H = sum(multiplied)) %>%                   # Sum multiplied values for each item = H. 
        arrange(stim, desc(pi)) %>%
        select(stim, naming_response, prop_correct, H)%>%
        distinct(stim, .keep_all = TRUE) %>%
        rename(most_freq_name = naming_response) %>%
        mutate_at(c("prop_correct", "H"), round, 2) %>%
      # Two items had a number at the end of their name in some conditions, remove this: 
        mutate(stim = str_replace(stim, "skunk3-photo-grey1", "skunk3-photo-grey")) %>%
        mutate(stim = str_replace(stim, "skunk3-photo-colour1", "skunk3-photo-colour"))
####################################################################################################################
##   Krippendorff's alpha (reliability coefficient) stat:                                                         ##
#################################################################################################################### 
    kripp_rater_1 <- rater_1 %>%
        spread(stim, rater_1)
    kripp_rater_2 <- rater_2 %>%
        spread(stim, rater_2)
    kripp_ratings <- bind_rows(kripp_rater_1, kripp_rater_2)
# Loop that runs through each of the rated objects and individually calculates kripps alpha: 
    kripps_alpha <- tibble()                              # Create empty df to store results of for loop. 
    for (i in inter_rater_items_raw) {
        kripp_calc <- kripp_ratings %>%
            select(contains(i)) %>%                       # Select all ratings for each item in turn (i).
            as.matrix() %>%                               # Tibble to matrix, so "kripp.alpha" can run.
            kripp.alpha("ordinal")                        # Run Krippendorff's Alpha calculation.
  
        kripp_calc <- as.tibble(kripp_calc[c(2,3,5)]) %>% # Convert result from "irrlist" to tibble. 
            mutate(object = i)                            # Re-insert the object name.
        kripps_alpha <- bind_rows(kripps_alpha, kripp_calc) }
# Final edits: 
    kripps_alpha <- kripps_alpha %>%
        mutate_at(c("value"), round, 2) %>%
        select(object, subjects, value) %>%
        rename("krippendorffs_alpha" = value, "variations" = subjects, "concept" = object)

# Has to be run for each object. Still say how many items we disagreed on, here's some examples (they were v similar). 
# we tried to do it objectively, BUT.... we know % is shitty but,.....
# it's all we needd for our reference.
# sometimes 3 items, sometimes 2. All items were 100% rated in naming...V difficult to decide on best as "good" items were all so similar. 

    
        #t-test:
        #mutate(stim = str_remove(stim, "^(.*?-.*?)-")) %>%
    #fam_summary <- fam %>%
    #    get_summary_stats(familiarity, type = "mean_sd")
    #fam_plot <- ggqqplot(fam, x = "familiarity", facet.by = "stim")
    #fam_ttest <- fam %>% 
    #    ungroup() %>% 
    #    t_test(familiarity ~ stim) %>%
    #    add_significance()
    
    results_norms <- raw_data %>%
        ungroup() %>% 
        select(stim, familiarity, visualcomplexity, colourdiagnosticity, mentalimageryagreement) %>%
        mutate(stim = str_replace(stim, "colour1", "colour")) %>%
        mutate(stim = str_replace(stim, "grey1", "grey")) %>%
        mutate(familiarity = str_remove(familiarity, "fam_")) %>%
        mutate(visualcomplexity = str_remove(visualcomplexity, "viscom_")) %>%
        mutate(colourdiagnosticity = str_remove(colourdiagnosticity, "coldia_")) %>%
        mutate(mentalimageryagreement = str_remove(mentalimageryagreement, "menima_")) %>%
        mutate(familiarity = as.double(familiarity)) %>%
        mutate(visualcomplexity = as.double(visualcomplexity)) %>%
        mutate(colourdiagnosticity = as.double(colourdiagnosticity)) %>%
        mutate(mentalimageryagreement = as.double(mentalimageryagreement)) %>%
        group_by(stim) %>%
        summarise_all(tibble::lst(mean), na.rm = TRUE)
    grey_norms <- results_norms %>%
        filter(str_detect(stim, "grey")) %>%
        mutate(grey_fam_mean = mean(familiarity_mean)) %>%
        mutate(grey_fam_sd = sd(familiarity_mean)) %>%
        mutate(grey_viscom_mean = mean(visualcomplexity_mean)) %>%
        mutate(grey_viscom_sd = sd(visualcomplexity_mean)) %>%
        mutate(grey_menima_mean = mean(mentalimageryagreement_mean)) %>%
        mutate(grey_menima_sd = sd(mentalimageryagreement_mean)) %>%
        select(grey_fam_mean, grey_fam_sd, grey_viscom_mean, 
               grey_viscom_sd, grey_menima_mean, grey_menima_sd) %>%
        distinct()
    grey_naming_norms <- h_stat_all_items %>%
        ungroup() %>%
        filter(str_detect(stim, "grey")) %>%
        mutate(grey_naming_acc_mean = mean(prop_correct)) %>%
        mutate(grey_naming_acc_sd = sd(prop_correct)) %>%
        mutate(grey_H_mean = mean(H)) %>%
        mutate(grey_H_sd = sd(H)) %>%
        select(grey_naming_acc_mean, grey_naming_acc_sd, grey_H_mean, grey_H_sd) %>%
        distinct()
    grey_norms <- bind_cols(grey_norms, grey_naming_norms)
    col_norms <- results_norms %>%
        filter(str_detect(stim, "colour")) %>%
        mutate(col_fam_mean = mean(familiarity_mean)) %>%
        mutate(col_fam_sd = sd(familiarity_mean)) %>%
        mutate(col_viscom_mean = mean(visualcomplexity_mean)) %>%
        mutate(col_viscom_sd = sd(visualcomplexity_mean)) %>%
        mutate(col_menima_mean = mean(mentalimageryagreement_mean)) %>%
        mutate(col_menima_sd = sd(mentalimageryagreement_mean)) %>%
        mutate(col_coldia_mean = mean(colourdiagnosticity_mean)) %>%
        mutate(col_coldia_sd = sd(colourdiagnosticity_mean)) %>%
        select(col_fam_mean, col_fam_sd, col_viscom_mean, 
               col_viscom_sd, col_menima_mean, col_menima_sd, col_coldia_mean, col_coldia_sd) %>%
        distinct()
    col_naming_norms <- h_stat_all_items %>%
        ungroup() %>%
        filter(str_detect(stim, "colour")) %>%
        mutate(col_naming_acc_mean = mean(prop_correct)) %>%
        mutate(col_naming_acc_sd = sd(prop_correct)) %>%
        mutate(col_H_mean = mean(H)) %>%
        mutate(col_H_sd = sd(H)) %>%
        select(col_naming_acc_mean, col_naming_acc_sd, col_H_mean, col_H_sd) %>%
        distinct()
    col_norms <- bind_cols(col_norms, col_naming_norms)
# Create norms table (all stim):
    colvsgreynorms <- tribble(
      ~"Item type", ~"Naming accuracy", ~"Naming agreement (H)", ~"Mental imagery agreement", ~"Familiarity", 
      ~"Visual complexity", ~"Colour Diagnosticity",
       "Grey", 
        grey_norms %>% select(grey_naming_acc_mean) %>% pull() %>% round (2), # Grey naming accuracy;
        grey_norms %>% select(grey_H_mean) %>% pull() %>% round (2),          # Grey H;
        grey_norms %>% select(grey_menima_mean) %>% pull() %>% round (2),     # Grey MenIma;
        grey_norms %>% select(grey_fam_mean) %>% pull() %>% round (2),        # Grey Fam;
        grey_norms %>% select(grey_viscom_mean) %>% pull() %>% round (2),     # Grey VisCom;
        NA,                                                                   # Grey ColDia;
       "Colour", 
        col_norms %>% select(col_naming_acc_mean) %>% pull() %>% round (2),   # Col naming accuracy;
        col_norms %>% select(col_H_mean) %>% pull() %>% round (2),            # Col H;
        col_norms %>% select(col_menima_mean) %>% pull() %>% round (2),       # Col MenIma;
        col_norms %>% select(col_fam_mean) %>% pull() %>% round (2),          # Col Fam;
        col_norms %>% select(col_viscom_mean) %>% pull() %>% round (2),       # Col VisCom;
        col_norms %>% select(col_coldia_mean) %>% pull() %>% round (2))       # Col ColDia
```


## Results
### General analyses
Mean values for 


### Selection of final items
In an effort to reduce researcher bias, the normative naming data was assessed to determine which photograph variation best matched the concepts depicted in the line drawings [@rossion2004]. For each item represented in the photographs, one variation (of a possible three) would be selected for inclusion in a final list of stimuli that would be taken forward into subsequent recognition experiments. The selection process was conducted on the basis of naming data only. If an item was found to primarily convey a different concept than intended during the naming task, then it could not be sufficiently compared to its line-drawn (and written-word) counterpart during recognition studies. 

Naming data from all participants was collated, resulting in at least 20 unique naming responses for each of the 816 photographs (408 colour items and 408 greyscale items). The proportion of 'correct' responses (i.e. names that were congruent with the intended label) and the proportion of 'don't know' responses were calculated for each item. Photographs were subjected to a number of criteria to determine whether they should be taken any further. First, items were excluded if they received a high proportion of "don't know" responses (20%) - all of the photographs depicted common, everyday objects, and so if a number of subjects were unable to name the item, that particular photograph was considered to be a poor representation of the item. Similarly, items were excluded if they were incorrectly named by the majority of subjects (i.e. if the proportion of correct responses equalled .50 or lower), since it was essential for the photograph items to depict the same concepts as those found in the line drawings and word stimuli. Finally, items with particularly poor naming agreement were also excluded (i.e. 20% or fewer subjects named the object similarly). A total of 54 photographs matched at least one of these criteria. Regardless of whether flagged items were grey or colour, both items had to be removed since it was necessary to have otherwise identical grey and colour versions in our final stimuli list. Thus, a total of 64 items (32 grey / 32 colour) were excluded at this stage.

Next, the proportion of correct responses were compared between grey and colour photographs in order to identify items showing the lowest difference. In order to manipulate colour in later recognition experiments, it was important to select items where naming was congruent across colour/grey items; in other words, it would be difficult to attribute particular recognition response patterns to the addition of colour (if a difference were found) when the grey version could not be identified (or encoded) similarly. Variations exhibiting the least difference between colour and grey items (for the proportion of correct responses) were taken forward, while the rest were excluded. In a number of instances, multiple variations for the same object had the same 'difference' score. For example, all three variations of the item "balloon" exhibited perfect naming agreement, irrespective of whether they were presented in colour or grey (and thus "balloon1", "balloon2", and "balloon3" had a difference score of 0). For items where more than 1 variation remained, manual rankings were obtained from two of the researchers to determine which variation best depicted the intended concept. For each item, the researchers independently studied the remaining variations and provided a rank of which they thought was best (1) to worst (2 or 3, depending on the number of variations that remained). The ratings from both researchers were collated; items where there was agreement as to which variation best depicted the intended concept were selected for inclusion in the final stimuli list. For all the items where there was disagreement between the researchers rankings, one of the variations was simply selected at random.



\newpage
# Experiment 3
```{r experiment-3-main, include=FALSE, warning = FALSE, message=FALSE, cache=TRUE}
####################################################################################################################
##                                                                                                                ##
##    Participant info:                                                                                           ##
##                                                                                                                ##
####################################################################################################################
##  Import demographics, RFG justifications, and RFBG justifications:                       
    p_info_files <-                                                                             # SONA - colour + grey (v123):
      c("./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_questionnaire-hq4r.csv",   # Demographics (v123)
        "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_questionnaire-aaj1.csv",   # RFG justifications (v123)
        "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_questionnaire-n6oe.csv",   # RFBG justifications (v123)
                                                                                                # Prolific - colour (v127):
        "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_questionnaire-hq4r.csv",   # Demographics (v127)
        "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_questionnaire-aaj1.csv",   # RFG justifications (v127)
        "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_questionnaire-n6oe.csv",   # RFBG justifications (v127)
                                                                                                # Prolific - colour (v128):
        "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_questionnaire-hq4r.csv",   # Demographics (v128)
        "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_questionnaire-aaj1.csv",   # RFG justifications (v128)
        "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_questionnaire-n6oe.csv",   # RFBG justifications (v128)
                                                                                                # Prolific - grey (v131):
        "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_questionnaire-hq4r.csv",   # Demographics (v131)
        "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_questionnaire-aaj1.csv",   # RFG justifications (v131)
        "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_questionnaire-n6oe.csv",   # RFBG justifications (v131)
                                                                                                # Hanover - grey (v4):
        "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_questionnaire-hq4r.csv",     # Demographics (v4)
        "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_questionnaire-aaj1.csv",     # RFG justifications (v4)
        "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_questionnaire-n6oe.csv")     # RFBG justifications (v4)

##  Create raw df from the above files, but only get the following columns:
    participant_info <- map_dfr(p_info_files,~read_csv(.x, col_types = cols_only("Participant Private ID"='c', 
                                                                                 "Participant Public ID"='c',
                                                                                 "UTC Date"='c',"Participant OS"='c',
                                                                                 "Participant Browser"='c',
                                                                                 "Participant Monitor Size"='c',          
                                                                                 "randomiser-hr2x"='c',
                                                                                 "randomiser-r7fb"='c',
                                                                                 "randomiser-hr9o"='c',
                                                                                 "randomiser-8myq"='c', 
                                                                                 "randomiser-uhe4"='c',
                                                                                 "randomiser-z5ou"='c', 
                                                                                 "randomiser-kdpl"='c',
                                                                                 "randomiser-fslx"='c', 
                                                                                 "randomiser-1ls2"='c',
                                                                                 "checkpoint-cks2"='c', 
                                                                                 "checkpoint-lpef"='c',
                                                                                 "checkpoint-n8cs"='c', 
                                                                                 "checkpoint-8p6q"='c',
                                                                                 "checkpoint-jk6r"='c', 
                                                                                 "checkpoint-j7fq"='c',
                                                                                 "checkpoint-n8cs"='c', 
                                                                                 "Question Key"='c',"Response"='c'))) %>%
##  Merge columns that contain the same type of data, but were originally split into different columns:
        unite(study_list,  "randomiser-r7fb", "randomiser-hr9o", remove = TRUE, na.rm = TRUE) %>%
        unite(test_list,   "checkpoint-cks2", "checkpoint-lpef", "checkpoint-n8cs", "checkpoint-8p6q",
                           "checkpoint-jk6r", "checkpoint-j7fq", "checkpoint-n8cs", remove = TRUE, na.rm = TRUE) %>%
        unite(resp_option, "randomiser-kdpl", "randomiser-8myq", "randomiser-z5ou", "randomiser-uhe4",
                           "randomiser-fslx", "randomiser-1ls2", remove = TRUE, na.rm = TRUE) %>%
##  Rename some columns:    
        rename(id = "Participant Private ID", prolific_id = "Participant Public ID", date = "UTC Date", 
               system = "Participant OS", browser = "Participant Browser", monitor = "Participant Monitor Size", 
               col_or_grey = "randomiser-hr2x", question = "Question Key", response = "Response") %>%   
##  Reorder columns:    
        select(id, prolific_id, date, system, browser, monitor, col_or_grey, resp_option, study_list, test_list, question,
               response) %>%
##  Set participant ID as the grouping variable, and arrange data by participant ID:
        group_by(id) %>%
        arrange(id) %>%
##  Remove empty / unimportant rows:
        drop_na(id) %>%
        filter(question != "BEGIN QUESTIONNAIRE") %>%    
        filter(question != "END QUESTIONNAIRE") %>%
##  Reformat from long to wide:
        spread(key = question, value = response) %>%
##  Remove unimportant columns:    
        select(-"age-quantised", -"attention_check-quantised", -"EngFirstLang-quantised", -"ethnicity-quantised",
               -"ethnicity2-quantised", -"ethnicity3-quantised", -"mem_skills_1-quantised", -"mem_skills_2-quantised",
               -"response-6-quantised", -"response-9-quantised") %>%
##  Merge multiple rows into one (per participant):
        summarise_all(coalesce_by_column) %>%
##  Rename more columns:
        rename(white = "ethnicity", mixed = "ethnicity2", asian = "ethnicity3", eng_first_lang = "EngFirstLang",
               mixed_other = "response-4", asian_other = "response-15", black = "response-6", 
               black_other = "response-7", other_ethnic = "response-9", other_ethnic_specified = "response-4") %>%
##  Reorder columns again:   
        select(id, prolific_id, date, system, browser, monitor, col_or_grey, resp_option, study_list, test_list, 
               age, gender, eng_first_lang, white, white_other, mixed, mixed_other, asian, asian_other, black, 
               black_other, other_ethnic, other_ethnic_specified, rec_justification, fam_justification,
               both_justification, guess_justification, mem_skills_1, mem_skills_2, attention_check) %>%
##  Recode attention check to show pass or fail:
        mutate(attention_check = str_replace(attention_check, "a lot better", "pass")) %>%
        mutate(attention_check = str_replace_all(attention_check, c("a lot worse" = "fail", "a little worse" = "fail", 
                                                                    "the same" = "fail", "a little better" = "fail"))) %>%
##  Tidy up responses for clarity:
        mutate_all(., tolower) %>%
        mutate(col_or_grey = str_remove_all(col_or_grey, "^(.*?)__")) %>%
        mutate(resp_option = str_remove_all(resp_option, "^(.*?)_")) %>%
        mutate(study_list = str_remove_all(study_list, "[^0-9]+")) %>%
        mutate(test_list = str_remove_all(test_list, "\\_.+")) %>%
        mutate(system = str_remove_all(system, "\\ .+")) %>%
        mutate(browser = str_remove_all(browser, "\\ .+")) %>%
        mutate(mixed = str_remove_all(mixed, "\\ .+")) %>%
        mutate(asian = str_remove_all(asian, "\\ .+")) %>%
        mutate(black = str_remove_all(black, "\\ .+")) %>%
        mutate(gender = str_replace(gender, "^f$", "female")) %>%
        mutate(gender = str_replace(gender, "femle", "female")) %>%
        mutate(gender = str_replace(gender, "femal", "female")) %>%
        mutate(gender = str_replace(gender, "femalee", "female")) %>%
        mutate(gender = str_replace(gender, "woman", "female")) %>%
        mutate(gender = str_replace(gender, "^m$", "male")) %>%
        mutate(gender = str_replace(gender, "malw", "male")) %>%
        mutate(gender = str_replace(gender, "mle", "male")) %>%
        mutate(gender = str_replace(gender, "^[0-9]*$", "unspecified")) %>%
        mutate(gender = replace_na(gender, "unspecified")) %>%
        arrange(col_or_grey, desc(resp_option), study_list, test_list)
    
##  Calculate how many items P got correct during study:
##  Import study data:                                                            # SONA - colour + grey (v123):
    study_files <- c("./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-hqih.csv",    # Study_1_Grey (v123)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-iwo1.csv",    # Study_2_Grey (v123)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-zde5.csv",    # Study_3_Grey (v123)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-gb72.csv",    # Study_4_Grey (v123)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-6xh1.csv",    # Study_5_Grey (v123)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-6t6c.csv",    # Study_6_Grey (v123)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-hjvs.csv",    # Study_1_Col (v123)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-ijsc.csv",    # Study_2_Col (v123)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-rxq8.csv",    # Study_3_Col (v123)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-41u6.csv",    # Study_4_Col (v123)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-xfbn.csv",    # Study_5_Col (v123)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-qw7d.csv",    # Study_6_Col (v123)
                                                                                  # --
                                                                                  # Prolific - colour (v127):
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_task-hjvs.csv",    # Study_1_Grey (v127) 
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_task-ijsc.csv",    # Study_2_Grey (v127) 
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_task-rxq8.csv",    # Study_3_Grey (v127)  
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_task-41u6.csv",    # Study_4_Grey (v127) 
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_task-xfbn.csv",    # Study_5_Grey (v127)  
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_task-qw7d.csv",    # Study_6_Grey (v127) 
                                                                                  # --
                                                                                  # Prolific - colour (v128):
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_task-hjvs.csv",    # Study_1_Col (v128)  
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_task-ijsc.csv",    # Study_2_Col (v128) 
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_task-rxq8.csv",    # Study_3_Col (v128)  
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_task-41u6.csv",    # Study_4_Col (v128) 
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_task-xfbn.csv",    # Study_5_Col (v128)  
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_task-qw7d.csv",    # Study_6_Col (v128) 
                                                                                  # --
                                                                                  # Prolific - grey (v131):
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_task-hqih.csv",    # Study_1_Grey (v131)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_task-iwo1.csv",    # Study_2_Grey (v131)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_task-zde5.csv",    # Study_3_Grey (v131)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_task-gb72.csv",    # Study_4_Grey (v131)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_task-6xh1.csv",    # Study_5_Grey (v131)
                     "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_task-6t6c.csv",    # Study_6_Grey (v131)                                                                                                                 # --
                                                                                  # Hanover - grey (v4):
                     "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_task-hqih.csv",      # Study_1_Grey (v4)
                     "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_task-iwo1.csv",      # Study_2_Grey (v4)
                     "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_task-zde5.csv",      # Study_3_Grey (v4)
                     "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_task-gb72.csv",      # Study_4_Grey (v4)
                     "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_task-6xh1.csv",      # Study_5_Grey (v4)
                     "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_task-6t6c.csv")      # Study_6_Grey (v4)

    
##  Create raw df from the above files, but only get the following columns:
    study_data <- map_dfr(study_files,~read_csv(.x, col_types = cols_only("Participant Private ID" = 'c',
                                                                          "Participant Public ID"='c',
                                                                          "Experiment Version" = 'c',
                                                                          "Screen Name" = 'c', 
                                                                          "stim" = 'c', "correct_answer" = 'c',
                                                                          "Response" = 'c',"Reaction Time" = col_double()))) %>%
##  Rename some columns:
        rename(id = "Participant Private ID", prolific_id = "Participant Public ID", exp_ver = "Experiment Version",
               screen = "Screen Name", rt = "Reaction Time", response = "Response") %>%
##  Reorder columns:    
        select(id, prolific_id, exp_ver, screen, stim, correct_answer, response, rt) %>%
##  Set participant ID as the grouping variable, and arrange data by participant ID:
        group_by(id) %>%
        arrange(id) %>%  
##  Remove empty / unimportant rows:
        drop_na(screen) %>%
        filter(screen != "check") %>%
        filter(screen != "fixation") %>%
        filter(screen != "filler_start_fixation") %>%
        filter(screen != "filler_start_stim") %>%
        filter(screen != "filler_end_fixation") %>%
        filter(screen != "filler_end_stim") %>%
        add_count(screen, name = "total_resp")
##  Calculate how many responses were correct for each stimuli format, then join these together:
    word <- study_data %>%
        filter(correct_answer == "word.png") %>%
        add_count(screen, name = "study_word_resps") %>%
        filter(response == "word.png") %>%
        add_count(screen, name = "study_word_correct") %>%
        distinct(id, .keep_all = TRUE) %>%
        select(id, exp_ver, study_word_resps, study_word_correct)
    drawing <- study_data %>%
        filter(correct_answer == "line-drawing.png") %>%
        add_count(screen, name = "study_drawing_resps") %>%
        filter(response == "line-drawing.png") %>%
        add_count(screen, name = "study_drawing_correct") %>%
        distinct(id, .keep_all = TRUE) %>%
        select(id, exp_ver, study_drawing_resps, study_drawing_correct)
    photo <- study_data %>%
        filter(correct_answer == "photograph.png") %>%
        add_count(screen, name = "study_photo_resps") %>%
        filter(response == "photograph.png") %>%
        add_count(screen, name = "study_photo_correct") %>%
        distinct(id, .keep_all = TRUE) %>%
        select(id, exp_ver, study_photo_resps, study_photo_correct)
    study_totals <- right_join(word, drawing, by = "id") %>%
        right_join(photo, by = "id")
##  Add 'study_totals' to 'participant_info' df:
    participant_info <- participant_info %>%
        right_join(study_totals, by = "id") %>%
        mutate(study_responses_total = study_word_resps + study_drawing_resps + study_photo_resps) %>%
        mutate(study_correct = study_word_correct + study_drawing_correct + study_photo_correct) %>%
        mutate(study_correct_percent = study_correct*(100/study_responses_total)) %>%
        mutate(study_error = study_responses_total - study_correct) %>%
        mutate(study_error_percent = study_error*(100/study_responses_total)) %>%
        arrange(col_or_grey, desc(resp_option), study_list, test_list) %>%
        mutate(col_or_grey = str_replace(col_or_grey, "greyscale", "grey")) %>%
        mutate(col_or_grey = str_replace(col_or_grey, "colour", "col")) %>%
        select(-exp_ver.x, -exp_ver.y) %>%
        select(id, prolific_id, exp_ver, everything())

####################################################################################################################
##                                                                                                                ##
##    Define study lists:                                                                                         ##
##                                                                                                                ##
####################################################################################################################
##  Define all possible study lists, so we can later calculate Hits, Misses, FA, CRs.  
    study_1_grey_list <- c("grey_photo_ashtray3","grey_photo_balloon3","grey_photo_barrel3","grey_photo_bear2",
                           "grey_photo_bowl2","grey_photo_brush2","grey_photo_camel3","grey_photo_clock3",
                           "grey_photo_deer2","grey_photo_door3","grey_photo_drum1","grey_photo_fence3",
                           "grey_photo_nail3","grey_photo_needle3","grey_photo_nose3","grey_photo_pear1",
                           "grey_photo_pliers2","grey_photo_rabbit3","grey_photo_skunk2","grey_photo_table2",
                           "grey_photo_watch1","word_banana","word_boot","word_celery","word_chair","word_cloud",
                           "word_ladder","word_lips","word_peach","word_peacock","word_pencil","word_pepper",
                           "word_piano","word_pipe","word_pumpkin","word_ring","word_seal","word_sheep","word_snail",
                           "word_spider","word_tiger","word_train","grey_drawing_basket","grey_drawing_book",
                           "grey_drawing_bottle","grey_drawing_broom","grey_drawing_cherry","grey_drawing_chicken",
                           "grey_drawing_comb","grey_drawing_eagle","grey_drawing_flute","grey_drawing_goat",
                           "grey_drawing_iron","grey_drawing_moon","grey_drawing_mouse","grey_drawing_ostrich",
                           "grey_drawing_socks","grey_drawing_stool","grey_drawing_thumb","grey_drawing_toaster",
                           "grey_drawing_tree","grey_drawing_violin","grey_drawing_well")
    
    study_2_grey_list <- c("word_ashtray","word_balloon","word_barrel","word_bear","word_bowl","word_brush","word_camel",
                           "word_clock","word_deer","word_door","word_drum","word_fence","word_nail","word_needle",
                           "word_nose","word_pear","word_pliers","word_rabbit","word_skunk","word_table","word_watch",
                           "grey_drawing_banana","grey_drawing_boot","grey_drawing_celery","grey_drawing_chair",
                           "grey_drawing_cloud","grey_drawing_ladder","grey_drawing_lips","grey_drawing_peach",
                           "grey_drawing_peacock","grey_drawing_pencil","grey_drawing_pepper","grey_drawing_piano",
                           "grey_drawing_pipe","grey_drawing_pumpkin","grey_drawing_ring","grey_drawing_seal",
                           "grey_drawing_sheep","grey_drawing_snail","grey_drawing_spider","grey_drawing_tiger",
                           "grey_drawing_train","grey_photo_basket2","grey_photo_book1","grey_photo_bottle2",
                           "grey_photo_broom2","grey_photo_cherry1","grey_photo_chicken2","grey_photo_comb2",
                           "grey_photo_eagle1","grey_photo_flute1","grey_photo_goat2","grey_photo_iron2",
                           "grey_photo_moon3","grey_photo_mouse2","grey_photo_ostrich3","grey_photo_socks1",
                           "grey_photo_stool2","grey_photo_thumb1","grey_photo_toaster1","grey_photo_tree1",
                           "grey_photo_violin1","grey_photo_well2")
    
    study_3_grey_list <- c("grey_drawing_ashtray","grey_drawing_balloon","grey_drawing_barrel","grey_drawing_bear",
                           "grey_drawing_bowl","grey_drawing_brush","grey_drawing_camel","grey_drawing_clock",
                           "grey_drawing_deer","grey_drawing_door","grey_drawing_drum","grey_drawing_fence",
                           "grey_drawing_nail","grey_drawing_needle","grey_drawing_nose","grey_drawing_pear",
                           "grey_drawing_pliers","grey_drawing_rabbit","grey_drawing_skunk","grey_drawing_table",
                           "grey_drawing_watch","grey_photo_banana1","grey_photo_boot3","grey_photo_celery1",
                           "grey_photo_chair3","grey_photo_cloud2","grey_photo_ladder2","grey_photo_lips2",
                           "grey_photo_peach1","grey_photo_peacock3","grey_photo_pencil1","grey_photo_pepper2",
                           "grey_photo_piano3","grey_photo_pipe1","grey_photo_pumpkin3","grey_photo_ring1",
                           "grey_photo_seal2","grey_photo_sheep1","grey_photo_snail3","grey_photo_spider3",
                           "grey_photo_tiger2","grey_photo_train1","word_basket","word_book","word_bottle","word_broom",
                           "word_cherry","word_chicken","word_comb","word_eagle","word_flute","word_goat","word_iron",
                           "word_moon","word_mouse","word_ostrich","word_socks","word_stool","word_thumb","word_toaster",
                           "word_tree","word_violin","word_well")
    
    study_4_grey_list <- c("grey_photo_anchor3","grey_photo_apple3","grey_photo_bell1","grey_photo_bread1",
                           "grey_photo_button3","grey_photo_carrot3","grey_photo_chain1","grey_photo_corn1",
                           "grey_photo_crown2","grey_photo_fish2","grey_photo_glasses1","grey_photo_hammer2",
                           "grey_photo_horse3","grey_photo_house3","grey_photo_jacket2","grey_photo_lion2",
                           "grey_photo_orange2","grey_photo_raccoon2","grey_photo_swing2","grey_photo_thimble1",
                           "grey_photo_zebra3","word_doll","word_foot","word_frog","word_hand","word_kettle","word_kite",
                           "word_knife","word_lemon","word_lobster","word_lock","word_penguin","word_plug","word_potato",
                           "word_shirt","word_shoe","word_skirt","word_snake","word_snowman","word_spoon","word_tomato",
                           "word_trumpet","grey_drawing_belt","grey_drawing_cake","grey_drawing_candle",
                           "grey_drawing_cannon","grey_drawing_duck","grey_drawing_flag","grey_drawing_flower",
                           "grey_drawing_giraffe","grey_drawing_grapes","grey_drawing_guitar","grey_drawing_harp",
                           "grey_drawing_lamp","grey_drawing_leaf","grey_drawing_mitten","grey_drawing_monkey",
                           "grey_drawing_onion","grey_drawing_peanut","grey_drawing_screw","grey_drawing_swan",
                           "grey_drawing_whistle","grey_drawing_window")
    
    study_5_grey_list <- c("word_anchor","word_apple","word_bell","word_bread","word_button","word_carrot","word_chain",
                           "word_corn","word_crown","word_fish","word_glasses","word_hammer","word_horse","word_house",
                           "word_jacket","word_lion","word_orange","word_raccoon","word_swing","word_thimble",
                           "word_zebra","grey_drawing_doll","grey_drawing_foot","grey_drawing_frog","grey_drawing_hand",
                           "grey_drawing_kettle","grey_drawing_kite","grey_drawing_knife","grey_drawing_lemon",
                           "grey_drawing_lobster","grey_drawing_lock","grey_drawing_penguin","grey_drawing_plug",
                           "grey_drawing_potato","grey_drawing_shirt","grey_drawing_shoe","grey_drawing_skirt",
                           "grey_drawing_snake","grey_drawing_snowman","grey_drawing_spoon","grey_drawing_tomato",
                           "grey_drawing_trumpet","grey_photo_belt2","grey_photo_cake3","grey_photo_candle2",
                           "grey_photo_cannon2","grey_photo_duck2","grey_photo_flag3","grey_photo_flower3",
                           "grey_photo_giraffe1","grey_photo_grapes1","grey_photo_guitar1","grey_photo_harp2",
                           "grey_photo_lamp2","grey_photo_leaf2","grey_photo_mitten2","grey_photo_monkey1",
                           "grey_photo_onion1","grey_photo_peanut3","grey_photo_screw3","grey_photo_swan3",
                           "grey_photo_whistle1","grey_photo_window3")
    
    study_6_grey_list <- c("grey_drawing_anchor","grey_drawing_apple","grey_drawing_bell","grey_drawing_bread",
                           "grey_drawing_button","grey_drawing_carrot","grey_drawing_chain","grey_drawing_corn",
                           "grey_drawing_crown","grey_drawing_fish","grey_drawing_glasses","grey_drawing_hammer",
                           "grey_drawing_horse","grey_drawing_house","grey_drawing_jacket","grey_drawing_lion",
                           "grey_drawing_orange","grey_drawing_raccoon","grey_drawing_swing","grey_drawing_thimble",
                           "grey_drawing_zebra","grey_photo_doll1","grey_photo_foot1","grey_photo_frog2",
                           "grey_photo_hand1","grey_photo_kettle2","grey_photo_kite1","grey_photo_knife2",
                           "grey_photo_lemon3","grey_photo_lobster2","grey_photo_lock3","grey_photo_penguin1",
                           "grey_photo_plug2","grey_photo_potato1","grey_photo_shirt1","grey_photo_shoe1",
                           "grey_photo_skirt3","grey_photo_snake3","grey_photo_snowman3","grey_photo_spoon2",
                           "grey_photo_tomato1","grey_photo_trumpet3","word_belt","word_cake","word_candle",
                           "word_cannon","word_duck","word_flag","word_flower","word_giraffe","word_grapes",
                           "word_guitar","word_harp","word_lamp","word_leaf","word_mitten","word_monkey","word_onion",
                           "word_peanut","word_screw","word_swan","word_whistle","word_window")    
    
    study_1_col_list <- c("col_photo_ashtray3","col_photo_balloon3","col_photo_barrel3","col_photo_bear2",
                          "col_photo_bowl2","col_photo_brush2","col_photo_camel3","col_photo_clock3","col_photo_deer2",
                          "col_photo_door3","col_photo_drum1","col_photo_fence3","col_photo_nail3","col_photo_needle3",
                          "col_photo_nose3","col_photo_pear1","col_photo_pliers2","col_photo_rabbit3","col_photo_skunk2",
                          "col_photo_table2","col_photo_watch1","word_banana","word_boot","word_celery","word_chair",
                          "word_cloud","word_ladder","word_lips","word_peach","word_peacock","word_pencil","word_pepper",
                          "word_piano","word_pipe","word_pumpkin","word_ring","word_seal","word_sheep","word_snail",
                          "word_spider","word_tiger","word_train","col_drawing_basket","col_drawing_book",
                          "col_drawing_bottle","col_drawing_broom","col_drawing_cherry","col_drawing_chicken",
                          "col_drawing_comb","col_drawing_eagle","col_drawing_flute","col_drawing_goat",
                          "col_drawing_iron","col_drawing_moon","col_drawing_mouse","col_drawing_ostrich",
                          "col_drawing_socks","col_drawing_stool","col_drawing_thumb","col_drawing_toaster",
                          "col_drawing_tree","col_drawing_violin","col_drawing_well")
    
    study_2_col_list <- c("word_ashtray","word_balloon","word_barrel","word_bear","word_bowl","word_brush","word_camel",
                          "word_clock","word_deer","word_door","word_drum","word_fence","word_nail","word_needle",
                          "word_nose","word_pear","word_pliers","word_rabbit","word_skunk","word_table","word_watch",
                          "col_drawing_banana","col_drawing_boot","col_drawing_celery","col_drawing_chair",
                          "col_drawing_cloud","col_drawing_ladder","col_drawing_lips","col_drawing_peach",
                          "col_drawing_peacock","col_drawing_pencil","col_drawing_pepper","col_drawing_piano",
                          "col_drawing_pipe","col_drawing_pumpkin","col_drawing_ring","col_drawing_seal",
                          "col_drawing_sheep","col_drawing_snail","col_drawing_spider","col_drawing_tiger",
                          "col_drawing_train","col_photo_basket2","col_photo_book1","col_photo_bottle2",
                          "col_photo_broom2","col_photo_cherry1","col_photo_chicken2","col_photo_comb2",
                          "col_photo_eagle1","col_photo_flute1","col_photo_goat2","col_photo_iron2","col_photo_moon3",
                          "col_photo_mouse2","col_photo_ostrich3","col_photo_socks1","col_photo_stool2",
                          "col_photo_thumb1","col_photo_toaster1","col_photo_tree1","col_photo_violin1","col_photo_well2")
    
    study_3_col_list <- c("col_drawing_ashtray","col_drawing_balloon","col_drawing_barrel","col_drawing_bear",
                          "col_drawing_bowl","col_drawing_brush","col_drawing_camel","col_drawing_clock",
                          "col_drawing_deer","col_drawing_door","col_drawing_drum","col_drawing_fence",
                          "col_drawing_nail","col_drawing_needle","col_drawing_nose","col_drawing_pear",
                          "col_drawing_pliers","col_drawing_rabbit","col_drawing_skunk","col_drawing_table",
                          "col_drawing_watch","col_photo_banana1","col_photo_boot3","col_photo_celery1",
                          "col_photo_chair3","col_photo_cloud2","col_photo_ladder2","col_photo_lips2","col_photo_peach1",
                          "col_photo_peacock3","col_photo_pencil1","col_photo_pepper2","col_photo_piano3",
                          "col_photo_pipe1","col_photo_pumpkin3","col_photo_ring1","col_photo_seal2","col_photo_sheep1",
                          "col_photo_snail3","col_photo_spider3","col_photo_tiger2","col_photo_train1","word_basket",
                          "word_book","word_bottle","word_broom","word_cherry","word_chicken","word_comb","word_eagle",
                          "word_flute","word_goat","word_iron","word_moon","word_mouse","word_ostrich","word_socks",
                          "word_stool","word_thumb","word_toaster","word_tree","word_violin","word_well")
    
    study_4_col_list <- c("col_photo_anchor3","col_photo_apple3","col_photo_bell1","col_photo_bread1","col_photo_button3",
                          "col_photo_carrot3","col_photo_chain1","col_photo_corn1","col_photo_crown2","col_photo_fish2",
                          "col_photo_glasses1","col_photo_hammer2","col_photo_horse3","col_photo_house3",
                          "col_photo_jacket2","col_photo_lion2","col_photo_orange2","col_photo_raccoon2",
                          "col_photo_swing2","col_photo_thimble1","col_photo_zebra3","word_doll","word_foot",
                          "word_frog","word_hand","word_kettle","word_kite","word_knife","word_lemon","word_lobster",
                          "word_lock","word_penguin","word_plug","word_potato","word_shirt","word_shoe","word_skirt",
                          "word_snake","word_snowman","word_spoon","word_tomato","word_trumpet","col_drawing_belt",
                          "col_drawing_cake","col_drawing_candle","col_drawing_cannon","col_drawing_duck",
                          "col_drawing_flag","col_drawing_flower","col_drawing_giraffe","col_drawing_grapes",
                          "col_drawing_guitar","col_drawing_harp","col_drawing_lamp","col_drawing_leaf",
                          "col_drawing_mitten","col_drawing_monkey","col_drawing_onion","col_drawing_peanut",
                          "col_drawing_screw","col_drawing_swan","col_drawing_whistle","col_drawing_window")
    
    study_5_col_list <- c("word_anchor","word_apple","word_bell","word_bread","word_button","word_carrot","word_chain",
                          "word_corn","word_crown","word_fish","word_glasses","word_hammer","word_horse","word_house",
                          "word_jacket","word_lion","word_orange","word_raccoon","word_swing","word_thimble",
                          "word_zebra","col_drawing_doll","col_drawing_foot","col_drawing_frog","col_drawing_hand",
                          "col_drawing_kettle","col_drawing_kite","col_drawing_knife","col_drawing_lemon",
                          "col_drawing_lobster","col_drawing_lock","col_drawing_penguin","col_drawing_plug",
                          "col_drawing_potato","col_drawing_shirt","col_drawing_shoe","col_drawing_skirt",
                          "col_drawing_snake","col_drawing_snowman","col_drawing_spoon","col_drawing_tomato",
                          "col_drawing_trumpet","col_photo_belt2","col_photo_cake3","col_photo_candle2",
                          "col_photo_cannon2","col_photo_duck2","col_photo_flag3","col_photo_flower3",
                          "col_photo_giraffe1","col_photo_grapes1","col_photo_guitar1","col_photo_harp2",
                          "col_photo_lamp2","col_photo_leaf2","col_photo_mitten2","col_photo_monkey1",
                          "col_photo_onion1","col_photo_peanut3","col_photo_screw3","col_photo_swan3",
                          "col_photo_whistle1","col_photo_window3")
    
    study_6_col_list <- c("col_drawing_anchor","col_drawing_apple","col_drawing_bell","col_drawing_bread",
                          "col_drawing_button","col_drawing_carrot","col_drawing_chain","col_drawing_corn",
                          "col_drawing_crown","col_drawing_fish","col_drawing_glasses","col_drawing_hammer",
                          "col_drawing_horse","col_drawing_house","col_drawing_jacket","col_drawing_lion",
                          "col_drawing_orange","col_drawing_raccoon","col_drawing_swing","col_drawing_thimble",
                          "col_drawing_zebra","col_photo_doll1","col_photo_foot1","col_photo_frog2","col_photo_hand1",
                          "col_photo_kettle2","col_photo_kite1","col_photo_knife2","col_photo_lemon3",
                          "col_photo_lobster2","col_photo_lock3","col_photo_penguin1","col_photo_plug2",
                          "col_photo_potato1","col_photo_shirt1","col_photo_shoe1","col_photo_skirt3",
                          "col_photo_snake3","col_photo_snowman3","col_photo_spoon2","col_photo_tomato1",
                          "col_photo_trumpet3","word_belt","word_cake","word_candle","word_cannon","word_duck",
                          "word_flag","word_flower","word_giraffe","word_grapes","word_guitar","word_harp",
                          "word_lamp","word_leaf","word_mitten","word_monkey","word_onion","word_peanut",
                          "word_screw","word_swan","word_whistle","word_window")

####################################################################################################################
##                                                                                                                ##
##    Test data:                                                                                                  ##
##                                                                                                                ##
####################################################################################################################
    ##  Import test data:                                                         # SONA - colour + grey (v123):
    test_files <- c("./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-7jjs.csv",     # Grey - A - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-z4vm.csv",     # Grey - A - RFBG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-7l32.csv",     # Grey - B - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-fniu.csv",     # Grey - B - RFBG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-3bwq.csv",     # Grey - C - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-zkjc.csv",     # Grey - C - RFBG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-q6iu.csv",     # Colour - A - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-elbt.csv",     # Colour - A - RFBG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-xfoj.csv",     # Colour - B - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-hkci.csv",     # Colour - B - RFBG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-kckb.csv",     # Colour - C - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v123_task-6jyy.csv",     # Colour - C - RFBG
                                                                                  # --
                                                                                  # Prolific - colour (v127):
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_task-q6iu.csv",     # Colour - A - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_task-elbt.csv",     # Colour - A - RFBG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_task-xfoj.csv",     # Colour - B - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_task-hkci.csv",     # Colour - B - RFBG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_task-kckb.csv",     # Colour - C - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v127_task-6jyy.csv",     # Colour - C - RFBG
                                                                                  # --
                                                                                  # Prolific - colour (v128):
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_task-q6iu.csv",     # Colour - A - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_task-elbt.csv",     # Colour - A - RFBG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_task-xfoj.csv",     # Colour - B - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_task-hkci.csv",     # Colour - B - RFBG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_task-kckb.csv",     # Colour - C - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v128_task-6jyy.csv",     # Colour - C - RFBG
                                                                                  # --
                                                                                  # Prolific - grey (v131):
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_task-7jjs.csv",     # Grey - A - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_task-z4vm.csv",     # Grey - A - RFBG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_task-7l32.csv",     # Grey - B - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_task-fniu.csv",     # Grey - B - RFBG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_task-3bwq.csv",     # Grey - C - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_10169-v131_task-zkjc.csv",     # Grey - C - RFBG                  
                                                                                  # --
                                                                                  # Hanover - grey (v4):
                    "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_task-7jjs.csv",       # Grey - A - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_task-z4vm.csv",       # Grey - A - RFBG
                    "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_task-7l32.csv",       # Grey - B - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_task-fniu.csv",       # Grey - B - RFBG
                    "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_task-3bwq.csv",       # Grey - C - RFG
                    "./resources/raw_data/experiment_3_and_4/data_exp_19134-v4_task-zkjc.csv")       # Grey - C - RFBG
    
    
##  Create raw df from the above files, but only get the following columns:
    test_data <- map_dfr(test_files,~read_csv(.x, col_types = cols_only("Participant Private ID" = 'c',
                                                                        "Participant Public ID"='c',
                                                                        "Experiment Version"='c',
                                                                        "Task Name" = 'c',
                                                                        "Screen Name" = 'c',
                                                                        "randomiser-hr9o" = 'c',
                                                                        "randomiser-r7fb" = 'c',
                                                                        "stim" = 'c', 
                                                                        "Response" = 'c', 
                                                                        "Reaction Time" = col_double()))) %>%
##  Merge columns that contain the same type of data, but were originally split into different columns:
        unite(study_list,  "randomiser-hr9o", "randomiser-r7fb", remove = TRUE, na.rm = TRUE) %>% 
##  Rename some columns:    
        rename(id = "Participant Private ID", prolific_id = "Participant Public ID", exp_ver = "Experiment Version",
               test_list = "Task Name", screen = "Screen Name", response = "Response", rt = "Reaction Time") %>%
##  Reorder columns:    
        select(id, prolific_id, exp_ver, study_list, test_list, screen, stim, response, rt) %>%
##  Set participant ID as the grouping variable, and arrange data by participant ID:
        group_by(id) %>%
        arrange(id) %>%
##  Remove empty / unimportant rows:
        drop_na(screen) %>%
        filter(screen != "check") %>% 
        filter(screen != "Screen 1") %>% 
        filter(screen != "Fixation") %>% 
        filter(response != "old.png") %>%
##  Tidy up responses for clarity:
        mutate_all(., tolower) %>%
        mutate(study_list = str_remove_all(study_list, "[^0-9]+")) %>%
        mutate(stim = str_remove_all(stim, ".png")) %>%
        mutate(response = str_remove_all(response, ".png")) %>%
        mutate(test_list = str_remove_all(test_list, "^(.*?) ")) %>%
        mutate(stim = str_replace(stim, "line", "drawing")) %>%
        separate(test_list, c("resp_option", "test_list", "col_or_grey"), sep = "([_?:])") %>%
        arrange(id, response, stim)
##  Remove filler responses:
    filler_stim <- c("word_chisel", "word_dress", "grey_drawing_pitcher", "col_drawing_pitcher",
                     "grey_drawing_ruler", "col_drawing_ruler", "grey_drawing_turtle",
                     "col_drawing_turtle", "grey_photo_bicycle1", "col_photo_bicycle1", 
                     "grey_photo_donkey3", "col_photo_donkey3", "grey_photo_dresser3",
                     "col_photo_dresser3")
    test_data <- test_data %>%
        filter(!stim %in% filler_stim)
    
####################################################################################################################
##                                                                                                                ##
##    Hit and Miss calculations:                                                                                  ##
##                                                                                                                ##
####################################################################################################################
##  Define our own function that calculates hit and miss totals. 
    hit_and_miss_calc_function <- function(x){
    ##  Count general totals:
        x <- x %>%
            add_tally(response != "new", sort = FALSE, name = "total_hits") %>%
            add_tally(response == "new", sort = FALSE, name = "total_miss") %>%
            add_tally(response == "recollection", sort = FALSE, name = "r_hit") %>%
            add_tally(response == "familiarity", sort = FALSE, name = "f_hit") %>%
            add_tally(response == "both", sort = FALSE, name = "b_hit") %>%
            add_tally(response == "guessing", sort = FALSE, name = "g_hit") %>%
    ##  Count stim-format totals:
            add_tally(str_detect(stim, "^word") & response != "new", sort = FALSE, name = "total_word_hit") %>%
            add_tally(str_detect(stim, "^word") & response == "new", sort = FALSE, name = "total_word_miss") %>%
            add_tally((str_detect(stim, "^grey_drawing") | str_detect(stim, "^col_drawing"))
                      & response != "new", sort = FALSE, name = "total_drawing_hit") %>%
            add_tally((str_detect(stim, "^grey_drawing") | str_detect(stim, "^col_drawing"))
                      & response == "new", sort = FALSE, name = "total_drawing_miss") %>%
            add_tally((str_detect(stim, "^grey_photo") | str_detect(stim, "^col_photo"))
                      & response != "new", sort = FALSE, name = "total_photo_hit") %>%
            add_tally((str_detect(stim, "^grey_photo") | str_detect(stim, "^col_photo"))
                      & response == "new", sort = FALSE, name = "total_photo_miss") %>%
    ##  Count stim-format totals by response-option: 
            add_tally(str_detect(stim, "^word") & response == "recollection", sort = FALSE, name = "word_hit_rec") %>%
            add_tally(str_detect(stim, "^word") & response == "familiarity", sort = FALSE, name = "word_hit_fam") %>%
            add_tally(str_detect(stim, "^word") & response == "both", sort = FALSE, name = "word_hit_both") %>%
            add_tally(str_detect(stim, "^word") & response == "guessing", sort = FALSE, name = "word_hit_guess") %>%
            add_tally((str_detect(stim, "^grey_drawing") | str_detect(stim, "^col_drawing"))
                      & response == "recollection", sort = FALSE, name = "drawing_hit_rec") %>%
            add_tally((str_detect(stim, "^grey_drawing") | str_detect(stim, "^col_drawing"))
                      & response == "familiarity", sort = FALSE, name = "drawing_hit_fam") %>%
            add_tally((str_detect(stim, "^grey_drawing") | str_detect(stim, "^col_drawing"))
                      & response == "both", sort = FALSE, name = "drawing_hit_both") %>%
            add_tally((str_detect(stim, "^grey_drawing") | str_detect(stim, "^col_drawing"))
                      & response == "guessing", sort = FALSE, name = "drawing_hit_guess") %>%
            add_tally((str_detect(stim, "^grey_photo") | str_detect(stim, "^col_photo"))
                      & response == "recollection", sort = FALSE, name = "photo_hit_rec") %>%
            add_tally((str_detect(stim, "^grey_photo") | str_detect(stim, "^col_photo"))
                      & response == "familiarity", sort = FALSE, name = "photo_hit_fam") %>%
            add_tally((str_detect(stim, "^grey_photo") | str_detect(stim, "^col_photo"))
                      & response == "both", sort = FALSE, name = "photo_hit_both") %>%
            add_tally((str_detect(stim, "^grey_photo") | str_detect(stim, "^col_photo"))
                      & response == "guessing", sort = FALSE, name = "photo_hit_guess")
    }
####################################################################################################################   
##  Filter 'test_data' by each study list, one-at-a-time, resulting in x12 df (x6 grey + x6 col).                 ##
##  For each, run our function that calculates the hit and miss totals, then rejoin into one df.                  ##
####################################################################################################################
##                                                                                                                ##
##    Study 1 - Grey:                                                                                             ##
##                                                                                                                ##
####################################################################################################################
    hit_miss_study_1_grey <- test_data %>%
      filter(study_list == "1" & col_or_grey == "grey") %>%     # Lures are still here after this step.
      filter(stim %in% study_1_grey_list) %>%                   # Remove lures (new) items.
      hit_and_miss_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 2 - Grey:                                                                                             ##
##                                                                                                                ##
####################################################################################################################
    hit_miss_study_2_grey <- test_data %>%
        filter(study_list == "2" & col_or_grey == "grey") %>%
        filter(stim %in% study_2_grey_list) %>%
        hit_and_miss_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 3 - Grey:                                                                                             ##
##                                                                                                                ##
####################################################################################################################
    hit_miss_study_3_grey <- test_data %>%
        filter(study_list == "3" & col_or_grey == "grey") %>%
        filter(stim %in% study_3_grey_list) %>%
        hit_and_miss_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 4 - Grey:                                                                                             ##
##                                                                                                                ##
####################################################################################################################
    hit_miss_study_4_grey <- test_data %>%
        filter(study_list == "4" & col_or_grey == "grey") %>%
        filter(stim %in% study_4_grey_list) %>%
        hit_and_miss_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 5 - Grey:                                                                                             ##
##                                                                                                                ##
####################################################################################################################
    hit_miss_study_5_grey <- test_data %>%
        filter(study_list == "5" & col_or_grey == "grey") %>%
        filter(stim %in% study_5_grey_list) %>%
        hit_and_miss_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 6 - Grey:                                                                                             ##
##                                                                                                                ##
####################################################################################################################
    hit_miss_study_6_grey <- test_data %>%
        filter(study_list == "6" & col_or_grey == "grey") %>%
        filter(stim %in% study_6_grey_list) %>%
        hit_and_miss_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 1 - Colour:                                                                                           ##
##                                                                                                                ##
####################################################################################################################
    hit_miss_study_1_col <- test_data %>%
        filter(study_list == "1" & col_or_grey == "col") %>%
        filter(stim %in% study_1_col_list) %>%
      hit_and_miss_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 2 - Colour:                                                                                           ##
##                                                                                                                ##
####################################################################################################################
    hit_miss_study_2_col <- test_data %>%
        filter(study_list == "2" & col_or_grey == "col") %>%
        filter(stim %in% study_2_col_list) %>%
        hit_and_miss_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 3 - Colour:                                                                                           ##
##                                                                                                                ##
####################################################################################################################
    hit_miss_study_3_col <- test_data %>%
        filter(study_list == "3" & col_or_grey == "col") %>%
        filter(stim %in% study_3_col_list) %>%
        hit_and_miss_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 4 - Colour:                                                                                           ##
##                                                                                                                ##
####################################################################################################################
    hit_miss_study_4_col <- test_data %>%
        filter(study_list == "4" & col_or_grey == "col") %>%
        filter(stim %in% study_4_col_list) %>%
        hit_and_miss_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 5 - Colour:                                                                                           ##
##                                                                                                                ##
####################################################################################################################
    hit_miss_study_5_col <- test_data %>%
        filter(study_list == "5" & col_or_grey == "col") %>%
        filter(stim %in% study_5_col_list) %>%
        hit_and_miss_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 6 - Colour:                                                                                           ##
##                                                                                                                ##
####################################################################################################################
    hit_miss_study_6_col <- test_data %>%
        filter(study_list == "6" & col_or_grey == "col") %>%
        filter(stim %in% study_6_col_list) %>%
        hit_and_miss_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Combine into one df:                                                                                        ##
##                                                                                                                ##
####################################################################################################################
    hit_and_miss <- bind_rows(hit_miss_study_1_grey, hit_miss_study_2_grey, hit_miss_study_3_grey,
                              hit_miss_study_4_grey, hit_miss_study_5_grey, hit_miss_study_6_grey,
                              hit_miss_study_1_col, hit_miss_study_2_col, hit_miss_study_3_col,
                              hit_miss_study_4_col, hit_miss_study_5_col, hit_miss_study_6_col) %>%
##  Merge multiple rows into one (per participant):
        summarise_all(coalesce_by_column) %>%
##  Remove redundant rows: 
        select(-screen, -stim, -response, -rt)

####################################################################################################################
##                                                                                                                ##
##    FA and CR calculations:                                                                                     ##
##                                                                                                                ##
####################################################################################################################
##  Define our own function that calculates FA and CR totals. 
    FA_and_CR_calc_function <- function(x){
    ##  Count general totals:
        x <- x %>%
    ##  Count general totals:
            add_tally(response != "new", sort = FALSE, name = "total_FA") %>%
            add_tally(response == "new", sort = FALSE, name = "total_CR") %>%
            add_tally(response == "recollection", sort = FALSE, name = "r_FA") %>%
            add_tally(response == "familiarity", sort = FALSE, name = "f_FA") %>%
            add_tally(response == "both", sort = FALSE, name = "b_FA") %>%
            add_tally(response == "guessing", sort = FALSE, name = "g_FA") %>%   
    ##  Count stim-format totals:
            add_tally(str_detect(stim, "^word") & response != "new", sort = FALSE, name = "total_word_FA") %>%
            add_tally(str_detect(stim, "^word") & response == "new", sort = FALSE, name = "total_word_CR") %>%
            add_tally((str_detect(stim, "^grey_drawing") | str_detect(stim, "^col_drawing"))
                      & response != "new", sort = FALSE, name = "total_drawing_FA") %>%
            add_tally((str_detect(stim, "^grey_drawing") | str_detect(stim, "^col_drawing"))
                      & response == "new", sort = FALSE, name = "total_drawing_CR") %>%
            add_tally((str_detect(stim, "^grey_photo") | str_detect(stim, "^col_photo"))
                      & response != "new", sort = FALSE, name = "total_photo_FA") %>%
            add_tally((str_detect(stim, "^grey_photo") | str_detect(stim, "^col_photo"))
                      & response == "new", sort = FALSE, name = "total_photo_CR") %>%
    ##  Count stim-format totals by response-option: 
            add_tally(str_detect(stim, "^word") & response == "recollection", sort = FALSE, name = "word_FA_rec") %>%
            add_tally(str_detect(stim, "^word") & response == "familiarity", sort = FALSE, name = "word_FA_fam") %>%
            add_tally(str_detect(stim, "^word") & response == "both", sort = FALSE, name = "word_FA_both") %>%
            add_tally(str_detect(stim, "^word") & response == "guessing", sort = FALSE, name = "word_FA_guess") %>%
            add_tally((str_detect(stim, "^grey_drawing") | str_detect(stim, "^col_drawing"))
                      & response == "recollection", sort = FALSE, name = "drawing_FA_rec") %>%
            add_tally((str_detect(stim, "^grey_drawing") | str_detect(stim, "^col_drawing"))
                      & response == "familiarity", sort = FALSE, name = "drawing_FA_fam") %>%
            add_tally((str_detect(stim, "^grey_drawing") | str_detect(stim, "^col_drawing"))
                      & response == "both", sort = FALSE, name = "drawing_FA_both") %>%
            add_tally((str_detect(stim, "^grey_drawing") | str_detect(stim, "^col_drawing"))
                      & response == "guessing", sort = FALSE, name = "drawing_FA_guess") %>%
            add_tally((str_detect(stim, "^grey_photo") | str_detect(stim, "^col_photo"))
                      & response == "recollection", sort = FALSE, name = "photo_FA_rec") %>%
            add_tally((str_detect(stim, "^grey_photo") | str_detect(stim, "^col_photo"))
                      & response == "familiarity", sort = FALSE, name = "photo_FA_fam") %>%
            add_tally((str_detect(stim, "^grey_photo") | str_detect(stim, "^col_photo"))
                      & response == "both", sort = FALSE, name = "photo_FA_both") %>%
            add_tally((str_detect(stim, "^grey_photo") | str_detect(stim, "^col_photo"))
                      & response == "guessing", sort = FALSE, name = "photo_FA_guess")
    }
#################################################################################################################### 
##  Filter 'test_data' by each study list, one-at-a-time, resulting in x12 df (x6 grey + x6 col).                 ##
##  For each, run our function that calculates the FA and CR totals, then rejoin into one df.                     ##
####################################################################################################################
##                                                                                                                ##
##    Study 1 - Grey:                                                                                             ##
##                                                                                                                ##
####################################################################################################################
      FA_CR_study_1_grey <- test_data %>%
        filter(study_list == "1" & col_or_grey == "grey") %>%
        filter(stim %in% study_4_grey_list) %>%
        FA_and_CR_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 2 - Grey:                                                                                             ##
##                                                                                                                ##
####################################################################################################################
    FA_CR_study_2_grey <- test_data %>%
        filter(study_list == "2" & col_or_grey == "grey") %>%
        filter(stim %in% study_5_grey_list) %>%
        FA_and_CR_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 3 - Grey:                                                                                             ##
##                                                                                                                ##
####################################################################################################################
    FA_CR_study_3_grey <- test_data %>%
        filter(study_list == "3" & col_or_grey == "grey") %>%
        filter(stim %in% study_6_grey_list) %>%
        FA_and_CR_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 4 - Grey:                                                                                             ##
##                                                                                                                ##
####################################################################################################################
    FA_CR_study_4_grey <- test_data %>%
        filter(study_list == "4" & col_or_grey == "grey") %>%
        filter(stim %in% study_1_grey_list) %>%
        FA_and_CR_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 5 - Grey:                                                                                             ##
##                                                                                                                ##
####################################################################################################################
    FA_CR_study_5_grey <- test_data %>%
        filter(study_list == "5" & col_or_grey == "grey") %>%
        filter(stim %in% study_2_grey_list) %>%
        FA_and_CR_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 6 - Grey:                                                                                             ##
##                                                                                                                ##
####################################################################################################################
    FA_CR_study_6_grey <- test_data %>%
        filter(study_list == "6" & col_or_grey == "grey") %>%
        filter(stim %in% study_3_grey_list) %>%
        FA_and_CR_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 1 - Colour:                                                                                           ##
##                                                                                                                ##
####################################################################################################################
    FA_CR_study_1_col <- test_data %>%
        filter(study_list == "1" & col_or_grey == "col") %>%
        filter(stim %in% study_4_col_list) %>%
        FA_and_CR_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 2 - Colour:                                                                                           ##
##                                                                                                                ##
####################################################################################################################
    FA_CR_study_2_col <- test_data %>%
        filter(study_list == "2" & col_or_grey == "col") %>%
        filter(stim %in% study_5_col_list) %>%
        FA_and_CR_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 3 - Colour:                                                                                           ##
##                                                                                                                ##
####################################################################################################################
    FA_CR_study_3_col <- test_data %>%
        filter(study_list == "3" & col_or_grey == "col") %>%
        filter(stim %in% study_6_col_list) %>%
        FA_and_CR_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 4 - Colour:                                                                                           ##
##                                                                                                                ##
####################################################################################################################
    FA_CR_study_4_col <- test_data %>%
      filter(study_list == "4" & col_or_grey == "col") %>%
      filter(stim %in% study_1_col_list) %>%
      FA_and_CR_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 5 - Colour:                                                                                           ##
##                                                                                                                ##
####################################################################################################################
    FA_CR_study_5_col <- test_data %>%
        filter(study_list == "5" & col_or_grey == "col") %>%
        filter(stim %in% study_2_col_list) %>%
        FA_and_CR_calc_function()
####################################################################################################################
##                                                                                                                ##
##    Study 6 - Colour:                                                                                           ##
##                                                                                                                ##
####################################################################################################################
    FA_CR_study_6_col <- test_data %>%
        filter(study_list == "6" & col_or_grey == "col") %>%
        filter(stim %in% study_3_col_list) %>%
        FA_and_CR_calc_function()
##  Combine into one df:
    FA_and_CR <- bind_rows(FA_CR_study_1_grey, FA_CR_study_2_grey, FA_CR_study_3_grey,
                           FA_CR_study_4_grey, FA_CR_study_5_grey, FA_CR_study_6_grey,
                           FA_CR_study_1_col, FA_CR_study_2_col, FA_CR_study_3_col,
                           FA_CR_study_4_col, FA_CR_study_5_col, FA_CR_study_6_col) %>%
##  Merge multiple rows into one (per participant):
        summarise_all(coalesce_by_column) %>%
##  Remove redundant rows: 
        select(-screen, -stim, -response, -rt)

####################################################################################################################
##                                                                                                                ##
##    Proportions, z-scores, d', c:                                                                               ##
##                                                                                                                ##
####################################################################################################################
##  Join 'hit_and_miss' and 'FA_and_CR' dfs:
    test_stats <- hit_and_miss %>%
        right_join(FA_and_CR) %>%
##  Calculate hit proportions:
####################################################################################################################
##                                                                                                                ##
##    Words:                                                                                                      ##
##                                                                                                                ##
####################################################################################################################
    # Proportion of word hits: total number of word items (word hits + word miss) / word hits:
        mutate(prop_word_hit = total_word_hit / (total_word_hit + total_word_miss)) %>%
    # Proportion of total_word misses: total number of total_word items
      # (total_word hits + total_word miss) / total_word misses:
        mutate(prop_word_miss = total_word_miss / (total_word_hit + total_word_miss)) %>%
    # Out of all total_word hits, what proportion were Rec:
        mutate(prop_word_hit_rec = word_hit_rec / total_word_hit) %>%
    # Out of all total_word hits, what proportion were Fam:
        mutate(prop_word_hit_fam = word_hit_fam / total_word_hit) %>%
    # Out of all total_word hits, what proportion were Both:
        mutate(prop_word_hit_both = word_hit_both / total_word_hit) %>%
    # Out of all total_word hits, what proportion were Guessing:
        mutate(prop_word_hit_guess = word_hit_guess / total_word_hit) %>%
    # Out of all total_word hits, what proportion were Rec (including Both responses):
        mutate(prop_word_hit_rec_total = prop_word_hit_rec + prop_word_hit_both) %>%
    # Out of all total_word hits, what proportion were Fam (including Both responses):
        mutate(prop_word_hit_fam_total = prop_word_hit_fam + prop_word_hit_both) %>%
####################################################################################################################
##                                                                                                                ##
##    Drawings:                                                                                                   ##
##                                                                                                                ##
####################################################################################################################
    # Proportion of drawing hits: total number of drawing items (drawing hits + drawing miss) / drawing hits:
        mutate(prop_drawing_hit = total_drawing_hit / (total_drawing_hit + total_drawing_miss)) %>%
    # Proportion of total_drawing misses: total number of total_drawing items 
      # (total_drawing hits + total_drawing miss) / total_drawing misses:
        mutate(prop_drawing_miss = total_drawing_miss / (total_drawing_hit + total_drawing_miss)) %>%
    # Out of all total_drawing hits, what proportion were Rec:
        mutate(prop_drawing_hit_rec = drawing_hit_rec / total_drawing_hit) %>%
    # Out of all total_drawing hits, what proportion were Fam:
        mutate(prop_drawing_hit_fam = drawing_hit_fam / total_drawing_hit) %>%
    # Out of all total_drawing hits, what proportion were Both:
        mutate(prop_drawing_hit_both = drawing_hit_both / total_drawing_hit) %>%
    # Out of all total_drawing hits, what proportion were Guessing:
        mutate(prop_drawing_hit_guess = drawing_hit_guess / total_drawing_hit) %>%
    # Out of all total_drawing hits, what proportion were Rec (including Both responses):
        mutate(prop_drawing_hit_rec_total = prop_drawing_hit_rec + prop_drawing_hit_both) %>%
    # Out of all total_drawing hits, what proportion were Fam (including Both responses):
        mutate(prop_drawing_hit_fam_total = prop_drawing_hit_fam + prop_drawing_hit_both) %>%
####################################################################################################################
##                                                                                                                ##
##    Photos:                                                                                                     ##
##                                                                                                                ##
#################################################################################################################### 
    # Proportion of photo hits: total number of photo items (photo hits + photo miss) / photo hits:
        mutate(prop_photo_hit = total_photo_hit / (total_photo_hit + total_photo_miss)) %>%
    # Proportion of total_photo misses: total number:. 
        mutate(prop_photo_miss = total_photo_miss / (total_photo_hit + total_photo_miss)) %>%
    # Out of all total_photo hits, what proportion were Rec:
        mutate(prop_photo_hit_rec = photo_hit_rec / total_photo_hit) %>%
    # Out of all total_photo hits, what proportion were Fam:
        mutate(prop_photo_hit_fam = photo_hit_fam / total_photo_hit) %>%
    # Out of all total_photo hits, what proportion were Both:
        mutate(prop_photo_hit_both = photo_hit_both / total_photo_hit) %>%
    # Out of all total_photo hits, what proportion were Guessing:
        mutate(prop_photo_hit_guess = photo_hit_guess / total_photo_hit) %>%
    # Out of all total_photo hits, what proportion were Rec (including Both responses):
        mutate(prop_photo_hit_rec_total = prop_photo_hit_rec + prop_photo_hit_both) %>%
    # Out of all total_photo hits, what proportion were Fam (including Both responses):
        mutate(prop_photo_hit_fam_total = prop_photo_hit_fam + prop_photo_hit_both) %>%
####################################################################################################################
##                                                                                                                ##
##    Calculate FA proportions:                                                                                   ##
##                                                                                                                ##
####################################################################################################################
####################################################################################################################
##                                                                                                                ##
##    Words:                                                                                                      ##
##                                                                                                                ##
####################################################################################################################
    # Proportion of word FAs: total number of word items (word FAs + word CR) / word FAs:    
        mutate(prop_word_FA = total_word_FA / (total_word_FA + total_word_CR)) %>%
    # Proportion of total_word CRs: total number of total_word items
      # (total_word FAs + total_word CR) / total_word CRs:
        mutate(prop_word_CR = total_word_CR / (total_word_FA + total_word_CR)) %>%
    # Out of all total_word FAs, what proportion were Rec:
        mutate(prop_word_FA_rec = word_FA_rec / total_word_FA) %>%
    # Out of all total_word FAs, what proportion were Fam:
        mutate(prop_word_FA_fam = word_FA_fam / total_word_FA) %>%
    # Out of all total_word FAs, what proportion were Both:
        mutate(prop_word_FA_both = word_FA_both / total_word_FA) %>%
    # Out of all total_word FAs, what proportion were Guessing:
        mutate(prop_word_FA_guess = word_FA_guess / total_word_FA) %>%
    # Replace nan with 0:   
        mutate_at(vars(prop_word_FA_rec, prop_word_FA_fam, prop_word_FA_both, prop_word_FA_guess), 
                  ~replace(., is.nan(.), 0)) %>%
    # Out of all total_word FAs, what proportion were Rec (including Both responses):
        mutate(prop_word_FA_rec_total = prop_word_FA_rec + prop_word_FA_both) %>%
    # Out of all total_word FAs, what proportion were Fam (including Both responses):
        mutate(prop_word_FA_fam_total = prop_word_FA_fam + prop_word_FA_both) %>%
####################################################################################################################
##                                                                                                                ##
##    Drawings:                                                                                                   ##
##                                                                                                                ##
####################################################################################################################
    # Proportion of drawing FAs: total number of drawing items (drawing FAs + drawing CR) / drawing FAs. 
        mutate(prop_drawing_FA = total_drawing_FA / (total_drawing_FA + total_drawing_CR)) %>%
    # Proportion of total_drawing CRs: total number of total_drawing items 
    # (total_drawing FAs + total_drawing CR) / total_drawing CRs. 
        mutate(prop_drawing_CR = total_drawing_CR / (total_drawing_FA + total_drawing_CR)) %>%
    # Out of all total_drawing FAs, what proportion were Rec:
        mutate(prop_drawing_FA_rec = drawing_FA_rec / total_drawing_FA) %>%
    # Out of all total_drawing FAs, what proportion were Fam:
        mutate(prop_drawing_FA_fam = drawing_FA_fam / total_drawing_FA) %>%
    # Out of all total_drawing FAs, what proportion were Both:
        mutate(prop_drawing_FA_both = drawing_FA_both / total_drawing_FA) %>%
    # Out of all total_drawing FAs, what proportion were Guessing:
        mutate(prop_drawing_FA_guess = drawing_FA_guess / total_drawing_FA) %>%
    # Replace nan with 0:
        mutate_at(vars(prop_drawing_FA_rec, prop_drawing_FA_fam, prop_drawing_FA_both, prop_drawing_FA_guess), 
                  ~replace(., is.nan(.), 0)) %>%
    # Out of all total_drawing FAs, what proportion were Rec (including Both responses):
      mutate(prop_drawing_FA_rec_total = prop_drawing_FA_rec + prop_drawing_FA_both) %>%
    # Out of all total_drawing FAs, what proportion were Fam (including Both responses):
        mutate(prop_drawing_FA_fam_total = prop_drawing_FA_fam + prop_drawing_FA_both) %>%
###################################################################################################################
##                                                                                                               ##
##    Photos:                                                                                                    ##
##                                                                                                               ##
################################################################################################################### 
    # Proportion of photo FAs: total number of photo items (photo FAs + photo CR) / photo FAs:
        mutate(prop_photo_FA = total_photo_FA / (total_photo_FA + total_photo_CR)) %>%
    # Proportion of total_photo CRs: total number of total_photo items
    # (total_photo FAs + total_photo CR) / total_photo CRs:
        mutate(prop_photo_CR = total_photo_CR / (total_photo_FA + total_photo_CR)) %>%
    # Out of all total_photo FAs, what proportion were Rec:
        mutate(prop_photo_FA_rec = photo_FA_rec / total_photo_FA) %>%
    # Out of all total_photo FAs, what proportion were Fam:
        mutate(prop_photo_FA_fam = photo_FA_fam / total_photo_FA) %>%
    # Out of all total_photo FAs, what proportion were Both:
        mutate(prop_photo_FA_both = photo_FA_both / total_photo_FA) %>%
    # Out of all total_photo FAs, what proportion were Guessing:
        mutate(prop_photo_FA_guess = photo_FA_guess / total_photo_FA) %>%
    # Replace nan with 0:
        mutate_at(vars(prop_photo_FA_rec, prop_photo_FA_fam, prop_photo_FA_both, prop_photo_FA_guess), 
                  ~replace(., is.nan(.), 0)) %>%
    # Out of all total_photo FAs, what proportion were Rec (including Both responses):
        mutate(prop_photo_FA_rec_total = prop_photo_FA_rec + prop_photo_FA_both) %>%
    # Out of all total_photo FAs, what proportion were Fam (including Both responses):
        mutate(prop_photo_FA_fam_total = prop_photo_FA_fam + prop_photo_FA_both) %>%
      
##  Calculate overall recognition:
    # HITS - FAs = overall measure of recognitionL
        mutate(photo_recog = prop_photo_hit - prop_photo_FA) %>%
        mutate(drawing_recog = prop_drawing_hit - prop_drawing_FA) %>%
        mutate(word_recog = prop_word_hit - prop_word_FA) %>%
##  Classic z-score calculations (take Ps score, subtract the mean, and divide the difference by the SD). 
        #mutate(classic_z_hit_word = (total_word_hit - mean(total_word_hit)) / sd(total_word_hit)) %>%
        #mutate(classic_z_FA_word = (total_word_FA - mean(total_word_FA)) / sd(total_word_FA)) %>%
        #mutate(classic_z_hit_drawing = (total_drawing_hit - mean(total_drawing_hit)) / sd(total_drawing_hit)) %>%
        #mutate(classic_z_FA_drawing = (total_drawing_FA - mean(total_drawing_FA)) / sd(total_drawing_FA)) %>%
        #mutate(classic_z_hit_photo = (total_photo_hit - mean(total_photo_hit)) / sd(total_photo_hit)) %>%
        #mutate(classic_z_FA_photo = (total_photo_FA - mean(total_photo_FA)) / sd(total_photo_FA)) %>%
##  z-scores (how we previously calculated them in Excel (=NORMSINV((ES8+0.5) / SUM(ES8:ET8,1)). "qnorm" is the r equivelant of "=NORMSINV": Inverse of the standard normal cumulative distribution, with a probability of x (the value we calculated).):
        mutate("z_total_word_hit" = qnorm((total_word_hit + 0.5) / 
                                            (total_word_hit + total_word_miss + 1))) %>%
        mutate("z_total_word_FA" = qnorm((total_word_FA + 0.5) / 
                                           (total_word_FA + total_word_CR + 1))) %>%         
        mutate("z_total_drawing_hit" = qnorm((total_drawing_hit + 0.5) / 
                                               (total_drawing_hit + total_drawing_miss + 1))) %>%
        mutate("z_total_drawing_FA" = qnorm((total_drawing_FA + 0.5) / 
                                              (total_drawing_FA + total_drawing_CR + 1))) %>%    
        mutate("z_total_photo_hit" = qnorm((total_photo_hit + 0.5) / 
                                             (total_photo_hit + total_photo_miss + 1))) %>%
        mutate("z_total_photo_FA" = qnorm((total_photo_FA + 0.5) / 
                                            (total_photo_FA + total_photo_CR + 1))) %>%
##  Word accuracy:
        mutate(word_accuracy_rec_raw = word_hit_rec / (word_hit_rec + word_FA_rec)) %>%
        mutate(word_accuracy_fam_raw = word_hit_fam / (word_hit_fam + word_FA_fam)) %>%
        mutate(word_accuracy_both_raw = word_hit_both / (word_hit_both + word_FA_both)) %>%
        mutate(word_accuracy_guessing_raw = word_hit_guess / (word_hit_guess + word_FA_guess)) %>%
##  Drawing accuracy:
        mutate(drawing_accuracy_rec_raw = drawing_hit_rec / (drawing_hit_rec + drawing_FA_rec)) %>%
        mutate(drawing_accuracy_fam_raw = drawing_hit_fam / (drawing_hit_fam + drawing_FA_fam)) %>%
        mutate(drawing_accuracy_both_raw = drawing_hit_both / (drawing_hit_both + drawing_FA_both)) %>%
        mutate(drawing_accuracy_guessing_raw = drawing_hit_guess / (drawing_hit_guess + drawing_FA_guess)) %>%
##  Photo accuracy:
        mutate(photo_accuracy_rec_raw = photo_hit_rec / (photo_hit_rec + photo_FA_rec)) %>%
        mutate(photo_accuracy_fam_raw = photo_hit_fam / (photo_hit_fam + photo_FA_fam)) %>%
        mutate(photo_accuracy_both_raw = photo_hit_both / (photo_hit_both + photo_FA_both)) %>%
        mutate(photo_accuracy_guessing_raw = photo_hit_guess / (photo_hit_guess + photo_FA_guess))
##  RFG accuracy (have to create seperate dfs to calculate, then rejoin with 'test_stats':
    rfg_accuracy_totals <- test_stats %>%
        filter(resp_option == "rfg") %>%
        mutate(photo_accuracy_rec_total = photo_accuracy_rec_raw) %>%
        mutate(photo_accuracy_fam_total = photo_accuracy_fam_raw) %>%
        mutate(drawing_accuracy_rec_total = drawing_accuracy_rec_raw) %>%
        mutate(drawing_accuracy_fam_total = drawing_accuracy_fam_raw) %>%
        mutate(word_accuracy_rec_total = word_accuracy_rec_raw) %>%
        mutate(word_accuracy_fam_total = word_accuracy_fam_raw) %>%
        select(id, photo_accuracy_rec_total, photo_accuracy_fam_total, 
               drawing_accuracy_rec_total, drawing_accuracy_fam_total,
               word_accuracy_rec_total, word_accuracy_fam_total)
##  RFBG accuracy totals:
    rfbg_accuracy_totals <- test_stats %>%
        filter(resp_option == "rfbg") %>%
        mutate(photo_accuracy_rec_total = (photo_hit_rec + photo_hit_both) / 
              (photo_hit_rec + photo_hit_both + photo_FA_rec + photo_FA_both)) %>%
        mutate(photo_accuracy_fam_total = (photo_hit_fam + photo_hit_both) /
                 (photo_hit_fam + photo_hit_both + photo_FA_fam + photo_FA_both)) %>%
        mutate(drawing_accuracy_rec_total = (drawing_hit_rec + drawing_hit_both) / 
                 (drawing_hit_rec + drawing_hit_both + drawing_FA_rec + drawing_FA_both)) %>%
        mutate(drawing_accuracy_fam_total = (drawing_hit_fam + drawing_hit_both) /
                 (drawing_hit_fam + drawing_hit_both + drawing_FA_fam + drawing_FA_both)) %>%
        mutate(word_accuracy_rec_total = (word_hit_rec + word_hit_both) / 
                 (word_hit_rec + word_hit_both + word_FA_rec + word_FA_both)) %>%
        mutate(word_accuracy_fam_total = (word_hit_fam + word_hit_both) /
                 (word_hit_fam + word_hit_both + word_FA_fam + word_FA_both)) %>%
        select(id, photo_accuracy_rec_total, photo_accuracy_fam_total, drawing_accuracy_rec_total,
               drawing_accuracy_fam_total, word_accuracy_rec_total, word_accuracy_fam_total)
##  Join accuracy totals together, and add to "grey_calculations" df: 
    accuracy_totals <- bind_rows(rfg_accuracy_totals, rfbg_accuracy_totals)
    test_stats <- test_stats %>%
        right_join(accuracy_totals) %>%
##  d'prime (calculated in the same way as we did previously in Excel):
        mutate("old_word_d_prime" = z_total_word_hit - z_total_word_FA) %>%
        mutate("old_drawing_d_prime" = z_total_drawing_hit - z_total_drawing_FA) %>%
        mutate("old_photo_d_prime" = z_total_photo_hit - z_total_photo_FA)
##  d'prime (calculated by R package):
    # List unique participant IDs to loop through:
    participant_IDs <- unique(test_stats$id)
##  word d'prime (calculated by R package):
    # Create empty df to store word dprime calculations:
        word_d_prime <- tibble()
        # Initiate for loop that iterates through participant_IDs:
          for (i in participant_IDs) {
            # Create a temporary df (that gets overwritten each time the loop iterates), with data from "test_stats":
            temp <- test_stats %>%
                # Filter "grey_calculations" data by the currently iterated participant id:
                filter(id == i) %>%     
                # Select only the columns necessary for dprime calculations:
                select(id, total_word_hit, total_word_FA, total_word_miss, total_word_CR)
            
            temp_d_prime <- (as_tibble(dprime(n_hit = temp$total_word_hit,      # Get number of hits;
                                              n_fa = temp$total_word_FA,        # Get number of FAs;
                                              n_miss = temp$total_word_miss,    # Get number of misses;
                                              n_cr = temp$total_word_CR,        # Get number of CRs;
                                              n_targets = 63,           # Number of targets (old items) is always 63;
                                              n_distractors = 63,       # Number of distractors (new items) is always 63;
                                              adjusted = TRUE))) %>%    # Adjustements for extreme values are made
                                                                        # following the recommandations of Hautus (1995).
            mutate("id" = i)                                            # Add current participant ID to "temp_d_prime"
      temp <- temp %>% inner_join(temp_d_prime, by = "id")              # join "temp" and "temp_d_prime" by id into one df                                                                         # / single row.
      word_d_prime <- bind_rows(word_d_prime, temp) }                   # Add this row to the "word_d_prime" df. Loop 
                                                                        # again, until we've gone through each P. 
    ##  Additional tidying:     
        word_d_prime <- word_d_prime %>%                                        
            select(id, dprime, beta, aprime, bppd, c) %>%                       # Select only the new columns. 
            rename(word_d_prime = "dprime", word_beta = "beta",                 # Rename these columns to reflect 
                   word_a_prime = "aprime", word_bppd = "bppd", word_c = "c")   # the stimulus format. 

##  drawing d'prime (calculated by R package):
    drawing_d_prime <- tibble()
    for (i in participant_IDs) {
        temp <- test_stats %>%
            filter(id == i) %>%
            select(id, total_drawing_hit, total_drawing_FA, total_drawing_miss, total_drawing_CR)
        temp_d_prime <- (as_tibble(dprime(n_hit = temp$total_drawing_hit,
                                          n_fa = temp$total_drawing_FA,
                                          n_miss = temp$total_drawing_miss,
                                          n_cr = temp$total_drawing_CR,
                                          n_targets = 63,
                                          n_distractors = 63,
                                          adjusted = TRUE))) %>%
              mutate("id" = i)
          temp <- temp %>% inner_join(temp_d_prime, by = "id")
          drawing_d_prime <- bind_rows(drawing_d_prime, temp) }
        ##  Additional tidying:
        drawing_d_prime <- drawing_d_prime %>%
            select(id, dprime, beta, aprime, bppd, c) %>%
            rename(drawing_d_prime = "dprime", drawing_beta = "beta", drawing_a_prime = "aprime",
                   drawing_bppd = "bppd", drawing_c = "c")
          
##  photo d'prime (calculated by R package):
    photo_d_prime <- tibble()
    for (i in participant_IDs) {
        temp <- test_stats %>%
            filter(id == i) %>%
            select(id, total_photo_hit, total_photo_FA, total_photo_miss, total_photo_CR)
        temp_d_prime <- (as_tibble(dprime(n_hit = temp$total_photo_hit,
                                          n_fa = temp$total_photo_FA,
                                          n_miss = temp$total_photo_miss,
                                          n_cr = temp$total_photo_CR,
                                          n_targets = 63,
                                          n_distractors = 63,
                                          adjusted = TRUE))) %>%
            mutate("id" = i)
        temp <- temp %>% inner_join(temp_d_prime, by = "id")
        photo_d_prime <- bind_rows(photo_d_prime, temp) }
##  Additional tidying:
    photo_d_prime <- photo_d_prime %>%
        select(id, dprime, beta, aprime, bppd, c) %>%
        rename(photo_d_prime = "dprime", photo_beta = "beta", photo_a_prime = "aprime",
               photo_bppd = "bppd", photo_c = "c")
        
##  Add new d'prime calculations to 'test_stats' df: 
    test_stats <- test_stats %>%
        right_join(word_d_prime) %>%
        right_join(drawing_d_prime) %>%
        right_join(photo_d_prime)
          
##  Merge 'participant_info' and 'test_stats' to create final tidy df: 
    final_data <- participant_info %>%
        right_join(test_stats) %>%
        arrange(col_or_grey, resp_option, prolific_id, study_list, test_list)
    
###################################################################################################################
##                                                                                                               ##
##    Apply exclusion criteria:                                                                                  ##
##                                                                                                               ##
###################################################################################################################
##  Anyone with less than 90% toward encoding questions:
    exclude1 <- final_data %>%
        filter(study_correct_percent < 90)
##  Anyone + or - 3.0 z-score for total hits:
    exclude2 <- final_data %>%
        mutate("z_total_hit" = qnorm((total_hits + 0.5) / (total_hits + total_miss + 1))) %>%
        filter(z_total_hit >= 3.0 | z_total_hit <= -3.0)
##  Anyone + or - 3.0 z-score for total FAs:
    exclude3 <- final_data %>%
        mutate("z_total_FA" = qnorm((total_FA + 0.5) / (total_FA + total_CR + 1))) %>%
        filter(z_total_FA >= 3.0 | z_total_FA <= -3.0)
##  Anyone + or - 3.0 z-score for total recognition:
    exclude4 <- final_data %>%
        mutate("prop_total_hit" = total_hits / (total_hits + total_miss)) %>%
        mutate("prop_total_FA" = total_FA / (total_FA + total_CR)) %>%
        mutate("total_recog" = prop_total_hit - prop_total_FA) %>%          # HITS - FAs = overall measure of recognition.
        mutate("z_recog" = (total_recog - mean(total_recog)) / sd(total_recog)) %>%
        filter(z_recog >= 3.0 | z_recog <= -3.0)
##  Join all to-be-excluded participants into single df:
    all_exclude <- exclude1 %>%
        bind_rows(exclude2, exclude3, exclude4)
##  Just get the id's for the to-be-excluded participants:
    p_to_exclude <- all_exclude$id
##  Remove these participants from 'final_data':
    final_data <- final_data %>%
        filter(!id %in% p_to_exclude) %>%
        mutate(resp_option = toupper(resp_option))

###################################################################################################################
##                                                                                                               ##
##    Experiment 3 (grey):                                                                                       ##
##                                                                                                               ##
###################################################################################################################
    grey_data <- final_data %>%
        filter(col_or_grey == "grey")
  write.csv(grey_data,'~/Desktop/grey_data.csv', row.names = FALSE)

###################################################################################################################
##                                                                                                               ##
##    Experiment 4 (colour):                                                                                     ##
##                                                                                                               ##
###################################################################################################################
    colour_data <- final_data %>%
        filter(col_or_grey == "col")
    write.csv(colour_data,'~/Desktop/colour_data.csv', row.names = FALSE)

###################################################################################################################
##                                                                                                               ##
##   Reaction times:                                                                                             ##
##                                                                                                               ##
###################################################################################################################
  reaction_times <- test_data %>%
    select(id, rt) %>%
    mutate(rt = as.double(rt)) %>%
    mutate(mean = mean(rt)) %>%
    distinct(id, mean) %>%
    rename(rt = "mean") %>%
    mutate(rt = round(rt, digits=-1))
  
  ggplot(reaction_times, aes(rt)) +
    geom_histogram(aes(x=rt, y=..density..), bins=20) +
    stat_function(fun=dnorm, args = list(mean=mean(reaction_times$rt), sd=sd(reaction_times$rt)), color="red")
```


Common, everyday objects will be presented in: i) word form (written in simple, black ink); ii) drawing form (line-drawn illustrations); or iii) photograph form (detail rich exemplars of the real world object). 
To our knowledge, no study has systematically matched items across a number of formats in an effort to determine the point at which stimuli distinctiveness impacts recognition. 

## Method
```{r exp3--age-gender--tablecaption, echo=FALSE, results = FALSE}
    table_numbering(name = "exp3--age-gender--tablecaption", 
                     caption = "Gender and age (*SD*) of the current sample.")
```
### Participants
A total of `r nrow(grey_data)` subjects completed the online experiment (see `r table_numbering("exp3--age-gender--tablecaption", display = "cite")` for a breakdown of the gender and age of the sample).

```{r, echo=FALSE, cache=TRUE}
  grey_age_gender <- grey_data %>%
      select(age, gender) %>%
      mutate(age = as.double(age))

  grey_age_gender_table <- tribble(
      ~"Gender", ~N, ~Age, ~SD,
      "Female",
            grey_age_gender %>% filter(gender == "female") %>% nrow(),
            grey_age_gender %>% filter(gender == "female") %>% summarise(mean(age)) %>% pull() %>% round (2),
            grey_age_gender %>% filter(gender == "female") %>% summarise(sd(age)) %>% pull() %>% round (2),
      "Male",
            grey_age_gender %>% filter(gender == "male") %>% nrow(),
            grey_age_gender %>% filter(gender == "male") %>% summarise(mean(age)) %>% pull() %>% round (2),
            grey_age_gender %>% filter(gender == "male") %>% summarise(sd(age)) %>% pull() %>% round (2),
      "Questioning",
            grey_age_gender %>% filter(gender == "questioning") %>% nrow(),
            grey_age_gender %>% filter(gender == "questioning") %>% summarise(mean(age)) %>% pull(),
            0,
      "Unspecified",
            grey_age_gender %>% filter(gender == "unspecified") %>% nrow(),
            grey_age_gender %>% filter(gender == "unspecified") %>% summarise(mean(age)) %>% pull(),
            grey_age_gender %>% filter(gender == "unspecified") %>% summarise(sd(age)) %>% pull() %>% round (2),
      "Total",
            grey_age_gender %>% nrow(),
            grey_age_gender %>% summarise(mean(age)) %>% pull() %>% round (2),
            grey_age_gender %>% summarise(sd(age)) %>% pull() %>% round (2))

    grey_participant_source <- as_tibble(grey_data$prolific_id)
    grey_participant_source <- grey_participant_source %>%
        mutate(length = str_length(value)) %>%
        mutate(source = ifelse(length == 4, "sona",
                          ifelse(length == 5, "sona",
                            ifelse(length == 6, "sona",
                              ifelse(length == 8, "hanover",
                                ifelse(length == 24, "prolific", value))))))
    
    grey_n_prolific <- nrow(grey_participant_source %>% filter(source == "prolific"))
    grey_n_prolific <- round((grey_n_prolific / nrow(grey_participant_source)) * 100, 2)
    
    grey_n_sona <- nrow(grey_participant_source %>% filter(source == "sona"))
    grey_n_sona <- round((grey_n_sona / nrow(grey_participant_source)) * 100, 2)
    
    grey_n_hanover <- nrow(grey_participant_source %>% filter(source == "hanover"))
    grey_n_hanover <- round((grey_n_hanover / nrow(grey_participant_source)) * 100, 2)
    
    grey_n_eng_lang <- nrow(grey_data %>% filter(eng_first_lang == "yes"))
    grey_n_eng_lang <- round((grey_n_eng_lang / nrow(grey_data)) * 100, 2)
```

To meet our YA requirements, all participants were required to be between 18-59 years of age (actual range: `r min(grey_data$age, na.rm = TRUE)`-`r max(grey_data$age, na.rm = TRUE)`). As our experiment involved English word stimuli, we also asked subjects whether English was their first language; the vast majority (`r grey_n_eng_lang`%) reported that English was indeed their first language.

The current sample was comprised of participants sourced from voluntary participation websites such as \href{https://www.prolific.co/}{Prolific Academic} (`r grey_n_prolific`%), where payment at the rate of £5/hr was given, and via the in-school \href{https://keelepsychology.sona-systems.com/}{research participation system} (`r grey_n_sona`%), where they received course participation credits. A small number of participants were also recruited from \href{https://psych.hanover.edu/research/exponnet.html}{Psychological Research on the Net} (`r grey_n_hanover`%). 


@rossion2004 demonstrated that naming agreement could be improved sby adding surface texture and shading
only resulted in a small improvement 
It is hypothesised that the grey photographs 


`r table_numbering("exp3--age-gender--tablecaption")`
```{r, echo=FALSE, cache=TRUE}
  grey_age_gender_table %>%
      mutate(Age = round(Age,2)) %>%
      mutate(SD = round(SD,2)) %>%
      mutate(" " = str_c("(", SD, ")")) %>%
      select(-SD) %>%
      kable("latex", booktabs = T) %>%
      kable_styling(latex_options = "hold_position") %>%
      column_spec(2, italic = TRUE) %>%
      column_spec(4, italic = TRUE) %>%
      row_spec(5, bold = TRUE)
```

\newpage
## Results
```{r, echo=FALSE, results = FALSE, message=FALSE, warning=FALSE, cache=TRUE, fig.show='hide'}
###################################################################################################################
##                                                                                                               ##
##    Experiment 3 - Analysis prep:                                                                              ##
##                                                                                                               ##
###################################################################################################################
    grey_data <- grey_data %>%  
      rename(ResponseOption = "resp_option") %>%
      mutate(age = na_if(age, 0))
```

### Overall hits, false alarms (FAs), and recognition
```{r, echo=FALSE, results = FALSE, message=FALSE, warning=FALSE, cache=TRUE, fig.show='hide'}
###################################################################################################################
##                                                                                                               ##
##    Experiment 3 - Prop hits:                                                                                  ##
##                                                                                                               ##
###################################################################################################################
## Prep data for analysis:                                               
    grey__anova__PROP.HITS_data <- grey_data %>%
        select(id, ResponseOption, prop_word_hit, prop_drawing_hit, prop_photo_hit) %>%
        rename(word = "prop_word_hit", drawing = "prop_drawing_hit", photo = "prop_photo_hit") %>%
        gather(key = "StimuliFormat", value = "hit", word, drawing, photo) %>%
        mutate_at(vars("id", "ResponseOption", "StimuliFormat"), factor) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "word", "Words")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "drawing", "Drawings")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "photo", "Photographs")) %>%
        transform(StimuliFormat = factor(StimuliFormat, levels=c("Words","Drawings","Photographs"))) %>%
        transform(ResponseOption = factor(ResponseOption, levels=c("RFG","RFBG")))
#-----------------------------------------------------------------------------------------------------------------#
##  Run 2-way mixed ANOVA:
    grey__anova__PROP.HITS <- aov_ez("id", "hit", grey__anova__PROP.HITS_data,
                                       between = "ResponseOption", within = "StimuliFormat")
    
##  Format ANOVA main effects for use in report:  
    apa__grey__anova__PROP.HITS <- papaja:::apa_print.afex_aov(grey__anova__PROP.HITS) 
        apa__grey__anova__PROP.HITS__stim.format.main.effect <- apa__grey__anova__PROP.HITS$full$StimuliFormat %>%
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
        apa__grey__anova__PROP.HITS__resp.option.main.effect <- apa__grey__anova__PROP.HITS$full$ResponseOption %>%
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
        apa__grey__anova__PROP.HITS__interaction.main.effect <- apa__grey__anova__PROP.HITS$full$ResponseOption_StimuliFormat %>%
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
#-----------------------------------------------------------------------------------------------------------------#
#  Run post-hoc contrasts                                                                                         
#-----------------------------------------------------------------------------------------------------------------#
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Response-option:  Not significant.
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Stimuli format:
    grey__anova__PROP.HITS__stim.format.means <- emmeans(grey__anova__PROP.HITS, ~ StimuliFormat)
    grey__anova__PROP.HITS__stim.format.pairwise <- pairs(grey__anova__PROP.HITS__stim.format.means)
    ##  Format pairwise results for use in report:  
        apa__grey__anova__PROP.HITS__stim.format.means <- 
          papaja:::apa_print.emmGrid(grey__anova__PROP.HITS__stim.format.means) 
        apa__grey__anova__PROP.HITS__words.mean <- 
          apa__grey__anova__PROP.HITS__stim.format.means$estimate$Words %>%
          str_remove("\\,.*")
        apa__grey__anova__PROP.HITS__drawings.mean <- 
          apa__grey__anova__PROP.HITS__stim.format.means$estimate$Drawings %>%
          str_remove("\\,.*")
        apa__grey__anova__PROP.HITS__photographs.mean <- 
          apa__grey__anova__PROP.HITS__stim.format.means$estimate$Photographs %>%
          str_remove("\\,.*")
        apa__grey__anova__PROP.HITS__stim.format.pairwise <- 
          papaja:::apa_print.emmGrid(grey__anova__PROP.HITS__stim.format.pairwise)
        
        apa__grey__anova__PROP.HITS__words.vs.drawings.pairwise <-
          apa__grey__anova__PROP.HITS__stim.format.pairwise$full$Words_Drawings %>% 
          str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
        apa__grey__anova__PROP.HITS__words.vs.photographs.pairwise <-
          apa__grey__anova__PROP.HITS__stim.format.pairwise$full$Words_Photographs %>% 
          str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
        apa__grey__anova__PROP.HITS__drawings.vs.photographs.pairwise <-
          apa__grey__anova__PROP.HITS__stim.format.pairwise$full$Drawings_Photographs %>% 
          str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Interaction:  Not significant.
#-----------------------------------------------------------------------------------------------------------------#
##  Prep data for figure:
    grey__anova__PROP.HITS__all.means <- emmeans(grey__anova__PROP.HITS, c("ResponseOption", "StimuliFormat"))
    grey__anova__PROP.HITS__figure.data <- as_tibble(grey__anova__PROP.HITS__all.means) %>%
        select(-df, -lower.CL, -upper.CL)
    
##  Prep data for table:  
    grey__anova__PROP.HITS__rfg.totals <- grey_data %>%
        filter(ResponseOption == "RFG") %>%
        mutate(total_hit = total_word_hit + total_drawing_hit + total_photo_hit) %>%
        mutate(total_FA = total_word_FA + total_drawing_FA + total_photo_FA)
    grey__anova__PROP.HITS__rfbg.totals <- grey_data %>%
        filter(ResponseOption == "RFBG") %>%
        mutate(total_hit = total_word_hit + total_drawing_hit + total_photo_hit) %>%
        mutate(total_FA = total_word_FA + total_drawing_FA + total_photo_FA)

    grey__anova__PROP.HITS__table <- tribble(
        ~"Stim", ~Hits,  ~FAs,
        "Words", mean(grey_data$prop_word_hit), mean(grey_data$prop_word_FA),
        "Drawings", mean(grey_data$prop_drawing_hit), mean(grey_data$prop_drawing_FA),
        "Photographs", mean(grey_data$prop_photo_hit), mean(grey_data$prop_photo_FA),
        "RFG",  mean(grey__anova__PROP.HITS__rfg.totals$total_hit) / 60,
                mean(grey__anova__PROP.HITS__rfg.totals$total_FA) / 60,
        "RFBG", mean(grey__anova__PROP.HITS__rfbg.totals$total_hit) / 60,
                mean(grey__anova__PROP.HITS__rfbg.totals$total_FA) / 60) %>%
        mutate_if(is.numeric, round, 2) %>%
        column_to_rownames(var = "Stim")
```

```{r exp3--prop-hits-and-FAs--tablecaption, echo=FALSE, results = FALSE}
    table_numbering(name = "exp3--prop-hits-and-FAs--tablecaption",
                     caption = "Mean proportion of hits and FAs by stimuli format and response-option condition.")
```
Separate 3 (stimuli format: words, drawings, photographs) x 2 (response-option condition: RFG-judgments, RFBG-judgements) mixed ANOVAs were conducted on the mean proportion of hits and false alarms (FAs; see `r table_numbering("exp3--prop-hits-and-FAs--tablecaption", display = "cite")`).

`r table_numbering("exp3--prop-hits-and-FAs--tablecaption")`
```{r, echo=FALSE, cache=TRUE}
grey__anova__PROP.HITS__table %>%
      kable("latex", booktabs = T) %>%
        kable_styling(latex_options = "hold_position") %>%
        pack_rows("Stimuli format", 1, 3) %>%
        pack_rows("Response option", 4, 5) %>%
        column_spec(1, width = "4cm")
```
&nbsp;

#### Proportion of total hits
For the proportion of hits, there was a significant main effect of stimuli format [`r apa__grey__anova__PROP.HITS__stim.format.main.effect`]. The interaction effect was not significant [`r apa__grey__anova__PROP.HITS__interaction.main.effect`]. Post-hoc comparisons for the main effect of stimuli format showed that photographs (`r apa__grey__anova__PROP.HITS__photographs.mean`) produced a significantly higher proportion of hits than both words (`r apa__grey__anova__PROP.HITS__words.mean`) [`r apa__grey__anova__PROP.HITS__words.vs.photographs.pairwise`] and drawings (`r apa__grey__anova__PROP.HITS__drawings.mean`) [`r apa__grey__anova__PROP.HITS__drawings.vs.photographs.pairwise`]. Drawings (`r apa__grey__anova__PROP.HITS__drawings.mean`) also produced a significantly higher proportion of hits compared to words (`r apa__grey__anova__PROP.HITS__words.mean`) [`r apa__grey__anova__PROP.HITS__words.vs.drawings.pairwise`].

```{r, echo=FALSE, results = FALSE, message=FALSE, warning=FALSE, cache=TRUE, fig.show='hide'}
###################################################################################################################
##                                                                                                               ##
##    Experiment 3 - Prop FAs:                                                                                   ##
##                                                                                                               ##
###################################################################################################################
# Prep data for analysis:                                               
    grey__anova__PROP.FA_data <- grey_data %>%
        select(id, ResponseOption, prop_word_FA, prop_drawing_FA, prop_photo_FA) %>%
        rename(word = "prop_word_FA", drawing = "prop_drawing_FA", photo = "prop_photo_FA") %>%
        gather(key = "StimuliFormat", value = "FA", word, drawing, photo) %>%
        mutate_at(vars("id", "ResponseOption", "StimuliFormat"), factor) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "word", "Words")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "drawing", "Drawings")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "photo", "Photographs")) %>%
        transform(StimuliFormat = factor(StimuliFormat, levels=c("Words","Drawings","Photographs"))) %>%
        transform(ResponseOption = factor(ResponseOption, levels=c("RFG","RFBG")))
#-----------------------------------------------------------------------------------------------------------------#
##  Run 2-way mixed ANOVA:
    grey__anova__PROP.FA <- aov_ez("id", "FA", grey__anova__PROP.FA_data,
                                       between = "ResponseOption", within = "StimuliFormat")
    
##  Format ANOVA main effects for use in report:  
    apa__grey__anova__PROP.FA <- papaja:::apa_print.afex_aov(grey__anova__PROP.FA) 
        apa__grey__anova__PROP.FA__stim.format.main.effect <- apa__grey__anova__PROP.FA$full$StimuliFormat %>%
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
        apa__grey__anova__PROP.FA__resp.option.main.effect <- apa__grey__anova__PROP.FA$full$ResponseOption %>%
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
        apa__grey__anova__PROP.FA__interaction.main.effect <- 
          apa__grey__anova__PROP.FA$full$ResponseOption_StimuliFormat %>%
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
#-----------------------------------------------------------------------------------------------------------------#
#  Run post-hoc contrasts                                                                                         
#-----------------------------------------------------------------------------------------------------------------#
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Response-option:  Not significant.
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Stimuli format:
    grey__anova__PROP.FA__stim.format.means <- emmeans(grey__anova__PROP.FA, ~ StimuliFormat)
    grey__anova__PROP.FA__stim.format.pairwise <- pairs(grey__anova__PROP.FA__stim.format.means)
    ##  Format pairwise results for use in report:  
        apa__grey__anova__PROP.FA__stim.format.means <- papaja:::apa_print.emmGrid(grey__anova__PROP.FA__stim.format.means)
        apa__grey__anova__PROP.FA__words.mean <- 
          apa__grey__anova__PROP.FA__stim.format.means$estimate$Words %>%
          str_remove("\\,.*")
        apa__grey__anova__PROP.FA__drawings.mean <- 
          apa__grey__anova__PROP.FA__stim.format.means$estimate$Drawings %>%
          str_remove("\\,.*")
        apa__grey__anova__PROP.FA__photographs.mean <- 
          apa__grey__anova__PROP.FA__stim.format.means$estimate$Photographs %>%
          str_remove("\\,.*")
        apa__grey__anova__PROP.FA__stim.format.pairwise <- 
papaja:::apa_print.emmGrid(grey__anova__PROP.FA__stim.format.pairwise)
        
        apa__grey__anova__PROP.FA__words.vs.drawings.pairwise <-
          apa__grey__anova__PROP.FA__stim.format.pairwise$full$Words_Drawings %>% 
          str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
        apa__grey__anova__PROP.FA__words.vs.photographs.pairwise <-
          apa__grey__anova__PROP.FA__stim.format.pairwise$full$Words_Photographs %>%
          str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
        apa__grey__anova__PROP.FA__drawings.vs.photographs.pairwise <-
          apa__grey__anova__PROP.FA__stim.format.pairwise$full$Drawings_Photographs %>% 
          str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Interaction:  Not significant.
```

#### Proportion of total FAs
For the proportion of FAs, there was a significant main effect of stimuli format [`r apa__grey__anova__PROP.FA__stim.format.main.effect`]. The interaction effect was not significant [`r apa__grey__anova__PROP.FA__interaction.main.effect`]. Post-hoc comparisons for the main effect of stimuli format showed that 
photographs (`r apa__grey__anova__PROP.FA__photographs.mean`) produced a significantly lower proportion of FAs than both 
words (`r apa__grey__anova__PROP.FA__words.mean`) [`r apa__grey__anova__PROP.FA__words.vs.photographs.pairwise`] 
and drawings (`r apa__grey__anova__PROP.FA__drawings.mean`) [`r apa__grey__anova__PROP.FA__drawings.vs.photographs.pairwise`]. Drawings (`r apa__grey__anova__PROP.FA__drawings.mean`) also produced a significantly lower proportion of FAs compared to 
words (`r apa__grey__anova__PROP.FA__words.mean`) [`r apa__grey__anova__PROP.FA__words.vs.drawings.pairwise`]. 

```{r, echo=FALSE, results = FALSE, message=FALSE, warning=FALSE, cache=TRUE, fig.show='hide'}
###################################################################################################################
##                                                                                                               ##
##    Experiment 3 - RECOG:                                                                                      ##
##                                                                                                               ##
###################################################################################################################
## Prep data for analysis:                                               
    grey__anova__RECOG_data <- grey_data %>%
        select(id, ResponseOption, word_recog, drawing_recog, photo_recog) %>%
        rename(word = "word_recog", drawing = "drawing_recog", photo = "photo_recog") %>%
        gather(key = "StimuliFormat", value = "recog", word, drawing, photo) %>%
        mutate_at(vars("id", "ResponseOption", "StimuliFormat"), factor) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "word", "Words")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "drawing", "Drawings")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "photo", "Photographs")) %>%
        transform(StimuliFormat = factor(StimuliFormat, levels=c("Words","Drawings","Photographs"))) %>%
        transform(ResponseOption = factor(ResponseOption, levels=c("RFG","RFBG")))
#-----------------------------------------------------------------------------------------------------------------#
##  Run 2-way mixed ANOVA:
    grey__anova__RECOG <- aov_ez("id", "recog", grey__anova__RECOG_data,
                                       between = "ResponseOption", within = "StimuliFormat")
    
##  Format ANOVA main effects for use in report:  
    apa__grey__anova__RECOG <- papaja:::apa_print.afex_aov(grey__anova__RECOG) 
        apa__grey__anova__RECOG__stim.format.main.effect <- apa__grey__anova__RECOG$full$StimuliFormat %>%
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
        apa__grey__anova__RECOG__resp.option.main.effect <- apa__grey__anova__RECOG$full$ResponseOption %>%
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
        apa__grey__anova__RECOG__interaction.main.effect <- apa__grey__anova__RECOG$full$ResponseOption_StimuliFormat %>%
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
#-----------------------------------------------------------------------------------------------------------------#
#  Run post-hoc contrasts                                                                                         
#-----------------------------------------------------------------------------------------------------------------#
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Response-option:  Not significant.
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Stimuli format:
    grey__anova__RECOG__stim.format.means <- emmeans(grey__anova__RECOG, ~ StimuliFormat)
    grey__anova__RECOG__stim.format.pairwise <- pairs(grey__anova__RECOG__stim.format.means)
    ##  Format pairwise results for use in report:  
        apa__grey__anova__RECOG__stim.format.means <- papaja:::apa_print.emmGrid(grey__anova__RECOG__stim.format.means)
        apa__grey__anova__RECOG__words.mean <- apa__grey__anova__RECOG__stim.format.means$estimate$Words %>%
          str_remove("\\,.*")
        apa__grey__anova__RECOG__drawings.mean <- apa__grey__anova__RECOG__stim.format.means$estimate$Drawings %>%
          str_remove("\\,.*")
        apa__grey__anova__RECOG__photographs.mean <- 
          apa__grey__anova__RECOG__stim.format.means$estimate$Photographs %>%
          str_remove("\\,.*")
        apa__grey__anova__RECOG__stim.format.pairwise <- papaja:::apa_print.emmGrid(grey__anova__RECOG__stim.format.pairwise)
        
        apa__grey__anova__RECOG__words.vs.drawings.pairwise <-
          apa__grey__anova__RECOG__stim.format.pairwise$full$Words_Drawings %>%
          str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
        apa__grey__anova__RECOG__words.vs.photographs.pairwise <-
          apa__grey__anova__RECOG__stim.format.pairwise$full$Words_Photographs %>%
          str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
        apa__grey__anova__RECOG__drawings.vs.photographs.pairwise <-
          apa__grey__anova__RECOG__stim.format.pairwise$full$Drawings_Photographs %>% 
          str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Interaction:  Not significant.
```

#### Overall performance accuracy
For overall performance accuracy, there was a significant main effect of stimuli format [`r apa__grey__anova__RECOG__stim.format.main.effect`]. The interaction effect was not significant [`r apa__grey__anova__RECOG__interaction.main.effect`]. Post-hoc comparisons for the main effect of stimuli format showed that 
photographs (`r apa__grey__anova__RECOG__photographs.mean`) produced significantly better performance accuracy than both 
words (`r apa__grey__anova__RECOG__words.mean`) [`r apa__grey__anova__RECOG__words.vs.photographs.pairwise`] and drawings (`r apa__grey__anova__RECOG__drawings.mean`) [`r apa__grey__anova__RECOG__drawings.vs.photographs.pairwise`]. Drawings (`r apa__grey__anova__RECOG__drawings.mean`) also produced significantly better performance accuracy compared to 
words (`r apa__grey__anova__RECOG__words.mean`) [`r apa__grey__anova__RECOG__words.vs.drawings.pairwise`].

### Discrimination (d') and response bias (c)
```{r, echo=FALSE, results = FALSE, message=FALSE, warning=FALSE, cache=TRUE, fig.show='hide'}
###################################################################################################################
##                                                                                                               ##
##    Experiment 3 - d':                                                                                         ##
##                                                                                                               ##
###################################################################################################################
## Prep data for analysis:                                               
    grey__anova__D.PRIME_data <- grey_data %>%
        select(id, ResponseOption, word_d_prime, drawing_d_prime, photo_d_prime) %>%
        rename(word = "word_d_prime", drawing = "drawing_d_prime", photo = "photo_d_prime") %>%
        gather(key = "StimuliFormat", value = "d.prime", word, drawing, photo) %>%
        mutate_at(vars("id", "ResponseOption", "StimuliFormat"), factor) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "word", "Words")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "drawing", "Drawings")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "photo", "Photographs")) %>%
        transform(StimuliFormat = factor(StimuliFormat, levels=c("Words","Drawings","Photographs"))) %>%
        transform(ResponseOption = factor(ResponseOption, levels=c("RFG","RFBG")))
#-----------------------------------------------------------------------------------------------------------------#
##  Run 2-way mixed ANOVA:
    grey__anova__D.PRIME <- aov_ez("id", "d.prime", grey__anova__D.PRIME_data,
                                   between = "ResponseOption", within = "StimuliFormat")
    
##  Format ANOVA main effects for use in report:  
    apa__grey__anova__D.PRIME <- papaja:::apa_print.afex_aov(grey__anova__D.PRIME) 
    apa__grey__anova__D.PRIME__stim.format.main.effect <- apa__grey__anova__D.PRIME$full$StimuliFormat %>%
        str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__D.PRIME__resp.option.main.effect <- apa__grey__anova__D.PRIME$full$ResponseOption %>%
        str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__D.PRIME__interaction.main.effect <- 
        apa__grey__anova__D.PRIME$full$ResponseOption_StimuliFormat %>%
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
#-----------------------------------------------------------------------------------------------------------------#
#  Run post-hoc contrasts                                                                                         
#-----------------------------------------------------------------------------------------------------------------#
##  Interaction:
    grey__anova__D.PRIME__interaction.means <- emmeans(grey__anova__D.PRIME, ~ ResponseOption:StimuliFormat)
    grey__anova__D.PRIME__interaction.pairwise <- pairs(grey__anova__D.PRIME__interaction.means)
    
    ##  Format pairwise results for use in report:  
        apa__grey__anova__D.PRIME__interaction.means <- 
            papaja:::apa_print.emmGrid(grey__anova__D.PRIME__interaction.means)
        apa__grey__anova__D.PRIME__interaction.full.pairwise <- 
            papaja:::apa_print.emmGrid(grey__anova__D.PRIME__interaction.pairwise)
    ##  Prep data for figure:  
        grey__D.PRIME__interaction.figure.data <- as.tibble(grey__anova__D.PRIME__interaction.means) %>%
            select(-df, -lower.CL, -upper.CL)
    ##  Create labels for figure (replaces plot legend):
        grey__D.PRIME__interaction.figure.labels <- grey__D.PRIME__interaction.figure.data %>%
            select(StimuliFormat, ResponseOption, emmean) %>%
            filter(StimuliFormat == "Photographs") %>%
            mutate(label = case_when(
            ResponseOption == "RFG" ~ "RFG",
            ResponseOption == "RFBG" ~ "RFBG")) %>%
            group_by(StimuliFormat, ResponseOption, label)
    ##  Interaction figure:
        grey__D.PRIME__interaction.figure <- grey__D.PRIME__interaction.figure.data %>%
            ggplot() +
            aes(x = StimuliFormat, color = ResponseOption, group = ResponseOption, y = emmean) +
            stat_summary(fun.y = mean, geom = "point", size = 2.4, shape = 15) +
            stat_summary(fun.y = mean, geom = "line", size = 1.2) +
            geom_text(size = 4, aes(label = label, color = ResponseOption), nudge_x = 0.08, hjust = 0,
            data = grey__D.PRIME__interaction.figure.labels) +
            scale_color_manual(values = c('#8ec6c5', '#7d9ab5', '#8566aa')) +
            labs(x = "Stimuli-format", y = "Mean d' scores") +
            scale_y_continuous(limits = c(0, 3),
            breaks = c(0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0),
            expand = c(0, 0)) +
            theme_classic() +
            theme(legend.position = "none",
                  axis.title.x = element_text(size = 10, vjust = -4),
                  axis.text.x = element_text(size = 10),
                  axis.title.y = element_text(size = 10, vjust = 6),
                  axis.text.y = element_text(size = 10),
                  plot.background = element_rect(size = 0.5, linetype = 'solid', colour = "black"),
                  plot.margin = margin(20, 20, 24, 30))
#-----------------------------------------------------------------------------------------------------------------#
##  Prep data for table:  
    grey__anova__D.PRIME__rfg.totals <- grey_data %>%
        filter(ResponseOption == "RFG") %>%
        mutate(total_d_prime = word_d_prime + drawing_d_prime + photo_d_prime) %>%
        mutate(total_c = word_c + drawing_c + photo_c)
    grey__anova__D.PRIME__rfbg.totals <- grey_data %>%
        filter(ResponseOption == "RFBG") %>%
        mutate(total_d_prime = word_d_prime + drawing_d_prime + photo_d_prime) %>%
        mutate(total_c = word_c + drawing_c + photo_c)

    grey__anova__D.PRIME__table <- tribble(
        ~"Stim", ~"d'",  ~c,
        "Words", mean(grey_data$word_d_prime), mean(grey_data$word_c),
        "Drawings", mean(grey_data$drawing_d_prime), mean(grey_data$drawing_c),
        "Photographs", mean(grey_data$photo_d_prime), mean(grey_data$photo_c),
        "RFG",  mean(grey__anova__D.PRIME__rfg.totals$total_d_prime) / 60,
                mean(grey__anova__D.PRIME__rfg.totals$total_c) / 60,
        "RFBG", mean(grey__anova__D.PRIME__rfbg.totals$total_d_prime) / 60,
                mean(grey__anova__D.PRIME__rfbg.totals$total_c) / 60) %>%
        mutate_if(is.numeric, round, 2) %>%
        column_to_rownames(var = "Stim")
```

To assess the roles of discrimination and response bias, separate 3 (stimuli format: words, drawings, photographs) x 2 (response-option condition: RFG-judgements, RFBG-judgements) mixed ANOVAs were conducted on d’ (d-prime; measure of sensitivity)  and c-scores (decision criterion; see `r table_numbering("grey__mean.d.and.c__table.caption", display = "cite")`).

`r table_numbering("grey__mean.d.and.c__table.caption")`
```{r, echo=FALSE, cache=TRUE}
grey__anova__D.PRIME__table %>%
      kable("latex", booktabs = T) %>%
        kable_styling(latex_options = "hold_position") %>%
        pack_rows("Stimuli format", 1, 3) %>%
        pack_rows("Response option", 4, 5) %>%
        column_spec(1, width = "4cm")
```
&nbsp;

#### d' (discrimination)
For d' scores, there was a significant interaction between stimuli format and response-option [`r apa__grey__anova__D.PRIME__interaction.main.effect`] (see `r figure_numbering("grey__dprime_interaction_figure_caption", display = "cite")`). 

Photographs
(`r apa__grey__anova__D.PRIME__interaction.means$estimate$RFG_Photographs %>% str_remove("\\,.*")`)
facilitated better discrimination between hits / FAs than both words
(`r apa__grey__anova__D.PRIME__interaction.means$estimate$RFG_Words %>% str_remove("\\,.*")`)
[`r apa__grey__anova__D.PRIME__interaction.full.pairwise$statistic$RFGWords_RFGPhotographs`] and drawings
(`r apa__grey__anova__D.PRIME__interaction.means$estimate$RFG_Drawings %>% str_remove("\\,.*")`) 
[`r apa__grey__anova__D.PRIME__interaction.full.pairwise$statistic$RFGDrawings_RFGPhotographs`] in the RFG group. Drawings
(`r apa__grey__anova__D.PRIME__interaction.means$estimate$RFG_Drawings %>% str_remove("\\,.*")`) 
also showed significantly higher d' scores compared to words 
(`r apa__grey__anova__D.PRIME__interaction.means$estimate$RFG_Words %>% str_remove("\\,.*")`)
[`r apa__grey__anova__D.PRIME__interaction.full.pairwise$statistic$RFGWords_RFGDrawings`]. In the RFBG group, the same pattern was evident; photographs
(`r apa__grey__anova__D.PRIME__interaction.means$estimate$RFBG_Photographs %>% str_remove("\\,.*")`)
facilitated better discrimination than both words
(`r apa__grey__anova__D.PRIME__interaction.means$estimate$RFBG_Words %>% str_remove("\\,.*")`)
[`r apa__grey__anova__D.PRIME__interaction.full.pairwise$statistic$RFBGWords_RFBGPhotographs`] 
and drawings
(`r apa__grey__anova__D.PRIME__interaction.means$estimate$RFBG_Drawings %>% str_remove("\\,.*")`) 
[`r apa__grey__anova__D.PRIME__interaction.full.pairwise$statistic$RFBGDrawings_RFBGPhotographs`] 
Again, drawings
(`r apa__grey__anova__D.PRIME__interaction.means$estimate$RFBG_Drawings %>% str_remove("\\,.*")`) 
also showed significantly higher d' scores than words 
(`r apa__grey__anova__D.PRIME__interaction.means$estimate$RFBG_Words %>% str_remove("\\,.*")`)
[`r apa__grey__anova__D.PRIME__interaction.full.pairwise$statistic$RFBGWords_RFGDrawings`].

Comparisons of stimuli format across the response-option groups showed that d' scores for photographs did not significantly differ between the RFG (`r apa__grey__anova__D.PRIME__interaction.means$estimate$RFG_Photographs %>% str_remove("\\,.*")`) and RFBG (`r apa__grey__anova__D.PRIME__interaction.means$estimate$RFBG_Photographs %>% str_remove("\\,.*")`) conditions [`r apa__grey__anova__D.PRIME__interaction.full.pairwise$statistic$RFGPhotographs_RFBGPhotographs`], nor for drawings (RFG: `r apa__grey__anova__D.PRIME__interaction.means$estimate$RFG_Drawings %>% str_remove("\\,.*")`, RFBG: `r apa__grey__anova__D.PRIME__interaction.means$estimate$RFBG_Drawings %>% str_remove("\\,.*")`, [`r apa__grey__anova__D.PRIME__interaction.full.pairwise$statistic$RFGDrawings_RFBGDrawings`], nor for words (RFG: `r apa__grey__anova__D.PRIME__interaction.means$estimate$RFG_Words %>% str_remove("\\,.*")`, RFBG: `r apa__grey__anova__D.PRIME__interaction.means$estimate$RFBG_Words %>% str_remove("\\,.*")`, [`r apa__grey__anova__D.PRIME__interaction.full.pairwise$statistic$RFGWords_RFBGWords`]). 

&nbsp;

```{r exp3--dprime-interaction--figurecaption, echo=FALSE, results = FALSE}
    figure_numbering(name = "exp3--dprime-interaction--figurecaption",
                     caption = "Interaction plot between stimuli format and response-option for d' scores.")
```

```{r fig.width=7, fig.height=5.5, echo=FALSE}
    grey__D.PRIME__interaction.figure
```
`r figure_numbering("exp3--dprime-interaction--figurecaption")`


```{r, echo=FALSE, results = FALSE, message=FALSE, warning=FALSE, cache=TRUE, fig.show='hide'}
###################################################################################################################
##                                                                                                               ##
##    Experiment 3 - c:                                                                                          ##
##                                                                                                               ##
###################################################################################################################
## Prep data for analysis:                                               
    grey__anova__C.SCORES_data <- grey_data %>%
        select(id, ResponseOption, word_c, drawing_c, photo_c) %>%
        rename(word = "word_c", drawing = "drawing_c", photo = "photo_c") %>%
        gather(key = "StimuliFormat", value = "C.SCORES", word, drawing, photo) %>%
        mutate_at(vars("id", "ResponseOption", "StimuliFormat"), factor) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "word", "Words")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "drawing", "Drawings")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "photo", "Photographs")) %>%
        transform(StimuliFormat = factor(StimuliFormat, levels=c("Words","Drawings","Photographs"))) %>%
        transform(ResponseOption = factor(ResponseOption, levels=c("RFG","RFBG")))
#-----------------------------------------------------------------------------------------------------------------#
##  Run 2-way mixed ANOVA:
    grey__anova__C.SCORES <- aov_ez("id", "C.SCORES", grey__anova__C.SCORES_data,
                                    between = "ResponseOption", within = "StimuliFormat")
    
##  Format ANOVA main effects for use in report:  
    apa__grey__anova__C.SCORES <- papaja:::apa_print.afex_aov(grey__anova__C.SCORES) 
    apa__grey__anova__C.SCORES__stim.format.main.effect <- apa__grey__anova__C.SCORES$full$StimuliFormat %>%
        str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__C.SCORES__resp.option.main.effect <- apa__grey__anova__C.SCORES$full$ResponseOption %>%
        str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__C.SCORES__interaction.main.effect <-
        apa__grey__anova__C.SCORES$full$ResponseOption_StimuliFormat %>%
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
#-----------------------------------------------------------------------------------------------------------------#
#  Run post-hoc contrasts                                                                                         
#-----------------------------------------------------------------------------------------------------------------#
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Response-option:
    grey__anova__C.SCORES__resp.option.means <- emmeans(grey__anova__C.SCORES, ~ ResponseOption)
    grey__anova__C.SCORES__resp.option.pairwise <- pairs(grey__anova__C.SCORES__resp.option.means)  
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Stimuli format:
    grey__anova__C.SCORES__stim.format.means <- emmeans(grey__anova__C.SCORES, ~ StimuliFormat)
    grey__anova__C.SCORES__stim.format.pairwise <- pairs(grey__anova__C.SCORES__stim.format.means)
    
    ##  Format pairwise results for use in report:  
        apa__grey__anova__C.SCORES__stim.format.means <- papaja:::apa_print.emmGrid(grey__anova__C.SCORES__stim.format.means)
        apa__grey__anova__C.SCORES__words.mean <- apa__grey__anova__C.SCORES__stim.format.means$estimate$Words %>%
            str_remove("\\,.*")
        apa__grey__anova__C.SCORES__drawings.mean <- 
            apa__grey__anova__C.SCORES__stim.format.means$estimate$Drawings %>% str_remove("\\,.*")
        apa__grey__anova__C.SCORES__photographs.mean <- 
            apa__grey__anova__C.SCORES__stim.format.means$estimate$Photographs %>% str_remove("\\,.*")
        apa__grey__anova__C.SCORES__stim.format.pairwise <- 
            papaja:::apa_print.emmGrid(grey__anova__C.SCORES__stim.format.pairwise)
        
        apa__grey__anova__C.SCORES__words.vs.drawings.pairwise <-
            apa__grey__anova__C.SCORES__stim.format.pairwise$full$Words_Drawings %>% 
            str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
        apa__grey__anova__C.SCORES__words.vs.photographs.pairwise <-
            apa__grey__anova__C.SCORES__stim.format.pairwise$full$Words_Photographs %>% 
            str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
        apa__grey__anova__C.SCORES__drawings.vs.photographs.pairwise <-
            apa__grey__anova__C.SCORES__stim.format.pairwise$full$Drawings_Photographs %>%
            str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Interaction:  Not significant.
#-----------------------------------------------------------------------------------------------------------------#
```

#### c (response bias)
For c-scores, there was a significant main effect of stimuli format [`r apa__grey__anova__C.SCORES__stim.format.main.effect`]. The interaction effect was not significant [`r apa__grey__anova__C.SCORES__interaction.main.effect`]. Post-hoc comparisons for the main effect of stimuli format showed that photographs (`r apa__grey__anova__C.SCORES__photographs.mean`) produced significantly lower c-scores (and thus a less conservative response bias) than both words (`r apa__grey__anova__C.SCORES__words.mean`) [`r apa__grey__anova__C.SCORES__words.vs.photographs.pairwise`] and drawings (`r apa__grey__anova__C.SCORES__drawings.mean`) [`r apa__grey__anova__C.SCORES__drawings.vs.photographs.pairwise`]. There was no difference in c-scores between drawings (`r apa__grey__anova__C.SCORES__drawings.mean`) and words (`r apa__grey__anova__C.SCORES__words.mean`) [`r apa__grey__anova__C.SCORES__words.vs.drawings.pairwise`].

```{r, echo=FALSE, results = FALSE, message=FALSE, warning=FALSE, cache=TRUE, fig.show='hide'}
##### EXPERIMENT 3 ################################################################################################
###################################################################################################################
##                                                                                                               ##
##    PROP REC HITS:                                                                                             ##
##                                                                                                               ##
###################################################################################################################
##  Prep data for analysis:                                               
    grey__anova__PROP.REC.HITS_data <- grey_data %>%
        select(id, ResponseOption, prop_word_hit_rec_total, prop_drawing_hit_rec_total, 
               prop_photo_hit_rec_total) %>%
        rename(word = "prop_word_hit_rec_total", 
               drawing = "prop_drawing_hit_rec_total",
               photo = "prop_photo_hit_rec_total") %>%
        gather(key = "StimuliFormat", value = "PROP.REC.HITS", word, drawing, photo) %>%
        mutate_at(vars("id", "ResponseOption", "StimuliFormat"), factor) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "word", "Words")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "drawing", "Drawings")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "photo", "Photographs")) %>%
        transform(StimuliFormat = factor(StimuliFormat, levels=c("Words","Drawings","Photographs"))) %>%
        transform(ResponseOption = factor(ResponseOption, levels=c("RFG","RFBG")))
#-----------------------------------------------------------------------------------------------------------------#
##  Run 2-way mixed ANOVA:
    grey__anova__PROP.REC.HITS <- aov_ez("id", "PROP.REC.HITS", grey__anova__PROP.REC.HITS_data,
                                       between = "ResponseOption", within = "StimuliFormat")
    
##  Format ANOVA main effects for use in report:  
    apa__grey__anova__PROP.REC.HITS <- papaja:::apa_print.afex_aov(grey__anova__PROP.REC.HITS) 
    apa__grey__anova__PROP.REC.HITS__stim.format.main.effect <-
        apa__grey__anova__PROP.REC.HITS$full$StimuliFormat %>% str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__PROP.REC.HITS__resp.option.main.effect <-
        apa__grey__anova__PROP.REC.HITS$full$ResponseOption %>% str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__PROP.REC.HITS__interaction.main.effect <-
        apa__grey__anova__PROP.REC.HITS$full$ResponseOption_StimuliFormat %>%
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
#-----------------------------------------------------------------------------------------------------------------#
#  Run post-hoc contrasts                                                                                         
#-----------------------------------------------------------------------------------------------------------------#
##  Interaction:
    grey__anova__PROP.REC.HITS__interaction.means <- 
        emmeans(grey__anova__PROP.REC.HITS, ~ ResponseOption:StimuliFormat)
    grey__anova__PROP.REC.HITS__interaction.pairwise <- pairs(grey__anova__PROP.REC.HITS__interaction.means)
    
    ##  Format pairwise results for use in report:  
        apa__grey__anova__PROP.REC.HITS__interaction.means <- 
            papaja:::apa_print.emmGrid(grey__anova__PROP.REC.HITS__interaction.means)
        apa__grey__anova__PROP.REC.HITS__interaction.full.pairwise <- 
            papaja:::apa_print.emmGrid(grey__anova__PROP.REC.HITS__interaction.pairwise)
        
    ##  Prep data for figure:  
        grey__PROP.REC.HITS__interaction.figure.data <- as.tibble(grey__anova__PROP.REC.HITS__interaction.means) %>%
            select(-df, -lower.CL, -upper.CL)
    ##  Create labels for figure (replaces plot legend):
        grey__PROP.REC.HITS__interaction.figure.labels <- grey__PROP.REC.HITS__interaction.figure.data %>%
            select(StimuliFormat, ResponseOption, emmean) %>%
            filter(StimuliFormat == "Photographs") %>%
            mutate(label = case_when(
            ResponseOption == "RFG" ~ "RFG",
            ResponseOption == "RFBG" ~ "RFBG")) %>%
            group_by(StimuliFormat, ResponseOption, label)
    ##  Interaction figure:
        grey__PROP.REC.HITS__interaction.figure <- grey__PROP.REC.HITS__interaction.figure.data %>%
            ggplot() +
            aes(x = StimuliFormat, colour = ResponseOption, group = ResponseOption, y = emmean) +
            stat_summary(fun.y = mean, geom = "point", size = 2.4, shape = 15) +
            stat_summary(fun.y = mean, geom = "line", size = 1.2) +
            geom_text(size = 4, aes(label = label, colour = ResponseOption), nudge_x = 0.08, hjust = 0,
            data = grey__PROP.REC.HITS__interaction.figure.labels) +
            scale_colour_manual(values = c('#8ec6c5', '#7d9ab5', '#8566aa')) +
            labs(x = "Stimuli-format", y = "Mean proportion of hits assigned:  'Familiarity'") +
            scale_y_continuous(limits = c(0, 1),
                               breaks = c(0, 0.10, 0.20, 0.30, 0.40, 0.50, 0.60, 0.70, 0.80, 0.90, 1),
                               expand = c(0, 0)) +
            theme_classic() +
            theme(legend.position = "none",
                  axis.title.x = element_text(size = 10, vjust = -4),
                  axis.text.x = element_text(size = 10),
                  axis.title.y = element_text(size = 10, vjust = 6),
                  axis.text.y = element_text(size = 10),
                  plot.background = element_rect(size = 0.5, linetype = 'solid', colour = "black"),
                  plot.margin = margin(20, 20, 24, 30))

###################################################################################################################
##                                                                                                               ##
##    PROP FAM HITS:                                                                                             ##
##                                                                                                               ##
###################################################################################################################
## Prep data for analysis:                                               
    grey__anova__PROP.FAM.HITS_data <- grey_data %>%
        select(id, ResponseOption, prop_word_hit_fam_total, prop_drawing_hit_fam_total,
               prop_photo_hit_fam_total) %>%
        rename(word = "prop_word_hit_fam_total",
               drawing = "prop_drawing_hit_fam_total",
               photo = "prop_photo_hit_fam_total") %>%
        gather(key = "StimuliFormat", value = "PROP.FAM.HITS", word, drawing, photo) %>%
        mutate_at(vars("id", "ResponseOption", "StimuliFormat"), factor) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "word", "Words")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "drawing", "Drawings")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "photo", "Photographs")) %>%
        transform(StimuliFormat = factor(StimuliFormat, levels=c("Words","Drawings","Photographs"))) %>%
        transform(ResponseOption = factor(ResponseOption, levels=c("RFG","RFBG")))
#-----------------------------------------------------------------------------------------------------------------#
##  Run 2-way mixed ANOVA:
    grey__anova__PROP.FAM.HITS <- aov_ez("id", "PROP.FAM.HITS", grey__anova__PROP.FAM.HITS_data,
                                       between = "ResponseOption", within = "StimuliFormat")
    
##  Format ANOVA main effects for use in report:  
    apa__grey__anova__PROP.FAM.HITS <- papaja:::apa_print.afex_aov(grey__anova__PROP.FAM.HITS) 
    apa__grey__anova__PROP.FAM.HITS__stim.format.main.effect <-
        apa__grey__anova__PROP.FAM.HITS$full$StimuliFormat %>% str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__PROP.FAM.HITS__resp.option.main.effect <-
        apa__grey__anova__PROP.FAM.HITS$full$ResponseOption %>% str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__PROP.FAM.HITS__interaction.main.effect <-
        apa__grey__anova__PROP.FAM.HITS$full$ResponseOption_StimuliFormat %>%   
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
#-----------------------------------------------------------------------------------------------------------------#
##  Run post-hoc contrasts:
#-----------------------------------------------------------------------------------------------------------------#
##  Interaction:
    grey__anova__PROP.FAM.HITS__interaction.means <- 
        emmeans(grey__anova__PROP.FAM.HITS, ~ ResponseOption:StimuliFormat)
    grey__anova__PROP.FAM.HITS__interaction.pairwise <- pairs(grey__anova__PROP.FAM.HITS__interaction.means)
    
    ##  Format pairwise results for use in report:  
        apa__grey__anova__PROP.FAM.HITS__interaction.means <- 
            papaja:::apa_print.emmGrid(grey__anova__PROP.FAM.HITS__interaction.means)
        apa__grey__anova__PROP.FAM.HITS__interaction.full.pairwise <- 
            papaja:::apa_print.emmGrid(grey__anova__PROP.FAM.HITS__interaction.pairwise)
        
    ##  Prep data for figure:  
        grey__PROP.FAM.HITS__interaction.figure.data <- as.tibble(grey__anova__PROP.FAM.HITS__interaction.means) %>%
            select(-df, -lower.CL, -upper.CL)
    ##  Create labels for figure (replaces plot legend):
        grey__PROP.FAM.HITS__interaction.figure.labels <- grey__PROP.FAM.HITS__interaction.figure.data %>%
            select(StimuliFormat, ResponseOption, emmean) %>%
            filter(StimuliFormat == "Photographs") %>%
            mutate(label = case_when(
            ResponseOption == "RFG" ~ "RFG",
            ResponseOption == "RFBG" ~ "RFBG")) %>%
            group_by(StimuliFormat, ResponseOption, label)
    ##  Interaction figure:
        grey__PROP.FAM.HITS__interaction.figure <- grey__PROP.FAM.HITS__interaction.figure.data %>%
            ggplot() +
            aes(x = StimuliFormat, colour = ResponseOption, group = ResponseOption, y = emmean) +
            stat_summary(fun.y = mean, geom = "point", size = 2.4, shape = 15) +
            stat_summary(fun.y = mean, geom = "line", size = 1.2) +
            geom_text(size = 4, aes(label = label, colour = ResponseOption), nudge_x = 0.08, hjust = 0,
            data = grey__PROP.FAM.HITS__interaction.figure.labels) +
            scale_colour_manual(values = c('#8ec6c5', '#7d9ab5', '#8566aa')) +
            labs(x = "Stimuli-format", y = "Mean proportion of hits assigned:  'Familiarity'") +
            scale_y_continuous(limits = c(0, 1),
                               breaks = c(0, 0.10, 0.20, 0.30, 0.40, 0.50, 0.60, 0.70, 0.80, 0.90, 1),
                               expand = c(0, 0)) +
            theme_classic() +
            theme(legend.position = "none",
                  axis.title.x = element_text(size = 10, vjust = -4),
                  axis.text.x = element_text(size = 10),
                  axis.title.y = element_text(size = 10, vjust = 6),
                  axis.text.y = element_text(size = 10),
                  plot.background = element_rect(size = 0.5, linetype = 'solid', colour = "black"),
                  plot.margin = margin(20, 20, 24, 30))

###################################################################################################################
##                                                                                                               ##
##    PROP GUESS HITS:                                                                                           ##
##                                                                                                               ##
###################################################################################################################
## Prep data for analysis:                                               
    grey__anova__PROP.GUESS.HITS_data <- grey_data %>%
        select(id, ResponseOption, prop_word_hit_guess, prop_drawing_hit_guess, prop_photo_hit_guess) %>%
        rename(word = "prop_word_hit_guess",
               drawing = "prop_drawing_hit_guess",
               photo = "prop_photo_hit_guess") %>%
        gather(key = "StimuliFormat", value = "PROP.GUESS.HITS", word, drawing, photo) %>%
        mutate_at(vars("id", "ResponseOption", "StimuliFormat"), factor) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "word", "Words")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "drawing", "Drawings")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "photo", "Photographs")) %>%
        transform(StimuliFormat = factor(StimuliFormat, levels=c("Words","Drawings","Photographs"))) %>%
        transform(ResponseOption = factor(ResponseOption, levels=c("RFG","RFBG")))
#-----------------------------------------------------------------------------------------------------------------#
##  Run 2-way mixed ANOVA:
    grey__anova__PROP.GUESS.HITS <- aov_ez("id", "PROP.GUESS.HITS", grey__anova__PROP.GUESS.HITS_data,
                                       between = "ResponseOption", within = "StimuliFormat")
    
##  Format ANOVA main effects for use in report:  
    apa__grey__anova__PROP.GUESS.HITS <- papaja:::apa_print.afex_aov(grey__anova__PROP.GUESS.HITS) 
    apa__grey__anova__PROP.GUESS.HITS__stim.format.main.effect <- 
        apa__grey__anova__PROP.GUESS.HITS$full$StimuliFormat %>% str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__PROP.GUESS.HITS__resp.option.main.effect <- 
        apa__grey__anova__PROP.GUESS.HITS$full$ResponseOption %>% str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__PROP.GUESS.HITS__interaction.main.effect <-
        apa__grey__anova__PROP.GUESS.HITS$full$ResponseOption_StimuliFormat %>% 
            str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
#-----------------------------------------------------------------------------------------------------------------#
##  Run post-hoc contrasts:
#-----------------------------------------------------------------------------------------------------------------#
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Response-option:  Not significant.
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Stimuli format:
    grey__anova__PROP.GUESS.HITS__stim.format.means <- emmeans(grey__anova__PROP.GUESS.HITS, ~ StimuliFormat)
    grey__anova__PROP.GUESS.HITS__stim.format.pairwise <- 
        pairs(grey__anova__PROP.GUESS.HITS__stim.format.means)
    
    ##  Format pairwise results for use in report:  
        apa__grey__anova__PROP.GUESS.HITS__stim.format.means <-   
            papaja:::apa_print.emmGrid(grey__anova__PROP.GUESS.HITS__stim.format.means)
        apa__grey__anova__PROP.GUESS.HITS__words.mean <- 
            apa__grey__anova__PROP.GUESS.HITS__stim.format.means$estimate$Words %>% str_remove("\\,.*")
        apa__grey__anova__PROP.GUESS.HITS__drawings.mean <- 
            apa__grey__anova__PROP.GUESS.HITS__stim.format.means$estimate$Drawings %>% str_remove("\\,.*")
        apa__grey__anova__PROP.GUESS.HITS__photographs.mean <-
            apa__grey__anova__PROP.GUESS.HITS__stim.format.means$estimate$Photographs %>% str_remove("\\,.*")
        apa__grey__anova__PROP.GUESS.HITS__stim.format.pairwise <-
            papaja:::apa_print.emmGrid(grey__anova__PROP.GUESS.HITS__stim.format.pairwise)
        
        apa__grey__anova__PROP.GUESS.HITS__words.vs.drawings.pairwise <-
            apa__grey__anova__PROP.GUESS.HITS__stim.format.pairwise$full$Words_Drawings %>% 
                str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
        apa__grey__anova__PROP.GUESS.HITS__words.vs.photographs.pairwise <-
            apa__grey__anova__PROP.GUESS.HITS__stim.format.pairwise$full$Words_Photographs %>% 
                str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
        apa__grey__anova__PROP.GUESS.HITS__drawings.vs.photographs.pairwise <-
            apa__grey__anova__PROP.GUESS.HITS__stim.format.pairwise$full$Drawings_Photographs %>%
                str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Interaction:  Not significant.

###################################################################################################################
##                                                                                                               ##
##    HITS FIGURE:                                                                                               ##
##                                                                                                               ##
###################################################################################################################
##  Prep data for figures:  
    grey__PROP.REC.HITS__figure.data <- 
        as.tibble(emmeans(grey__anova__PROP.REC.HITS, ~ ResponseOption:StimuliFormat)) %>%
        select(-df, -lower.CL, -upper.CL)
    grey__PROP.FAM.HITS__figure.data <- 
        as.tibble(emmeans(grey__anova__PROP.FAM.HITS, ~ ResponseOption:StimuliFormat)) %>%
        select(-df, -lower.CL, -upper.CL)
    grey__PROP.GUESS.HITS__figure.data <- 
        as.tibble(emmeans(grey__anova__PROP.GUESS.HITS, ~ ResponseOption:StimuliFormat)) %>%
        select(-df, -lower.CL, -upper.CL)
      
    grey__PROP.REC.FAM.GUESS.HITS__figure.data <- 
      tribble(~"ResponseOption", ~"StimuliFormat", ~"rfg", ~"emmean", ~"SE",
        as.character(pull(grey__PROP.REC.HITS__figure.data[1,1])), ... = 
        as.character(pull(grey__PROP.REC.HITS__figure.data[1,2])), "Recollection",
        as.double(pull(grey__PROP.REC.HITS__figure.data[1,3])), 
        as.double(pull(grey__PROP.REC.HITS__figure.data[1,4])),
        as.character(pull(grey__PROP.REC.HITS__figure.data[2,1])), 
        as.character(pull(grey__PROP.REC.HITS__figure.data[2,2])), "Recollection",
        as.double(pull(grey__PROP.REC.HITS__figure.data[2,3])), 
        as.double(pull(grey__PROP.REC.HITS__figure.data[2,4])),
        as.character(pull(grey__PROP.REC.HITS__figure.data[3,1])), 
        as.character(pull(grey__PROP.REC.HITS__figure.data[3,2])), "Recollection",
        as.double(pull(grey__PROP.REC.HITS__figure.data[3,3])), 
        as.double(pull(grey__PROP.REC.HITS__figure.data[3,4])),
        as.character(pull(grey__PROP.REC.HITS__figure.data[4,1])), 
        as.character(pull(grey__PROP.REC.HITS__figure.data[4,2])), "Recollection",
        as.double(pull(grey__PROP.REC.HITS__figure.data[4,3])), 
        as.double(pull(grey__PROP.REC.HITS__figure.data[4,4])),
        as.character(pull(grey__PROP.REC.HITS__figure.data[5,1])), 
        as.character(pull(grey__PROP.REC.HITS__figure.data[5,2])), "Recollection",
        as.double(pull(grey__PROP.REC.HITS__figure.data[5,3])), 
        as.double(pull(grey__PROP.REC.HITS__figure.data[5,4])),
        as.character(pull(grey__PROP.REC.HITS__figure.data[6,1])), 
        as.character(pull(grey__PROP.REC.HITS__figure.data[6,2])), "Recollection",
        as.double(pull(grey__PROP.REC.HITS__figure.data[6,3])), 
        as.double(pull(grey__PROP.REC.HITS__figure.data[6,4])),
        as.character(pull(grey__PROP.FAM.HITS__figure.data[1,1])), 
        as.character(pull(grey__PROP.FAM.HITS__figure.data[1,2])), "Familiarity",
        as.double(pull(grey__PROP.FAM.HITS__figure.data[1,3])), 
        as.double(pull(grey__PROP.FAM.HITS__figure.data[1,4])),
        as.character(pull(grey__PROP.FAM.HITS__figure.data[2,1])), 
        as.character(pull(grey__PROP.FAM.HITS__figure.data[2,2])), "Familiarity",
        as.double(pull(grey__PROP.FAM.HITS__figure.data[2,3])), 
        as.double(pull(grey__PROP.FAM.HITS__figure.data[2,4])),
        as.character(pull(grey__PROP.FAM.HITS__figure.data[3,1])), 
        as.character(pull(grey__PROP.FAM.HITS__figure.data[3,2])), "Familiarity",
        as.double(pull(grey__PROP.FAM.HITS__figure.data[3,3])), 
        as.double(pull(grey__PROP.FAM.HITS__figure.data[3,4])),
        as.character(pull(grey__PROP.FAM.HITS__figure.data[4,1])), 
        as.character(pull(grey__PROP.FAM.HITS__figure.data[4,2])), "Familiarity",
        as.double(pull(grey__PROP.FAM.HITS__figure.data[4,3])), 
        as.double(pull(grey__PROP.FAM.HITS__figure.data[4,4])),
        as.character(pull(grey__PROP.FAM.HITS__figure.data[5,1])), 
        as.character(pull(grey__PROP.FAM.HITS__figure.data[5,2])), "Familiarity",
        as.double(pull(grey__PROP.FAM.HITS__figure.data[5,3])), 
        as.double(pull(grey__PROP.FAM.HITS__figure.data[5,4])),
        as.character(pull(grey__PROP.FAM.HITS__figure.data[6,1])), 
        as.character(pull(grey__PROP.FAM.HITS__figure.data[6,2])), "Familiarity",
        as.double(pull(grey__PROP.FAM.HITS__figure.data[6,3])), 
        as.double(pull(grey__PROP.FAM.HITS__figure.data[6,4])),
        as.character(pull(grey__PROP.GUESS.HITS__figure.data[1,1])), 
        as.character(pull(grey__PROP.GUESS.HITS__figure.data[1,2])), "Guessing",
        as.double(pull(grey__PROP.GUESS.HITS__figure.data[1,3])), 
        as.double(pull(grey__PROP.GUESS.HITS__figure.data[1,4])),
        as.character(pull(grey__PROP.GUESS.HITS__figure.data[2,1])), 
        as.character(pull(grey__PROP.GUESS.HITS__figure.data[2,2])), "Guessing",
        as.double(pull(grey__PROP.GUESS.HITS__figure.data[2,3])), 
        as.double(pull(grey__PROP.GUESS.HITS__figure.data[2,4])),
        as.character(pull(grey__PROP.GUESS.HITS__figure.data[3,1])), 
        as.character(pull(grey__PROP.GUESS.HITS__figure.data[3,2])), "Guessing",
        as.double(pull(grey__PROP.GUESS.HITS__figure.data[3,3])), 
        as.double(pull(grey__PROP.GUESS.HITS__figure.data[3,4])),
        as.character(pull(grey__PROP.GUESS.HITS__figure.data[4,1])), 
        as.character(pull(grey__PROP.GUESS.HITS__figure.data[4,2])), "Guessing",
        as.double(pull(grey__PROP.GUESS.HITS__figure.data[4,3])), 
        as.double(pull(grey__PROP.GUESS.HITS__figure.data[4,4])),
        as.character(pull(grey__PROP.GUESS.HITS__figure.data[5,1])), 
        as.character(pull(grey__PROP.GUESS.HITS__figure.data[5,2])), "Guessing",
        as.double(pull(grey__PROP.GUESS.HITS__figure.data[5,3])), 
        as.double(pull(grey__PROP.GUESS.HITS__figure.data[5,4])),
        as.character(pull(grey__PROP.GUESS.HITS__figure.data[6,1])), 
        as.character(pull(grey__PROP.GUESS.HITS__figure.data[6,2])), "Guessing",
        as.double(pull(grey__PROP.GUESS.HITS__figure.data[6,3])), 
        as.double(pull(grey__PROP.GUESS.HITS__figure.data[6,4]))) %>%
        transform(ResponseOption = factor(ResponseOption, levels=c("RFG","RFBG"))) %>%
        transform(rfg = factor(rfg, levels=c("Recollection","Familiarity","Guessing"))) %>%
        transform(StimuliFormat = factor(StimuliFormat, levels=c("Words","Drawings", "Photographs")))

##  Prep data for figures:  
    grey__PROP.REC.FAM.GUESS.HITS__figure <-
        ggplot(grey__PROP.REC.FAM.GUESS.HITS__figure.data, aes(x = StimuliFormat, y = emmean, fill = rfg)) +
        scale_fill_manual("legend", values = c("Recollection" = "#1B4251", 
                                               "Familiarity" = "#6A6C93", 
                                               "Guessing" = "#D491CA")) + 
        geom_col(position = position_dodge()) +
        geom_errorbar(aes(ymin = pmax(emmean-SE, 0), ymax = emmean+SE), 
                      width = 0.2, size = 0.3, position = position_dodge(0.9)) +
        facet_wrap(~ResponseOption, strip.position = "bottom") +
        labs(x = "Response-option condition", y = "Mean proportion of hits") +
        scale_y_continuous(expand = c(0, 0), limits = c(0, 1)) +
        theme_classic() +    # Removes grey background and grid lines. 
            theme(
            strip.placement = "outside",
            strip.background = element_rect(fill = "white", size = 0.5, linetype = "solid", colour = "black"),
            axis.title.x = element_text(vjust=-4),    # Move x-axis label further away from the figure.
            axis.title.y = element_text(vjust=6),     # Move y-axis label further away from the figure.
            axis.text.x = element_text(size = 9),
            axis.text.y = element_text(size = 9),
            legend.background = element_rect(fill = "white", size = 0.2, linetype = "solid", colour = "black"),
            legend.title = element_blank(),
            legend.position = c(0.5, 0.896),
            legend.margin = margin(6, 6, 6, 6),
            legend.spacing.y = unit(-1, "pt"),
            plot.background = element_rect(size = 0.5, linetype = 'solid', colour = "black"),
            plot.margin = margin(20, 20, 24, 30))
```

```{r exp3--prop-rec-fam-guess-hits--figurecaption, echo=FALSE, results = FALSE}
    figure_numbering(name = "exp3--prop-rec-fam-guess-hits--figurecaption",
                     caption = "Proportion of hits assigned Recollection, Familiarity, and Guessing, by stimuli format and response-option condition.")
```

### Hits assigned Recollection, Familiarity, and Guessing
To determine the effects of stimuli format and response-option on accurate recognition memory judgements, separate 3 (stimuli format: words, drawings, photographs) x 2 (response-option condition: RFG-judgements, RFBG-judgements) mixed ANOVAs were conducted on the mean proportion of hits assigned Recollection, Familiarity, and Guessing (see `r figure_numbering("exp3--prop-rec-fam-guess-hits--figurecaption", display = "cite")`).

```{r fig.width=7, fig.height=5.5, echo=FALSE}
grey__PROP.REC.FAM.GUESS.HITS__figure
```
`r figure_numbering("exp3--prop-rec-fam-guess-hits--figurecaption")`



```{r exp3--prop-rec-hits--figurecaption, echo=FALSE, results = FALSE}
    figure_numbering(name = "exp3--prop-rec-hits--figurecaption",
                     caption = "Interaction plot between stimuli format and response-option for the mean proportion of hits assigned Recollection.")
```

#### Recollection (hits)
For hits assigned Recollection, there was a significant interaction effect [`r apa__grey__anova__PROP.REC.HITS__interaction.main.effect`] (see `r figure_numbering("exp3--prop-rec-hits--figurecaption", display = "cite")`). Photographs (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFG_Photographs %>% str_remove("\\,.*")`) resulted in more Recollection hits than both words (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFG_Words %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.REC.HITS__interaction.full.pairwise$statistic$RFGWords_RFGPhotographs`] 
and drawings (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFG_Drawings %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.REC.HITS__interaction.full.pairwise$statistic$RFGDrawings_RFGPhotographs`] in the RFG group. Drawings (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFG_Drawings %>% str_remove("\\,.*")`) also resulted in more Recollection hits than words (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFG_Words %>% str_remove("\\,.*")`) 
[`r apa__grey__anova__PROP.REC.HITS__interaction.full.pairwise$statistic$RFGWords_RFGDrawings`] in the RFG group. In the RFBG group, there was an identical pattern; photographs (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFBG_Photographs %>% str_remove("\\,.*")`) resulted in more Recollection hits than both words (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFBG_Words %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.REC.HITS__interaction.full.pairwise$statistic$RFBGWords_RFBGPhotographs`] and drawings (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFBG_Drawings %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.REC.HITS__interaction.full.pairwise$statistic$RFBGDrawings_RFBGPhotographs`]. Drawings (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFBG_Drawings %>% str_remove("\\,.*")`) also resulted in more Recollection hits than words (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFBG_Words %>% str_remove("\\,.*")`) 
[`r apa__grey__anova__PROP.REC.HITS__interaction.full.pairwise$statistic$RFBGWords_RFBGDrawings`] in the RFBG group. 
Comparisons of stimuli format across the response-option groups showed no difference in the number of Recollection hits for photograph stimuli between the RFG (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFG_Photographs %>% str_remove("\\,.*")`) and RFBG (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFBG_Photographs %>% str_remove("\\,.*")`) conditions [`r apa__grey__anova__PROP.REC.HITS__interaction.full.pairwise$statistic$RFGPhotographs_RFBGPhotographs`]. The same pattern was evident for drawings (RFG: `r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFG_Drawings %>% str_remove("\\,.*")`, RFBG: `r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFBG_Drawings %>% str_remove("\\,.*")` [`r apa__grey__anova__PROP.REC.HITS__interaction.full.pairwise$statistic$RFGDrawings_RFBGDrawings`]). Word stimuli, however, produced significantly more Recollection hits in the RFBG group (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFBG_Words %>% str_remove("\\,.*")`) compared to the RFG (`r apa__grey__anova__PROP.REC.HITS__interaction.means$estimate$RFG_Words %>% str_remove("\\,.*")`) group [`r apa__grey__anova__PROP.REC.HITS__interaction.full.pairwise$statistic$RFGWords_RFBGWords`].

&nbsp;

```{r fig.width=7, fig.height=5.5, echo=FALSE}
grey__PROP.REC.HITS__interaction.figure
```
`r figure_numbering("exp3--prop-rec-hits--figurecaption")`

```{r exp3--prop-fam-hits--figurecaption, echo=FALSE, results = FALSE}
    figure_numbering(name = "exp3--prop-fam-hits--figurecaption",
                     caption = "Interaction plot between stimuli format and response-option for the mean proportion of hits assigned 'Familiarity'.")
```

#### Familiarity (hits)
For hits assigned Familiarity, there was a significant interaction between stimuli format and response-option [`r apa__grey__anova__PROP.FAM.HITS__interaction.main.effect`] (see `r figure_numbering("exp3--prop-fam-hits--figurecaption", display = "cite")`). Within the RFG condition, words (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFG_Words %>% str_remove("\\,.*")`) resulted in more Familiarity hits than both drawings (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFG_Drawings %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.FAM.HITS__interaction.full.pairwise$statistic$RFGWords_RFGDrawings`] and photographs (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFG_Photographs %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.FAM.HITS__interaction.full.pairwise$statistic$RFGWords_RFGPhotographs`]. Drawings (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFG_Drawings %>% str_remove("\\,.*")`) also produced more Familiarity hits compared to photographs (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFG_Photographs %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.FAM.HITS__interaction.full.pairwise$statistic$RFGDrawings_RFGPhotographs`]. 

Within the RFBG condition, words (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFBG_Words %>% str_remove("\\,.*")`) still produced more Familiarity hits than photographs (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFBG_Photographs %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.FAM.HITS__interaction.full.pairwise$statistic$RFBGWords_RFBGPhotographs`]. However, there was no difference in the number of Familiarity hits when comparing words (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFBG_Words %>% str_remove("\\,.*")`) to drawings (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFBG_Drawings %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.FAM.HITS__interaction.full.pairwise$statistic$RFBGWords_RFBGDrawings`]. Another difference from the within-RFG findings is the number of Familiarity hits for drawings (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFBG_Drawings %>% str_remove("\\,.*")`) did not differ from photographs (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFBG_Photographs %>% str_remove("\\,.*")`) in the RFBG condition [`r apa__grey__anova__PROP.FAM.HITS__interaction.full.pairwise$statistic$RFBGDrawings_RFBGPhotographs`].

Comparisons across response-option conditions showed that drawings produced significantly more Familiarity hits in the RFBG (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFBG_Drawings %>% str_remove("\\,.*")`) condition compared to RFG (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFG_Drawings %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.FAM.HITS__interaction.full.pairwise$statistic$RFGDrawings_RFBGDrawings`]. A similar pattern was also evident for photographs (RFG: `r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFG_Photographs %>% str_remove("\\,.*")`, RFBG: `r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFBG_Photographs %>% str_remove("\\,.*")` [`r apa__grey__anova__PROP.FAM.HITS__interaction.full.pairwise$statistic$RFGPhotographs_RFBGPhotographs`]). Words, however, showed no difference in the number of Familiarity hits between the RFG (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFG_Words %>% str_remove("\\,.*")`) and RFBG (`r apa__grey__anova__PROP.FAM.HITS__interaction.means$estimate$RFBG_Words %>% str_remove("\\,.*")`) conditions [`r apa__grey__anova__PROP.FAM.HITS__interaction.full.pairwise$statistic$RFGWords_RFBGWords`].

&nbsp;

```{r fig.width=7, fig.height=5.5, echo=FALSE}
grey__PROP.FAM.HITS__interaction.figure
```
`r figure_numbering("exp3--prop-fam-hits--figurecaption")`

#### Guessing (hits)
For hits assigned Guessing, there was a significant main effect of stimuli format [`r apa__grey__anova__PROP.GUESS.HITS__stim.format.main.effect`]. The interaction effect was not significant [`r apa__grey__anova__PROP.GUESS.HITS__interaction.main.effect`]. Post-hoc comparisons for the main effect of stimuli format showed that words (`r apa__grey__anova__PROP.GUESS.HITS__words.mean`) produced significantly more Guessing hits than both drawings (`r apa__grey__anova__PROP.GUESS.HITS__drawings.mean`) [`r apa__grey__anova__PROP.GUESS.HITS__words.vs.drawings.pairwise`] and photographs (`r apa__grey__anova__PROP.GUESS.HITS__photographs.mean`) [`r apa__grey__anova__PROP.GUESS.HITS__words.vs.photographs.pairwise`]. Drawings (`r apa__grey__anova__PROP.GUESS.HITS__drawings.mean`) also produced significantly more Guessing hits compared to photographs (`r apa__grey__anova__PROP.GUESS.HITS__photographs.mean`) [`r apa__grey__anova__PROP.GUESS.HITS__drawings.vs.photographs.pairwise`].

```{r, echo=FALSE, results = FALSE, message=FALSE, warning=FALSE, cache=TRUE, fig.show='hide'}
##### EXPERIMENT 3 ################################################################################################
###################################################################################################################
##                                                                                                               ##
##    PROP REC FA:                                                                                               ##
##                                                                                                               ##
###################################################################################################################
## Prep data for analysis:                                               
    grey__anova__PROP.REC.FA_data <- grey_data %>%
        select(id, ResponseOption, prop_word_FA_rec_total, prop_drawing_FA_rec_total, prop_photo_FA_rec_total) %>%
        rename(word = "prop_word_FA_rec_total", 
               drawing = "prop_drawing_FA_rec_total", 
               photo = "prop_photo_FA_rec_total") %>%
        gather(key = "StimuliFormat", value = "PROP.REC.FA", word, drawing, photo) %>%
        mutate_at(vars("id", "ResponseOption", "StimuliFormat"), factor) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "word", "Words")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "drawing", "Drawings")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "photo", "Photographs")) %>%
        transform(StimuliFormat = factor(StimuliFormat, levels=c("Words","Drawings","Photographs"))) %>%
        transform(ResponseOption = factor(ResponseOption, levels=c("RFG","RFBG")))
#-----------------------------------------------------------------------------------------------------------------#
##  Run 2-way mixed ANOVA:
    grey__anova__PROP.REC.FA <- aov_ez("id", "PROP.REC.FA", grey__anova__PROP.REC.FA_data,
                                         between = "ResponseOption", within = "StimuliFormat")
    
##  Format ANOVA main effects for use in report:  
    apa__grey__anova__PROP.REC.FA <- papaja:::apa_print.afex_aov(grey__anova__PROP.REC.FA) 
    apa__grey__anova__PROP.REC.FA__stim.format.main.effect <-
        apa__grey__anova__PROP.REC.FA$full$StimuliFormat %>% str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__PROP.REC.FA__resp.option.main.effect <-
        apa__grey__anova__PROP.REC.FA$full$ResponseOption %>% str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__PROP.REC.FA__interaction.main.effect <-
        apa__grey__anova__PROP.REC.FA$full$ResponseOption_StimuliFormat %>% 
        str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
#-----------------------------------------------------------------------------------------------------------------#
##  Run post-hoc contrasts:
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Response-option:  Not significant.
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Stimuli format:  Not significant.
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Interaction:  Not significant.

###################################################################################################################
##                                                                                                               ##
##    PROP FAM FA:                                                                                               ##
##                                                                                                               ##
###################################################################################################################
## Prep data for analysis:                                               
    grey__anova__PROP.FAM.FA_data <- grey_data %>%
        select(id, ResponseOption, prop_word_FA_fam_total, prop_drawing_FA_fam_total, prop_photo_FA_fam_total) %>%
        rename(word = "prop_word_FA_fam_total",
               drawing = "prop_drawing_FA_fam_total",
               photo = "prop_photo_FA_fam_total") %>%
        gather(key = "StimuliFormat", value = "PROP.FAM.FA", word, drawing, photo) %>%
        mutate_at(vars("id", "ResponseOption", "StimuliFormat"), factor) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "word", "Words")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "drawing", "Drawings")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "photo", "Photographs")) %>%
        transform(StimuliFormat = factor(StimuliFormat, levels=c("Words","Drawings","Photographs"))) %>%
        transform(ResponseOption = factor(ResponseOption, levels=c("RFG","RFBG")))
#-----------------------------------------------------------------------------------------------------------------#
##  Run 2-way mixed ANOVA:
    grey__anova__PROP.FAM.FA <- aov_ez("id", "PROP.FAM.FA", grey__anova__PROP.FAM.FA_data,
                                       between = "ResponseOption", within = "StimuliFormat")
    
##  Format ANOVA main effects for use in report:  
    apa__grey__anova__PROP.FAM.FA <- papaja:::apa_print.afex_aov(grey__anova__PROP.FAM.FA) 
    apa__grey__anova__PROP.FAM.FA__stim.format.main.effect <-
        apa__grey__anova__PROP.FAM.FA$full$StimuliFormat %>% str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__PROP.FAM.FA__resp.option.main.effect <-
        apa__grey__anova__PROP.FAM.FA$full$ResponseOption %>% str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__PROP.FAM.FA__interaction.main.effect <-
        apa__grey__anova__PROP.FAM.FA$full$ResponseOption_StimuliFormat %>%   
        str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
#-----------------------------------------------------------------------------------------------------------------#
##  Run post-hoc contrasts:
##  Interaction:
    grey__anova__PROP.FAM.FA__interaction.means <- 
        emmeans(grey__anova__PROP.FAM.FA, ~ ResponseOption:StimuliFormat)
    grey__anova__PROP.FAM.FA__interaction.pairwise <- pairs(grey__anova__PROP.FAM.FA__interaction.means)
    
    ##  Format pairwise results for use in report:  
        apa__grey__anova__PROP.FAM.FA__interaction.means <- 
            papaja:::apa_print.emmGrid(grey__anova__PROP.FAM.FA__interaction.means)
        apa__grey__anova__PROP.FAM.FA__interaction.full.pairwise <- 
            papaja:::apa_print.emmGrid(grey__anova__PROP.FAM.FA__interaction.pairwise)
        
    ##  Prep data for figure:  
        grey__PROP.FAM.FA__interaction.figure.data <- as.tibble(grey__anova__PROP.FAM.FA__interaction.means) %>%
            select(-df, -lower.CL, -upper.CL)
    ##  Create labels for figure (replaces plot legend):
        grey__PROP.FAM.FA__interaction.figure.labels <- grey__PROP.FAM.FA__interaction.figure.data %>%
            select(StimuliFormat, ResponseOption, emmean) %>%
            filter(StimuliFormat == "Photographs") %>%
            mutate(label = case_when(
            ResponseOption == "RFG" ~ "RFG",
            ResponseOption == "RFBG" ~ "RFBG")) %>%
            group_by(StimuliFormat, ResponseOption, label)
    ##  Interaction figure:
        grey__PROP.FAM.FA__interaction.figure <- grey__PROP.FAM.FA__interaction.figure.data %>%
            ggplot() +
            aes(x = StimuliFormat, colour = ResponseOption, group = ResponseOption, y = emmean) +
            stat_summary(fun.y = mean, geom = "point", size = 2.4, shape = 15) +
            stat_summary(fun.y = mean, geom = "line", size = 1.2) +
            geom_text(size = 4, aes(label = label, colour = ResponseOption), nudge_x = 0.08, hjust = 0,
            data = grey__PROP.FAM.FA__interaction.figure.labels) +
            scale_colour_manual(values = c('#8ec6c5', '#7d9ab5', '#8566aa')) +
            labs(x = "Stimuli-format", y = "Mean proportion of FA assigned:  'Familiarity'") +
            scale_y_continuous(limits = c(0, 1),
                               breaks = c(0, 0.10, 0.20, 0.30, 0.40, 0.50, 0.60, 0.70, 0.80, 0.90, 1),
                               expand = c(0, 0)) +
            theme_classic() +
            theme(legend.position = "none",
                  axis.title.x = element_text(size = 10, vjust = -4),
                  axis.text.x = element_text(size = 10),
                  axis.title.y = element_text(size = 10, vjust = 6),
                  axis.text.y = element_text(size = 10),
                  plot.background = element_rect(size = 0.5, linetype = 'solid', colour = "black"),
                  plot.margin = margin(20, 20, 24, 30))
        
###################################################################################################################
##                                                                                                               ##
##    PROP GUESS FA:                                                                                             ##
##                                                                                                               ##
###################################################################################################################
## Prep data for analysis:                                               
    grey__anova__PROP.GUESS.FA_data <- grey_data %>%
        select(id, ResponseOption, prop_word_FA_guess, prop_drawing_FA_guess, prop_photo_FA_guess) %>%
        rename(word = "prop_word_FA_guess", drawing = "prop_drawing_FA_guess", photo = "prop_photo_FA_guess") %>%
        gather(key = "StimuliFormat", value = "PROP.GUESS.FA", word, drawing, photo) %>%
        mutate_at(vars("id", "ResponseOption", "StimuliFormat"), factor) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "word", "Words")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "drawing", "Drawings")) %>%
        mutate(StimuliFormat = str_replace(StimuliFormat, "photo", "Photographs")) %>%
        transform(StimuliFormat = factor(StimuliFormat, levels=c("Words","Drawings","Photographs"))) %>%
        transform(ResponseOption = factor(ResponseOption, levels=c("RFG","RFBG")))
#-----------------------------------------------------------------------------------------------------------------#
##  Run 2-way mixed ANOVA:
    grey__anova__PROP.GUESS.FA <- aov_ez("id", "PROP.GUESS.FA", grey__anova__PROP.GUESS.FA_data,
                                           between = "ResponseOption", within = "StimuliFormat")
    
##  Format ANOVA main effects for use in report:  
    apa__grey__anova__PROP.GUESS.FA <- papaja:::apa_print.afex_aov(grey__anova__PROP.GUESS.FA) 
    apa__grey__anova__PROP.GUESS.FA__stim.format.main.effect <-
        apa__grey__anova__PROP.GUESS.FA$full$StimuliFormat %>% str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__PROP.GUESS.FA__resp.option.main.effect <-
        apa__grey__anova__PROP.GUESS.FA$full$ResponseOption %>% str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
    apa__grey__anova__PROP.GUESS.FA__interaction.main.effect <-
        apa__grey__anova__PROP.GUESS.FA$full$ResponseOption_StimuliFormat %>%
        str_extract("^(?:[^\\,]*\\,){3}([^\\,]*)")
#-----------------------------------------------------------------------------------------------------------------#
##  Run post-hoc contrasts:
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Response-option:  Not significant.
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Stimuli format:
    grey__anova__PROP.GUESS.FA__stim.format.means <- emmeans(grey__anova__PROP.GUESS.FA, ~ StimuliFormat)
    grey__anova__PROP.GUESS.FA__stim.format.pairwise <- pairs(grey__anova__PROP.GUESS.FA__stim.format.means)
    ##  Format pairwise results for use in report:  
        apa__grey__anova__PROP.GUESS.FA__stim.format.means <- 
            papaja:::apa_print.emmGrid(grey__anova__PROP.GUESS.FA__stim.format.means)
        apa__grey__anova__PROP.GUESS.FA__words.mean <- 
            apa__grey__anova__PROP.GUESS.FA__stim.format.means$estimate$Words %>% str_remove("\\,.*")
        apa__grey__anova__PROP.GUESS.FA__drawings.mean <- 
            apa__grey__anova__PROP.GUESS.FA__stim.format.means$estimate$Drawings %>% str_remove("\\,.*")
        apa__grey__anova__PROP.GUESS.FA__photographs.mean <-
            apa__grey__anova__PROP.GUESS.FA__stim.format.means$estimate$Photographs %>% str_remove("\\,.*")
        apa__grey__anova__PROP.GUESS.FA__stim.format.pairwise <- 
            papaja:::apa_print.emmGrid(grey__anova__PROP.GUESS.FA__stim.format.pairwise)
        
        apa__grey__anova__PROP.GUESS.FA__words.vs.drawings.pairwise <-
            apa__grey__anova__PROP.GUESS.FA__stim.format.pairwise$full$Words_Drawings %>% 
            str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
        apa__grey__anova__PROP.GUESS.FA__words.vs.photographs.pairwise <-
            apa__grey__anova__PROP.GUESS.FA__stim.format.pairwise$full$Words_Photographs %>% 
            str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
        apa__grey__anova__PROP.GUESS.FA__drawings.vs.photographs.pairwise <-
            apa__grey__anova__PROP.GUESS.FA__stim.format.pairwise$full$Drawings_Photographs %>%
            str_remove("^(?:[^\\$]*\\$){6}([^\\$]*)")
#-  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  -  - #
##  Interaction:  Not significant.

###################################################################################################################
##                                                                                                               ##
##    FA FIGURE:                                                                                                 ##
##                                                                                                               ##
###################################################################################################################
##  Prep data for figures:  
    grey__PROP.REC.FA__figure.data <- 
        as.tibble(emmeans(grey__anova__PROP.REC.FA, ~ ResponseOption:StimuliFormat)) %>%
        select(-df, -lower.CL, -upper.CL)
    grey__PROP.FAM.FA__figure.data <- 
        as.tibble(emmeans(grey__anova__PROP.FAM.FA, ~ ResponseOption:StimuliFormat)) %>%
        select(-df, -lower.CL, -upper.CL)
    grey__PROP.GUESS.FA__figure.data <- 
        as.tibble(emmeans(grey__anova__PROP.GUESS.FA, ~ ResponseOption:StimuliFormat)) %>%
        select(-df, -lower.CL, -upper.CL)
      
    grey__PROP.REC.FAM.GUESS.FA__figure.data <- 
        tribble(~"ResponseOption", ~"StimuliFormat", ~"rfg", ~"emmean", ~"SE",
        as.character(pull(grey__PROP.REC.FA__figure.data[1,1])),
        as.character(pull(grey__PROP.REC.FA__figure.data[1,2])), "Recollection",
        as.double(pull(grey__PROP.REC.FA__figure.data[1,3])),
        as.double(pull(grey__PROP.REC.FA__figure.data[1,4])),
        as.character(pull(grey__PROP.REC.FA__figure.data[2,1])),
        as.character(pull(grey__PROP.REC.FA__figure.data[2,2])), "Recollection",
        as.double(pull(grey__PROP.REC.FA__figure.data[2,3])),
        as.double(pull(grey__PROP.REC.FA__figure.data[2,4])),
        as.character(pull(grey__PROP.REC.FA__figure.data[3,1])),
        as.character(pull(grey__PROP.REC.FA__figure.data[3,2])), "Recollection",
        as.double(pull(grey__PROP.REC.FA__figure.data[3,3])),
        as.double(pull(grey__PROP.REC.FA__figure.data[3,4])),
        as.character(pull(grey__PROP.REC.FA__figure.data[4,1])),
        as.character(pull(grey__PROP.REC.FA__figure.data[4,2])), "Recollection",
        as.double(pull(grey__PROP.REC.FA__figure.data[4,3])),
        as.double(pull(grey__PROP.REC.FA__figure.data[4,4])),
        as.character(pull(grey__PROP.REC.FA__figure.data[5,1])),
        as.character(pull(grey__PROP.REC.FA__figure.data[5,2])), "Recollection",
        as.double(pull(grey__PROP.REC.FA__figure.data[5,3])),
        as.double(pull(grey__PROP.REC.FA__figure.data[5,4])),
        as.character(pull(grey__PROP.REC.FA__figure.data[6,1])),
        as.character(pull(grey__PROP.REC.FA__figure.data[6,2])), "Recollection",
        as.double(pull(grey__PROP.REC.FA__figure.data[6,3])),
        as.double(pull(grey__PROP.REC.FA__figure.data[6,4])),
        as.character(pull(grey__PROP.FAM.FA__figure.data[1,1])),
        as.character(pull(grey__PROP.FAM.FA__figure.data[1,2])), "Familiarity",
        as.double(pull(grey__PROP.FAM.FA__figure.data[1,3])),
        as.double(pull(grey__PROP.FAM.FA__figure.data[1,4])),
        as.character(pull(grey__PROP.FAM.FA__figure.data[2,1])),
        as.character(pull(grey__PROP.FAM.FA__figure.data[2,2])), "Familiarity",
        as.double(pull(grey__PROP.FAM.FA__figure.data[2,3])),
        as.double(pull(grey__PROP.FAM.FA__figure.data[2,4])),
        as.character(pull(grey__PROP.FAM.FA__figure.data[3,1])),
        as.character(pull(grey__PROP.FAM.FA__figure.data[3,2])), "Familiarity",
        as.double(pull(grey__PROP.FAM.FA__figure.data[3,3])),
        as.double(pull(grey__PROP.FAM.FA__figure.data[3,4])),
        as.character(pull(grey__PROP.FAM.FA__figure.data[4,1])),
        as.character(pull(grey__PROP.FAM.FA__figure.data[4,2])), "Familiarity",
        as.double(pull(grey__PROP.FAM.FA__figure.data[4,3])),
        as.double(pull(grey__PROP.FAM.FA__figure.data[4,4])),
        as.character(pull(grey__PROP.FAM.FA__figure.data[5,1])),
        as.character(pull(grey__PROP.FAM.FA__figure.data[5,2])), "Familiarity",
        as.double(pull(grey__PROP.FAM.FA__figure.data[5,3])),
        as.double(pull(grey__PROP.FAM.FA__figure.data[5,4])),
        as.character(pull(grey__PROP.FAM.FA__figure.data[6,1])),
        as.character(pull(grey__PROP.FAM.FA__figure.data[6,2])), "Familiarity",
        as.double(pull(grey__PROP.FAM.FA__figure.data[6,3])),
        as.double(pull(grey__PROP.FAM.FA__figure.data[6,4])),
        as.character(pull(grey__PROP.GUESS.FA__figure.data[1,1])),
        as.character(pull(grey__PROP.GUESS.FA__figure.data[1,2])), "Guessing",
        as.double(pull(grey__PROP.GUESS.FA__figure.data[1,3])),
        as.double(pull(grey__PROP.GUESS.FA__figure.data[1,4])),
        as.character(pull(grey__PROP.GUESS.FA__figure.data[2,1])),
        as.character(pull(grey__PROP.GUESS.FA__figure.data[2,2])), "Guessing",
        as.double(pull(grey__PROP.GUESS.FA__figure.data[2,3])),
        as.double(pull(grey__PROP.GUESS.FA__figure.data[2,4])),
        as.character(pull(grey__PROP.GUESS.FA__figure.data[3,1])),
        as.character(pull(grey__PROP.GUESS.FA__figure.data[3,2])), "Guessing",
        as.double(pull(grey__PROP.GUESS.FA__figure.data[3,3])),
        as.double(pull(grey__PROP.GUESS.FA__figure.data[3,4])),
        as.character(pull(grey__PROP.GUESS.FA__figure.data[4,1])),
        as.character(pull(grey__PROP.GUESS.FA__figure.data[4,2])), "Guessing",
        as.double(pull(grey__PROP.GUESS.FA__figure.data[4,3])),
        as.double(pull(grey__PROP.GUESS.FA__figure.data[4,4])),
        as.character(pull(grey__PROP.GUESS.FA__figure.data[5,1])),
        as.character(pull(grey__PROP.GUESS.FA__figure.data[5,2])), "Guessing",
        as.double(pull(grey__PROP.GUESS.FA__figure.data[5,3])),
        as.double(pull(grey__PROP.GUESS.FA__figure.data[5,4])),
        as.character(pull(grey__PROP.GUESS.FA__figure.data[6,1])),
        as.character(pull(grey__PROP.GUESS.FA__figure.data[6,2])), "Guessing",
        as.double(pull(grey__PROP.GUESS.FA__figure.data[6,3])),
        as.double(pull(grey__PROP.GUESS.FA__figure.data[6,4]))) %>%
        transform(ResponseOption = factor(ResponseOption, levels=c("RFG","RFBG"))) %>%
        transform(rfg = factor(rfg, levels=c("Recollection","Familiarity","Guessing"))) %>%
        transform(StimuliFormat = factor(StimuliFormat, levels=c("Words","Drawings", "Photographs")))

##  Prep data for figures:  
    grey__PROP.REC.FAM.GUESS.FA__figure <-
        ggplot(grey__PROP.REC.FAM.GUESS.FA__figure.data, aes(x = StimuliFormat, y = emmean, fill = rfg)) +
        scale_fill_manual("legend",values = c("Recollection" = "#1B4251", 
                                              "Familiarity" = "#6A6C93", 
                                              "Guessing" = "#D491CA")) + 
        geom_col(position = position_dodge()) +
        geom_errorbar(aes(ymin = pmax(emmean-SE, 0), ymax = emmean+SE), 
                      width = 0.2, size = 0.3, position = position_dodge(0.9)) +
        facet_wrap(~ResponseOption, strip.position = "bottom") +
        labs(x = "Response-option condition", y = "Mean proportion of FA") +
        scale_y_continuous(expand = c(0, 0), limits = c(0, 1)) +
        theme_classic() +    # Removes grey background and grid lines. 
            theme(
            strip.placement = "outside",
            strip.background = element_rect(fill = "white", size = 0.5, linetype = "solid", colour = "black"),
            axis.title.x = element_text(vjust=-4),    # Move x-axis label further away from the figure.
            axis.title.y = element_text(vjust=6),     # Move y-axis label further away from the figure.
            axis.text.x = element_text(size = 9),
            axis.text.y = element_text(size = 9),
            legend.background = element_rect(fill = "white", size = 0.2, linetype = "solid", colour = "black"),
            legend.title = element_blank(),
            legend.position = c(0.5, 0.896),
            legend.margin = margin(6, 6, 6, 6),
            legend.spacing.y = unit(-1, "pt"),
            plot.background = element_rect(size = 0.5, linetype = 'solid', colour = "black"),
            plot.margin = margin(20, 20, 24, 30))
```

```{r exp3--prop-rec-fam-guess-FA--figurecaption, echo=FALSE, results = FALSE}
    figure_numbering(name = "exp3--prop-rec-fam-guess-FA--figurecaption",
                     caption = "Proportion of FAs assigned Recollection, Familiarity, and Guessing, by stimuli format and response-option condition.")
```

### FAs assigned Recollection, Familiarity, and Guessing
To determine the effects of stimuli format and response-option on false alarms, separate 3 (stimuli format: words, drawings, photographs) x 2 (response-option condition: RFG-judgements, RFBG-judgements) mixed ANOVAs were conducted on the mean proportion of FAs assigned Recollection, Familiarity, and Guessing (see `r figure_numbering("exp3--prop-rec-fam-guess-FA--figurecaption", display = "cite")`).

```{r fig.width=7, fig.height=5.5, echo=FALSE}
grey__PROP.REC.FAM.GUESS.FA__figure
```
`r figure_numbering("exp3--prop-rec-fam-guess-FA--figurecaption")`

#### Recollection (FAs)
For FAs assigned Recollection, there was no significant main effect of stimuli format [`r apa__grey__anova__PROP.REC.FA__stim.format.main.effect`] or interaction [`r apa__grey__anova__PROP.REC.FA__interaction.main.effect`].

```{r exp3--prop-fam-FA--figurecaption, echo=FALSE, results = FALSE}
    figure_numbering(name = "exp3--prop-fam-FA--figurecaption",
                     caption = "Interaction plot between stimuli format and response-option for the mean proportion of FAs assigned 'Familiarity'.")
```
#### Familiarity (FAs)
For FAs assigned Familiarity, there was a significant interaction between stimuli format and response-option [`r apa__grey__anova__PROP.FAM.FA__interaction.main.effect`] (see `r figure_numbering("exp3--prop-fam-FA--figurecaption", display = "cite")`). Within the RFG condition, words (`r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFG_Words %>% str_remove("\\,.*")`) resulted in more Familiarity FAs than photographs (`r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFG_Photographs %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.FAM.FA__interaction.full.pairwise$statistic$RFGWords_RFGPhotographs`], but not drawings (`r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFG_Drawings %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.FAM.FA__interaction.full.pairwise$statistic$RFGWords_RFGDrawings`]. The number of Familiarity FAs did not differ between drawings (`r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFG_Drawings %>% str_remove("\\,.*")`) and photographs (`r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFG_Photographs %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.FAM.FA__interaction.full.pairwise$statistic$RFGDrawings_RFGPhotographs`] in the RFG condition.

Within the RFBG condition, words (`r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFBG_Words %>% str_remove("\\,.*")`) again produced more Familiarity FAs than photographs (`r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFBG_Photographs %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.FAM.FA__interaction.full.pairwise$statistic$RFBGWords_RFBGPhotographs`]. However, words (`r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFBG_Words %>% str_remove("\\,.*")`) also produced more Familiarity FAs than drawings(`r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFBG_Drawings %>% str_remove("\\,.*")`) [`r apa__grey__anova__PROP.FAM.FA__interaction.full.pairwise$statistic$RFBGWords_RFBGDrawings`]. As before, the number of Familiarity FAs did not differ between drawings (`r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFBG_Drawings %>% str_remove("\\,.*")`) and photographs (`r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFBG_Photographs %>% str_remove("\\,.*")`) in the RFBG condition [`r apa__grey__anova__PROP.FAM.FA__interaction.full.pairwise$statistic$RFBGDrawings_RFBGPhotographs`].

Comparisons across response-option conditions showed no differences in the number of Familiarity FAs, for any stimuli format: words (RFG: `r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFG_Words %>% str_remove("\\,.*")`, RFBG: `r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFBG_Words %>% str_remove("\\,.*")` [`r apa__grey__anova__PROP.FAM.FA__interaction.full.pairwise$statistic$RFGWords_RFBGWords`]); drawings (RFG: `r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFG_Drawings %>% str_remove("\\,.*")`, RFBG: `r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFBG_Drawings %>% str_remove("\\,.*")` [`r apa__grey__anova__PROP.FAM.FA__interaction.full.pairwise$statistic$RFGDrawings_RFBGDrawings`]; photographs (RFG: `r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFG_Photographs %>% str_remove("\\,.*")`, RFBG: `r apa__grey__anova__PROP.FAM.FA__interaction.means$estimate$RFBG_Photographs %>% str_remove("\\,.*")` [`r apa__grey__anova__PROP.FAM.FA__interaction.full.pairwise$statistic$RFGPhotographs_RFBGPhotographs`]). 

&nbsp;

```{r fig.width=7, fig.height=5.5, echo=FALSE}
grey__PROP.FAM.FA__interaction.figure
```
`r figure_numbering("exp3--prop-fam-FA--figurecaption")`

####  Guessing (FAs)
For FAs assigned Guessing, there was a significant main effect of stimuli format [`r apa__grey__anova__PROP.GUESS.FA__stim.format.main.effect`]. The interaction effect was not significant [`r apa__grey__anova__PROP.GUESS.FA__interaction.main.effect`]. Post-hoc comparisons for the main effect of stimuli format showed that words (`r apa__grey__anova__PROP.GUESS.FA__words.mean`) produced significantly more Guessing FAs than both drawings (`r apa__grey__anova__PROP.GUESS.FA__drawings.mean`) [`r apa__grey__anova__PROP.GUESS.FA__words.vs.drawings.pairwise`] and photographs (`r apa__grey__anova__PROP.GUESS.FA__photographs.mean`) [`r apa__grey__anova__PROP.GUESS.FA__words.vs.photographs.pairwise`]. There was no difference in the proportion of FAs assigned Guessing between drawings (`r apa__grey__anova__PROP.GUESS.FA__drawings.mean`) and photographs (`r apa__grey__anova__PROP.GUESS.FA__photographs.mean`) [`r apa__grey__anova__PROP.GUESS.FA__drawings.vs.photographs.pairwise`].





\newpage

# References
\setlength{\parindent}{-0.2in}
\setlength{\leftskip}{0.2in}
\setlength{\parskip}{8pt}
\noindent

<div id="refs"></div>
  
\newpage
\blandscape
# Appendices
## Appendix A
```{r exp2--spelling-corrections--tablecaption, echo=FALSE, results = FALSE}
    table_numbering(name = "exp2--spelling-corrections--tablecaption", 
                     caption = "Spelling corrections / manipulations to naming responses.")
```

```{r include=FALSE, cache=FALSE}
    spelling_corrections <- read_csv("./resources/spelling_corrections.csv")
```
`r table_numbering("exp2--spelling-corrections--tablecaption")`
```{r spelling-corrections-table, echo=FALSE, cache=FALSE}
    spelling_corrections %>%
      kable("latex", longtable = T, booktabs = T) %>%
      kable_styling(bootstrap_options = c("striped","condensed")) %>%
      kable_styling(latex_options = c("repeat_header"), font_size = 8) %>%
      column_spec(1, width = "2.6cm") %>%
      column_spec(2, width = "2.3cm", border_right = T) %>%
      column_spec(3, width = "2.6cm") %>%
      column_spec(4, width = "2.3cm", border_right = T) %>%
      column_spec(5, width = "2.6cm") %>%
      column_spec(6, width = "2.6cm")
```
\elandscape
\newpage
## Appendix B
```{r norms-table, include=FALSE, warning = FALSE, message=FALSE, cache=FALSE}
    norms <- raw_data %>%
        ungroup() %>% 
        select(stim, familiarity, visualcomplexity, colourdiagnosticity, mentalimageryagreement) %>%
        mutate(stim = str_replace(stim, "colour1", "colour")) %>%
        mutate(stim = str_replace(stim, "grey1", "grey")) %>%
        mutate(familiarity = str_remove(familiarity, "fam_")) %>%
        mutate(visualcomplexity = str_remove(visualcomplexity, "viscom_")) %>%
        mutate(colourdiagnosticity = str_remove(colourdiagnosticity, "coldia_")) %>%
        mutate(mentalimageryagreement = str_remove(mentalimageryagreement, "menima_")) %>%
        mutate(familiarity = as.double(familiarity)) %>%
        mutate(visualcomplexity = as.double(visualcomplexity)) %>%
        mutate(colourdiagnosticity = as.double(colourdiagnosticity)) %>%
        mutate(mentalimageryagreement = as.double(mentalimageryagreement)) %>%
        group_by(stim) %>%
        summarise_all(tibble::lst(mean, sd), na.rm = TRUE) %>%
        rename(Photograph = "stim", Fam_Mean = "familiarity_mean", Fam_SD = "familiarity_sd",   
               VisCom_Mean = "visualcomplexity_mean", VisCom_SD = "visualcomplexity_sd",
               ColDia_Mean = "colourdiagnosticity_mean", ColDia_SD = "colourdiagnosticity_sd", 
               MenIma_Mean = "mentalimageryagreement_mean", MenIma_SD = "mentalimageryagreement_sd") %>%
        select(Photograph, Fam_Mean, Fam_SD, VisCom_Mean, VisCom_SD, ColDia_Mean, 
               ColDia_SD, MenIma_Mean, MenIma_SD) %>%
        mutate_at(c("Fam_Mean", "Fam_SD", "VisCom_Mean", "VisCom_SD", "ColDia_Mean", 
                    "ColDia_SD", "MenIma_Mean", "MenIma_SD"), round, 2)

#image_refs <- read_csv("./resources/image_refs.csv")
#        norms2 <- (bind_cols(norms, image_refs))

```  

```{r norms-table-print, echo=FALSE, cache=TRUE}
    
    final_stim_list <- final_stim_list %>%
      mutate(stim = str_remove(stim, "[1-3]"))

    norms %>%
      kable("latex", longtable = T, booktabs = T, linesep = c("", "", "", "", "", "\\addlinespace")) %>%
      kable_styling(bootstrap_options = c("striped","condensed")) %>%
      kable_styling(latex_options = c("repeat_header"), font_size = 6) %>%
      add_header_above(c(" " = 1, "Familiarity" = 2, "Visual Complexity" = 2, 
                         "Colour Diagnosticity" = 2, "Mental Imagery Agreement" = 2)) %>%
      pack_rows(index = table(final_stim_list$stim))
 
```